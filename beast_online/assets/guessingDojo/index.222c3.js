window.__require=function e(t,o,n){function i(s,c){if(!o[s]){if(!t[s]){var a=s.split("/");if(a=a[a.length-1],!t[a]){var l="function"==typeof __require&&__require;if(!c&&l)return l(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+s+"'")}s=a}var u=o[s]={exports:{}};t[s][0].call(u.exports,function(e){return i(t[s][1][e]||e)},u,u.exports,e,t,o,n)}return o[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<n.length;s++)i(n[s]);return i}({beastChallengeLog:[function(e,t,o){"use strict";cc._RF.push(t,"38959nS/NpIWol74ujrqn6R","beastChallengeLog");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../core/components/LayerBase"),c=e("../../game/beastMgr"),a=e("../../proto/mystibeast_pb"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollView=null,t.content=null,t.item=null,t}return i(t,e),t.prototype.loadChallengeLog=function(){var e=this,t=new a.BeastChallengeBetLogReq;c.default.inst.GuessingDojoChallengeClient.beastChallengeBetLog(t,c.default.inst.metadata).then(function(t){if(0==t.getCode()){var o=t.getBeastchallengebetlogresp().toObject();cc.log("bet log",o),e._showLogInfo(o.myBetListList)}else c.default.inst.handleCode(t.getCode())}).catch(function(e){cc.log(e)})},t.prototype._showLogInfo=function(e){this.scrollView.stopAutoScroll(),this.scrollView.scrollToTop(),this.content.removeAllChildren(),this.loadByFrames(e)},t.prototype.loadByFrames=function(e){var t=this,o=e.length,n=0,i=function(){for(var r=Math.min(o-n,30),s=0;s<r;s++)t.addItem(n,e),n++;n<o?t.scheduleOnce(function(){return i()}):t.scheduleOnce(function(){t.improveDC()})};i()},t.prototype.addItem=function(e,t){t[e];var o=cc.instantiate(this.item);o.active=!0,o.parent=this.content},t.prototype.improveDC=function(){if(0!=this.content.childrenCount){var e=this.scrollView.node.parent.convertToWorldSpaceAR(cc.v2(this.scrollView.node.x-this.scrollView.node.anchorX*this.scrollView.node.width,this.scrollView.node.y-this.scrollView.node.anchorY*this.scrollView.node.height)),t=cc.rect(e.x,e.y,this.scrollView.node.width,this.scrollView.node.height);this.content.children.forEach(function(e){e.children.forEach(function(e){e.getBoundingBoxToWorld().intersects(t)?0===e.opacity&&(e.opacity=255):0!==e.opacity&&(e.opacity=0)})})}},t.prototype.onBtnCloseClick=function(){e.prototype.onClose.call(this)},r([p(cc.ScrollView)],t.prototype,"scrollView",void 0),r([p(cc.Node)],t.prototype,"content",void 0),r([p(cc.Node)],t.prototype,"item",void 0),r([u],t)}(s.default);o.default=h,cc._RF.pop()},{"../../core/components/LayerBase":void 0,"../../game/beastMgr":void 0,"../../proto/mystibeast_pb":void 0}],beastChallengeResult:[function(e,t,o){"use strict";cc._RF.push(t,"fb0d1DRoLtFXK7cfM+C3tRN","beastChallengeResult");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,c=s.ccclass,a=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.start=function(){},r([c],t)}(cc.Component));o.default=a,cc._RF.pop()},{}],beastChallenge:[function(e,t,o){"use strict";cc._RF.push(t,"d92a73WRpREOIoj5R8qU3NU","beastChallenge");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},s=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function s(e){try{a(n.next(e))}catch(t){r(t)}}function c(e){try{a(n.throw(e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,c)}a((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return a([e,t])}}function a(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(c){r=[6,c],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../core/components/gameBase"),l=e("../../game/beast_config"),u=e("../../game/beastMgr"),p=e("../../proto/mystibeast_pb"),h=cc._decorator,d=h.ccclass,f=(h.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.roundId=0,t.myBottle=0,t.beastGesture=0,t}return i(t,e),t.prototype.onEnable=function(){this.joinGame()},t.prototype.joinGame=function(){var e=this,t=new p.JoinGameReq;t.setDeviceId(u.default.inst.deviceId),t.setIp(u.default.inst.ip);var o=u.default.inst.GuessingDojoChallengeClient.joinGame(t,u.default.inst.metadata);o.on("data",function(t){switch(t.getAnyCase()){case p.MessagePush.AnyCase.KICKUSERPUSH:var o=t.getKickuserpush();e._handleKickUserPush(o.toObject());break;case p.MessagePush.AnyCase.BEASTCHALLENGEJOINGAMEPUSH:var n=t.getBeastchallengejoingamepush();e._handleJoinGamePush(n.toObject());break;case p.MessagePush.AnyCase.BEASTCHALLENGEBETPUSH:var i=t.getBeastchallengebetpush();e._handleBetPush(i.toObject());break;case p.MessagePush.AnyCase.BEASTCHALLENGESTATECHANGEPUSH:var r=t.getBeastchallengestatechangepush();e._handleStateChangePush(r.toObject());break;default:cc.log("Unknown message type")}}),o.on("end",function(){cc.log("Server ended the call")}),o.on("error",function(e){cc.error("Error:",e)}),o.on("status",function(t){return s(e,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return cc.log("Status:",t),14!=t.code?[3,1]:(u.default.inst.curLayer=u.Layer.MAIN,[3,3]);case 1:return 16!=t.code?[3,3]:(u.default.inst.handleCode(t.code),u.default.inst.isKickOut=!0,[4,this.wait(1.2)]);case 2:e.sent(),u.default.inst.sendMsgToUniApp("logout"),e.label=3;case 3:return[2]}})})}),this._getRoundInfo()},t.prototype.wait=function(e){var t=this;return new Promise(function(o){t.scheduleOnce(function(){o()},e)})},t.prototype._handleKickUserPush=function(e){return s(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return cc.log("kick push",e),e.userId!=u.default.inst.userId?[3,2]:(u.default.inst.showWarning("beast_netmsg01"),u.default.inst.isKickOut=!0,[4,this.wait(1.2)]);case 1:t.sent(),u.default.inst.sendMsgToUniApp("logout"),t.label=2;case 2:return[2]}})})},t.prototype._handleJoinGamePush=function(e){cc.log("join game push",e),e.user},t.prototype._handleBetPush=function(e){cc.log("bet push",e)},t.prototype._handleStateChangePush=function(e){cc.log("state push",e),0==e.state||1==e.state||2==e.state||3==e.state||e.state},t.prototype._getRoundInfo=function(){var e=this,t=new p.BeastChallengeRoundInfoReq;u.default.inst.GuessingDojoChallengeClient.beastChallengeRoundInfo(t,u.default.inst.metadata).then(function(t){if(0==t.getCode()){var o=t.getBeastchallengeroundinforesp().toObject();cc.log("gameInfo",o),u.default.inst.userId=o.userId,u.default.inst.myGems=MyFun.getRealNum(o.myGemsNum),e.myBottle=MyFun.getRealNum(o.myBottlesNum),e.refreshPlayerInfo(),e._handleCurRoundInfo(o.roundInfo),e._handleChallengeBetInfo(o.challengeBetListList),e._handleBeastBetInfo(o.beastBetListList),e._handleWaitingList(o.waitListList),e._handleMyChallengeBetInfo(o.myChallengeBetInfo),e._handleMyBeastBetInfo(o.myBeastBetInfo)}else u.default.inst.handleCode(t.getCode())}).catch(function(e){cc.log(e)})},t.prototype._challengeBet=function(e,t,o,n){var i=new p.BeastChallengeBetReq;i.setRoundId(e),i.setCampType(t),i.setGemsChoice(o),i.setBetGesture(n),u.default.inst.GuessingDojoChallengeClient.beastChallengeBetOp(i,u.default.inst.metadata).then(function(e){if(0==e.getCode()){var t=e.getBeastchallengebetresp().toObject();cc.log("bet resp",t),u.default.inst.myGems=MyFun.getRealNum(t.myGemsNum)}else u.default.inst.handleCode(e.getCode())}).catch(function(e){cc.log(e)})},t.prototype._getRoundResult=function(){var e=this,t=new p.BeastChallengeRoundResultReq;t.setRoundId(this.roundId),u.default.inst.GuessingDojoChallengeClient.beastChallengeRoundResult(t,u.default.inst.metadata).then(function(t){if(0==t.getCode()){var o=t.getBeastchallengeroundresultresp().toObject();cc.log("round result",o),e._handleJackpotInfo(o.jackpot)}else u.default.inst.handleCode(t.getCode())}).catch(function(e){throw cc.log(e),e})},t.prototype._showResult=function(){},t.prototype._handleCurRoundInfo=function(e){cc.log("cur round info",e),this.roundId=e.id,this.beastGesture=e.beastGesture,0==e.status||1==e.status||2==e.status||3==e.status||e.status},t.prototype._handleChallengeBetInfo=function(e){cc.log("challenge bet info",e)},t.prototype._handleBeastBetInfo=function(e){cc.log("beast bet info",e)},t.prototype._handleJackpotInfo=function(){cc.log("jackpot info")},t.prototype.refreshPlayerInfo=function(){},t.prototype._handleWaitingList=function(e){cc.log("waiting list",e)},t.prototype._handleMyChallengeBetInfo=function(e){cc.log("my challenge info",e)},t.prototype._handleMyBeastBetInfo=function(e){cc.log("my beast info",e)},t.prototype.btnChallengeLogClick=function(){return s(this,void 0,void 0,function(){var e;return c(this,function(t){switch(t.label){case 0:return[4,MyFun.loadPrefab(l.getPrefabInfo(l.Bundles.Game_GuessingDojo,l.GuessingDojo_Pop.ChallengeLog))];case 1:return e=t.sent(),cc.instantiate(e).parent=this.node,[2]}})})},t.prototype.btnLeaveGameClicked=function(){return s(this,void 0,void 0,function(){var e;return c(this,function(t){switch(t.label){case 0:return[4,u.default.inst.leaveGame()];case 1:return t.sent(),[4,MyFun.loadPrefab(l.getPrefabInfo(l.Bundles.Game_GuessingDojo,l.GuessingDojo_Pop.Game))];case 2:return e=t.sent(),cc.instantiate(e).parent=this.node.parent,this.node.destroy(),[2]}})})},r([d],t)}(a.default));o.default=f,cc._RF.pop()},{"../../core/components/gameBase":void 0,"../../game/beastMgr":void 0,"../../game/beast_config":void 0,"../../proto/mystibeast_pb":void 0}],bossInfo:[function(e,t,o){"use strict";cc._RF.push(t,"66e97OZO9xEOrpad8UJ2qn1","bossInfo");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},s=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function s(e){try{a(n.next(e))}catch(t){r(t)}}function c(e){try{a(n.throw(e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,c)}a((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return a([e,t])}}function a(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(c){r=[6,c],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../core/components/PopupBase"),l=e("../../game/beast_config"),u=e("../../game/beastMgr"),p=cc._decorator,h=p.ccclass,d=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bossIcon=null,t.bossName=null,t.condition=null,t.reward=null,t.gotReward=null,t.lose=null,t.timeCount=null,t.timeCountFun=null,t}return i(t,e),t.prototype.start=function(){e.prototype.start.call(this),app.AudioMgr.pauseMusic(),app.AudioMgr.play(l.Bundles.Game_GuessingDojo,"BossIntroduction")},t.prototype.onCloseClicked=function(){app.AudioMgr.resumeMusic(),this.hide()},t.prototype.onAfterHide=function(){this.node.destroy()},t.prototype.setData=function(e,t,o){return s(this,void 0,void 0,function(){var n,i;return c(this,function(r){switch(r.label){case 0:return n=this.bossIcon,[4,MyFun.loadPicFromBundle(l.Bundles.Game_GuessingDojo,"boss",e.currentHost.toString())];case 1:return n.spriteFrame=r.sent(),i=MyFun.findItemFromArr(u.default.inst.dojoHostConfigList,"id",e.currentHost),this.bossName.getComponent(app.i18nLabel).init(i.name,[]),this.condition.node.getComponent(app.i18nLabel).init("static_bossInfo5",[e.maxNum.toString(),e.targetNum.toString()]),this.reward.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(t)),this.gotReward.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(e.gainGems)),this.lose.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(o)),this.showTime(3),[2]}})})},t.prototype.showTime=function(e){var t=this;this.unschedule(this.timeCountFun),this.timeCount.getComponent(cc.Label).string="("+e+"s)",e--,this.schedule(this.timeCountFun=function(){e>=0?(t.timeCount.getComponent(cc.Label).string="("+e+"s)",e--):(app.AudioMgr.resumeMusic(),t.hide())},1)},r([d(cc.Sprite)],t.prototype,"bossIcon",void 0),r([d(cc.Node)],t.prototype,"bossName",void 0),r([d(cc.Label)],t.prototype,"condition",void 0),r([d(cc.Label)],t.prototype,"reward",void 0),r([d(cc.Label)],t.prototype,"gotReward",void 0),r([d(cc.Label)],t.prototype,"lose",void 0),r([d(cc.Label)],t.prototype,"timeCount",void 0),r([h],t)}(a.default);o.default=f,cc._RF.pop()},{"../../core/components/PopupBase":void 0,"../../game/beastMgr":void 0,"../../game/beast_config":void 0}],bossRecord:[function(e,t,o){"use strict";cc._RF.push(t,"72732PamhtKuqCev4ZTbMhw","bossRecord");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../game/beastMgr"),c=e("../../proto/mystibeast_pb"),a=cc._decorator,l=a.ccclass,u=a.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mask=null,t.mainLayer=null,t.scrollView=null,t.content=null,t.item=null,t.gestureSF=[],t.flagList=[],t.cb=null,t}return i(t,e),t.prototype.start=function(){cc.tween(this.mainLayer).set({x:-500}).to(.2,{x:-275}).start()},t.prototype.btnCloseClick=function(){var e=this;cc.tween(this.mainLayer).to(.2,{x:-500}).call(function(){e.cb&&e.cb(),e.node.destroy()}).start()},t.prototype.loadRecord=function(e,t){var o=this;this.cb=t;var n=new c.GuessingDojoHostRecordReq;n.setHostId(e),s.default.inst.GuessingDojoClient.guessingDojoHostRecord(n,s.default.inst.metadata).then(function(e){if(0==e.getCode()){var t=e.getGuessingdojohostrecordresp().toObject();cc.log("recordInfo",t),o._showRecordInfo(t.recordListList)}else s.default.inst.handleCode(e.getCode())}).catch(function(e){cc.log(e)})},t.prototype._showRecordInfo=function(e){this.scrollView.stopAutoScroll(),this.scrollView.scrollToTop(),this.content.removeAllChildren(),this.loadByFrames(e)},t.prototype.loadByFrames=function(e){var t=this,o=e.length,n=0,i=function(){for(var r=Math.min(o-n,30),s=0;s<r;s++)t.addItem(n,e),n++;n<o?t.scheduleOnce(function(){return i()}):t.scheduleOnce(function(){t.improveDC()})};i()},t.prototype.addItem=function(e,t){var o=t[e],n=cc.instantiate(this.item);n.active=!0,n.parent=this.content,n.getChildByName("end").getComponent(cc.Sprite).spriteFrame=this.flagList[o.guessingResult-1],n.getChildByName("me").getComponent(cc.Sprite).spriteFrame=this.gestureSF[o.userGesture-1],n.getChildByName("host").getComponent(cc.Sprite).spriteFrame=this.gestureSF[o.hostGesture-1],1==o.guessingResult&&(n.getChildByName("info").active=!0)},t.prototype.improveDC=function(){if(0!=this.content.childrenCount){var e=this.scrollView.node.parent.convertToWorldSpaceAR(cc.v2(this.scrollView.node.x-this.scrollView.node.anchorX*this.scrollView.node.width,this.scrollView.node.y-this.scrollView.node.anchorY*this.scrollView.node.height)),t=cc.rect(e.x,e.y,this.scrollView.node.width,this.scrollView.node.height);this.content.children.forEach(function(e){e.children.forEach(function(e){e.getBoundingBoxToWorld().intersects(t)?0===e.opacity&&(e.opacity=255):0!==e.opacity&&(e.opacity=0)})})}},r([u(cc.Node)],t.prototype,"mask",void 0),r([u(cc.Node)],t.prototype,"mainLayer",void 0),r([u(cc.ScrollView)],t.prototype,"scrollView",void 0),r([u(cc.Node)],t.prototype,"content",void 0),r([u(cc.Node)],t.prototype,"item",void 0),r([u(cc.SpriteFrame)],t.prototype,"gestureSF",void 0),r([u(cc.SpriteFrame)],t.prototype,"flagList",void 0),r([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../../game/beastMgr":void 0,"../../proto/mystibeast_pb":void 0}],bossSure:[function(e,t,o){"use strict";cc._RF.push(t,"76d9cJpjK1OepVTmXp+aGXp","bossSure");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../core/components/PopupBase"),c=cc._decorator,a=c.ccclass,l=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.title=null,t.rewardGems=null,t.rewardFame=null,t.costGems=null,t.costPowers=null,t.sureCb=null,t}return i(t,e),t.prototype.setData=function(e,t,o,n,i){this.sureCb=i,this.title.getComponent(app.i18nLabel).init(n,[]),this.costGems.string=e,this.rewardGems.string=t,this.rewardFame.string=o},t.prototype.btnCloseClick=function(){this.hide()},t.prototype.onAfterHide=function(){this.node.destroy()},t.prototype.btnSureClick=function(){this.sureCb&&this.sureCb(),this.hide()},r([l(cc.Node)],t.prototype,"title",void 0),r([l(cc.Label)],t.prototype,"rewardGems",void 0),r([l(cc.Label)],t.prototype,"rewardFame",void 0),r([l(cc.Label)],t.prototype,"costGems",void 0),r([l(cc.Label)],t.prototype,"costPowers",void 0),r([a],t)}(s.default);o.default=u,cc._RF.pop()},{"../../core/components/PopupBase":void 0}],flowRecord:[function(e,t,o){"use strict";cc._RF.push(t,"2cf0a0oFfVAabJLZ7//H3u7","flowRecord");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},s=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function s(e){try{a(n.next(e))}catch(t){r(t)}}function c(e){try{a(n.throw(e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,c)}a((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return a([e,t])}}function a(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(c){r=[6,c],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../core/components/LayerBase"),l=e("../../core/scrollview/ScrollViewProCom"),u=e("../../game/beast_config"),p=e("../../game/beastMgr"),h=e("../../proto/mystibeast_pb"),d=e("./flow_item"),f=e("./flow_itemDetail"),g=cc._decorator,y=g.ccclass,m=g.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.toggle2=null,t.scrollView1=null,t.curGems=null,t.curFame=null,t.content1=null,t.scrollView2=null,t.totalGems=null,t.totalFame=null,t.content2=null,t.curType=-1,t.isLoadCur=!1,t.isLoadTotal=!1,t}return i(t,e),t.prototype.setType=function(t,o){e.prototype.setBackCall.call(this,o),1==t&&(this.toggle2.isChecked=!0),this.handleShow(t)},t.prototype.handleShow=function(e){this.curType!=e&&(cc.log(e),this.curType=e,this.scrollView1.node.active=!1,this.scrollView2.node.active=!1,0==e?(this.scrollView1.node.active=!0,this.isLoadCur?this.scrollView1.node.getComponent(cc.ScrollView).scrollToTop(.1):this.loadCurFlow()):(this.scrollView2.node.active=!0,this.isLoadTotal?this.scrollView2.node.getComponent(cc.ScrollView).scrollToTop(.1):this.loadTotalFlow()))},t.prototype.onToggleContainerHandler=function(e){var t=e.node.name;cc.log(t),"toggle1"==t?this.handleShow(0):"toggle2"==t&&this.handleShow(1)},t.prototype.loadCurFlow=function(){var e=this,t=1,o=[],n=0;this.content1.removeAllChildren();var i=new h.GuessingDojoChallengeFlowReq;i.setFlowType(1),i.setPage(t),cc.log(1,t),p.default.inst.GuessingDojoClient.guessingDojoChallengeFlowList(i,p.default.inst.metadata).then(function(i){if(0==i.getCode()){e.isLoadCur=!0;var r=i.getGuessingdojochallengeflowresp().toObject();if(cc.log(r),n=t,e.curGems.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(r.predictGems)),e.curFame.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(r.predictFame),0),e.checkIsNull(r.flowListList))return;if(e.checkIsNull(r.flowListList[0].detailListList))return;e.curGems.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(r.predictGems+r.flowListList[0].gainGems)),e.curFame.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(r.predictFame+r.flowListList[0].fameNum),0),o=o.concat(r.flowListList[0].detailListList),t++,e.scrollView1&&e.scrollView1.setView(r.flowListList[0].detailListList,function(e,t){if(e.getChildByName("title").getComponent(app.i18nLabel).init("static_flow7",[t.hostId.toString()]),1==t.status)e.getChildByName("doing").active=!0,e.getChildByName("info").active=!1;else{e.getChildByName("doing").active=!1;var o=e.getChildByName("info");o.active=!0,o.getChildByName("gain").getComponent(cc.Label).string="+"+MyFun.formatDecimalPlaces(MyFun.getRealNum(t.gainGems/2)),o.getChildByName("cost").getComponent(cc.Label).string="-"+MyFun.formatDecimalPlaces(MyFun.getRealNum(t.revengeGems)),o.getChildByName("gemTotal").getComponent(cc.Label).string="+"+MyFun.formatDecimalPlaces(MyFun.getRealNum(t.gainGems)),o.getChildByName("revengeGem").getComponent(cc.Label).string="+"+MyFun.formatDecimalPlaces(MyFun.getRealNum(t.gainGems/2)),o.getChildByName("fameTotal").getComponent(cc.Label).string="+"+MyFun.formatDecimalPlaces(MyFun.getRealNum(t.fameNum),0)}},function(){if(n!=t){var i=new h.GuessingDojoChallengeFlowReq;i.setFlowType(1),i.setPage(t),p.default.inst.GuessingDojoClient.guessingDojoChallengeFlowList(i,p.default.inst.metadata).then(function(i){if(0==i.getCode()){n=t;var r=i.getGuessingdojochallengeflowresp().toObject();if(e.checkIsNull(r.flowListList))return;e.checkIsNull(r.flowListList[0].detailListList)||(t++,o=o.concat(r.flowListList[0].detailListList),e.scrollView1&&e.scrollView1.updateScroll(o))}else p.default.inst.handleCode(i.getCode())}).catch(function(e){cc.log(e)})}else cc.log("\u6ca1\u6709\u65b0\u6570\u636e")})}else p.default.inst.handleCode(i.getCode())}).catch(function(e){cc.log(e)})},t.prototype.loadTotalFlow=function(){var e=this,t=1,o=[],n=0;this.content2.removeAllChildren();var i=new h.GuessingDojoChallengeFlowReq;i.setFlowType(2),i.setPage(t),cc.log(2,t),p.default.inst.GuessingDojoClient.guessingDojoChallengeFlowList(i,p.default.inst.metadata).then(function(i){if(0==i.getCode()){var r=i.getGuessingdojochallengeflowresp().toObject();if(e.isLoadTotal=!0,cc.log(r),n=t,e.totalGems.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(r.gainGems+r.predictGems)),e.totalFame.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(r.fameNum+r.predictFame),0),e.checkIsNull(r.flowListList))return;o=o.concat(r.flowListList),t++,e.scrollView2&&e.scrollView2.setView(r.flowListList,function(t,o){t.getComponent(d.default).setData(o,function(){return s(e,void 0,void 0,function(){var e,t,n=this;return c(this,function(i){switch(i.label){case 0:return[4,MyFun.loadPrefab(u.getPrefabInfo(u.Bundles.Game_GuessingDojo,u.GuessingDojo_Pop.FlowDetail))];case 1:return e=i.sent(),(t=cc.instantiate(e)).parent=cc.find("Canvas"),this.node.active=!1,t.getComponent(f.default).setData(o.gainGems,o.fameNum,o.detailListList,function(){n.node.active=!0}),[2]}})})})},function(){if(n!=t){var i=new h.GuessingDojoChallengeFlowReq;i.setFlowType(2),i.setPage(t),p.default.inst.GuessingDojoClient.guessingDojoChallengeFlowList(i,p.default.inst.metadata).then(function(i){if(0==i.getCode()){n=t;var r=i.getGuessingdojochallengeflowresp().toObject();e.checkIsNull(r.flowListList)||(t++,o=o.concat(r.flowListList),e.scrollView2&&e.scrollView2.updateScroll(o))}else p.default.inst.handleCode(i.getCode())}).catch(function(e){cc.log(e)})}else cc.log("\u6ca1\u6709\u65b0\u6570\u636e")})}else p.default.inst.handleCode(i.getCode())}).catch(function(e){cc.log(e)})},t.prototype.checkIsNull=function(e){return 0==e},t.prototype.btnCloseClick=function(){e.prototype.onClose.call(this)},r([m(cc.Toggle)],t.prototype,"toggle2",void 0),r([m(l.default)],t.prototype,"scrollView1",void 0),r([m(cc.Label)],t.prototype,"curGems",void 0),r([m(cc.Label)],t.prototype,"curFame",void 0),r([m(cc.Node)],t.prototype,"content1",void 0),r([m(l.default)],t.prototype,"scrollView2",void 0),r([m(cc.Label)],t.prototype,"totalGems",void 0),r([m(cc.Label)],t.prototype,"totalFame",void 0),r([m(cc.Node)],t.prototype,"content2",void 0),r([y],t)}(a.default);o.default=v,cc._RF.pop()},{"../../core/components/LayerBase":void 0,"../../core/scrollview/ScrollViewProCom":void 0,"../../game/beastMgr":void 0,"../../game/beast_config":void 0,"../../proto/mystibeast_pb":void 0,"./flow_item":"flow_item","./flow_itemDetail":"flow_itemDetail"}],flow_itemDetail:[function(e,t,o){"use strict";cc._RF.push(t,"c4f7e69mpBIGI3jmrKbawPl","flow_itemDetail");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../core/components/LayerBase"),c=cc._decorator,a=c.ccclass,l=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollView=null,t.gainGem=null,t.fame=null,t.content=null,t.item=null,t}return i(t,e),t.prototype.setData=function(t,o,n,i){e.prototype.setBackCall.call(this,i),this.gainGem.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(t)),this.fame.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(o),0);for(var r=0;r<n.length;r++){var s=n[r],c=cc.instantiate(this.item);if(c.parent=this.content,c.getChildByName("title").getComponent(app.i18nLabel).init("static_flow7",[s.hostId.toString()]),1==s.status)c.getChildByName("doing").active=!0,c.getChildByName("info").active=!1;else{c.getChildByName("doing").active=!1;var a=c.getChildByName("info");a.active=!0,a.getChildByName("gain").getComponent(cc.Label).string="+"+MyFun.formatDecimalPlaces(MyFun.getRealNum(s.gainGems/2)),a.getChildByName("cost").getComponent(cc.Label).string="-"+MyFun.formatDecimalPlaces(MyFun.getRealNum(s.revengeGems)),a.getChildByName("gemTotal").getComponent(cc.Label).string="+"+MyFun.formatDecimalPlaces(MyFun.getRealNum(s.gainGems)),a.getChildByName("revengeGem").getComponent(cc.Label).string="+"+MyFun.formatDecimalPlaces(MyFun.getRealNum(s.gainGems/2)),a.getChildByName("fameTotal").getComponent(cc.Label).string="+"+MyFun.formatDecimalPlaces(MyFun.getRealNum(s.fameNum),0)}}},t.prototype.improveDC=function(){if(0!=this.content.childrenCount){var e=this.scrollView.node.parent.convertToWorldSpaceAR(cc.v2(this.scrollView.node.x-this.scrollView.node.anchorX*this.scrollView.node.width,this.scrollView.node.y-this.scrollView.node.anchorY*this.scrollView.node.height)),t=cc.rect(e.x,e.y,this.scrollView.node.width,this.scrollView.node.height);this.content.children.forEach(function(e){e.children.forEach(function(e){e.getBoundingBoxToWorld().intersects(t)?0===e.opacity&&(e.opacity=255):0!==e.opacity&&(e.opacity=0)})})}},t.prototype.btnCloseClick=function(){e.prototype.onClose.call(this)},r([l(cc.ScrollView)],t.prototype,"scrollView",void 0),r([l(cc.Label)],t.prototype,"gainGem",void 0),r([l(cc.Label)],t.prototype,"fame",void 0),r([l(cc.Node)],t.prototype,"content",void 0),r([l(cc.Prefab)],t.prototype,"item",void 0),r([a],t)}(s.default);o.default=u,cc._RF.pop()},{"../../core/components/LayerBase":void 0}],flow_item:[function(e,t,o){"use strict";cc._RF.push(t,"32999q0qdhCv5oXL5nK25zy","flow_item");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},s=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function s(e){try{a(n.next(e))}catch(t){r(t)}}function c(e){try{a(n.throw(e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,c)}a((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return a([e,t])}}function a(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(c){r=[6,c],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../game/beastMgr"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.title=null,t.income=null,t.flag_pass=null,t.flag_doing=null,t.gem=null,t.fame=null,t.item=null,t.btn_detail=null,t.detailCb=null,t.curDetailList=[],t}return i(t,e),t.prototype.start=function(){},t.prototype.setData=function(e,t){var o=MyFun.findItemFromArr(a.default.inst.dojoWineConfigList,"wineType",e.wineType),n=app.i18nMgr._getLabel(o.name,[]),i=app.i18nMgr._getLabel("static_flow7",[e.currentHost.toString()]),r=app.i18nMgr._getLabel("static_flow14",[100*(1-e.failRate/1e4)+"%"]);this.title.getComponent(cc.Label).string=n+":"+i,this.income.getComponent(cc.Label).string="("+r+")",this.gem.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(e.gainGems)),this.fame.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(e.fameNum),0),2==e.status?(this.flag_pass.active=!0,this.flag_doing.active=!1):3==e.status&&(this.flag_doing.active=!0,this.flag_pass.active=!1),this.curDetailList=e.detailListList,this.detailCb=t},t.prototype.btnDetailClick=function(){return s(this,void 0,void 0,function(){return c(this,function(){return this.detailCb&&this.detailCb(),[2]})})},r([p(cc.Node)],t.prototype,"title",void 0),r([p(cc.Node)],t.prototype,"income",void 0),r([p(cc.Node)],t.prototype,"flag_pass",void 0),r([p(cc.Node)],t.prototype,"flag_doing",void 0),r([p(cc.Label)],t.prototype,"gem",void 0),r([p(cc.Label)],t.prototype,"fame",void 0),r([p(cc.Prefab)],t.prototype,"item",void 0),r([p(cc.Node)],t.prototype,"btn_detail",void 0),r([u],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../../game/beastMgr":void 0}],guessingDojo:[function(e,t,o){"use strict";cc._RF.push(t,"2ef4b3vERVDooEERnSmrRwo","guessingDojo");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},s=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function s(e){try{a(n.next(e))}catch(t){r(t)}}function c(e){try{a(n.throw(e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,c)}a((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return a([e,t])}}function a(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(c){r=[6,c],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../core/components/gameBase"),l=e("../../game/beast_config"),u=e("../../game/beastMgr"),p=e("../../proto/mystibeast_pb"),h=e("./bossInfo"),d=e("./bossRecord"),f=e("./bossSure"),g=e("./flowRecord"),y=e("./guessingdojo_punchAni"),m=e("./guessingdojo_rank"),v=e("./guessingdojo_result"),b=e("./pauseGame"),w=e("./power"),_=cc._decorator,C=_.ccclass,P=_.property,L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mainLayer=null,t.bgList=[],t.wineScrollView=null,t.wineList=null,t.title=null,t.power=null,t.powerTimer=null,t.gems=null,t.jackpot=null,t.prizeTip=null,t.noticeN=null,t.noticeItem=null,t.iconHost=null,t.hostHp=null,t.hpTip=null,t.startMenu=null,t.dojoName=null,t.passGetLab=null,t.passGetFame=null,t.costGems=null,t.challengeNode=null,t.bossSpr=null,t.bossProgress=null,t.btn_back=null,t.bossList=null,t.btnRecord=null,t.punchList=null,t.energyBall=null,t.energyBallSke=null,t.energyTip=null,t.energyProgress=null,t.playerHp=null,t.hpItem=null,t.doorSke=null,t.curWineName="",t.curEndTime=0,t.energyTimeFun=null,t.wineProgress=1,t.totalHp=0,t.curBossIndex=1,t.curWineType=1,t.isClickStarting=!1,t.curPunchIndex=0,t.isClickPunching=!1,t.isShowEndingAni=!1,t.maxAccPoint=0,t.myAccPoint=0,t.isEnergyBallClicking=!1,t}return i(t,e),t.prototype.start=function(){this._getGuessingDojoInfo(),e.prototype.start.call(this),this._addWineSelectListener()},t.prototype._addWineSelectListener=function(){for(var e=this,t=function(t){o.wineList.children[t].on("click",function(){e.curWineType=t+1,e.wineSelectHandler()})},o=this,n=0,i=this.wineList.childrenCount;n<i;n++)t(n)},t.prototype.setWineUnlockState=function(){for(var e=0;e<this.wineList.childrenCount;e++){var t=this.wineList.children[e];e+1<=this.wineProgress&&(t.children[1].active=!1)}this.wineProgress>=5&&this.wineScrollView.scrollToOffset(cc.v2(628,0),.1)},t.prototype.resetWineSelect=function(){for(var e=0;e<this.wineList.childrenCount;e++){var t=this.wineList.children[e];cc.tween(t).to(.2,{scale:1}).start(),t.children[2].active=!1}},t.prototype.wineLeftClick=function(){this.curWineType<=1||(this.curWineType--,3==this.curWineType&&this.wineScrollView.scrollToOffset(cc.v2(0,0),.1),this.wineSelectHandler())},t.prototype.wineRightClick=function(){this.curWineType>=7||(this.curWineType++,5==this.curWineType&&this.wineScrollView.scrollToOffset(cc.v2(628,0),.1),this.wineSelectHandler())},t.prototype.initState=function(){this.curWineType>=5?this.wineScrollView.scrollToOffset(cc.v2(628,0),.1):this.wineScrollView.scrollToOffset(cc.v2(0,0),.1)},t.prototype.wineSelectHandler=function(){this.resetWineSelect(),this.wineList.children[this.curWineType-1].children[2].active=!0,cc.tween(this.wineList.children[this.curWineType-1]).to(.2,{scale:1.2}).start(),this.mainLayer.getComponent(cc.Sprite).spriteFrame=this.bgList[this.curWineType-1];var e=MyFun.findItemFromArr(u.default.inst.dojoWineConfigList,"wineType",this.curWineType);this.curWineName=e.name,this.dojoName.parent.active=!0,this.dojoName.getComponent(app.i18nLabel).init(this.curWineName,[]),this.passGetLab.string=MyFun.formatDecimalPlaces(e.cost*this.getTotalRate()),this.costGems.string=MyFun.formatDecimalPlaces(e.cost,0),this.passGetFame.string=MyFun.formatDecimalPlaces(e.cost*this.getTotalFame()*2,0)},t.prototype.getTotalRate=function(){var e=0;return u.default.inst.dojoHostConfigList.forEach(function(t){e+=t.basicRate}),e/1e4},t.prototype.getTotalFame=function(){var e=0;return u.default.inst.dojoHostConfigList.forEach(function(t){e+=t.fameBasic}),e},t.prototype.showEnergyTime=function(e,t){this.curEndTime=t;var o=t-e;cc.log("leftTime: "+o,"endTime: "+MyFun.formattedDateTime(1e3*t)),o>=0&&(30-u.default.inst.curPower>1?(o-=1800*(30-u.default.inst.curPower-1),cc.log(o),this.showTime(o,this.powerTimer)):this.showTime(o,this.powerTimer))},t.prototype.showTime=function(e,t){var o=this,n=MyFun.formatTimeToHMS(e);this.unschedule(this.energyTimeFun),e<=0?t.getComponent(cc.Label).string="":(t.getComponent(cc.Label).string=n+app.i18nMgr._getLabel("static_power4",[]),u.default.inst.recoverPowerTime=e,u.default.inst.recoverPowerTime--,this.schedule(this.energyTimeFun=function(){u.default.inst.recoverPowerTime>=0?(n=MyFun.formatTimeToHMS(u.default.inst.recoverPowerTime),t.getComponent(cc.Label).string=n+app.i18nMgr._getLabel("static_power4",[]),u.default.inst.recoverPowerTime--):(u.default.inst.curPower++,o.refreshPlayerInfo(),t.getComponent(cc.Label).string=n+app.i18nMgr._getLabel("static_power4",[]),30-u.default.inst.curPower>0?o.showTime(1800,t):(o.unschedule(o.energyTimeFun),t.getComponent(cc.Label).string="",u.default.inst.recoverPowerTime=-5))},1))},t.prototype._getGuessingDojoInfo=function(){var e=this,t=new p.GuessingDojoHostChallengeInfoReq;u.default.inst.GuessingDojoClient.guessingDojoHostChallengeInfo(t,u.default.inst.metadata).then(function(t){if(0==t.getCode()){var o=t.getGuessingdojohostchallengeinforesp().toObject();cc.log(o),e.wineProgress=o.unlockMaxWine,e.setWineUnlockState(),e.handlePlayerInfo(o),null==o.currentChallenge&&e.handleJackpotData(o.jackpot),e.handleNoticeData(o.noticeListList),e.handleCurrentChallengeInfo(o.currentChallenge,o.revengeNeedGems,o.predictWinGems,o.predictFailGems),e.showEnergyTime(o.nowTime,o.powerMaxTime)}else u.default.inst.handleCode(t.getCode())}).catch(function(e){cc.log(e),u.default.inst.handleCode(e.code)})},t.prototype.handlePlayerInfo=function(e){u.default.inst.myGems=MyFun.getRealNum(e.myGemsNum),u.default.inst.curPower=e.myPowerNum,this.refreshPlayerInfo()},t.prototype.refreshPlayerInfo=function(){this.power.string=MyFun.formatDecimalPlaces(u.default.inst.curPower),this.gems.string=MyFun.formatDecimalPlaces(u.default.inst.myGems)},t.prototype.handleJackpotData=function(e){this.prizeTip.getComponent(app.i18nLabel).init("static_main2",[]),this.jackpot.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(e.gemsNum))},t.prototype.handleNoticeData=function(e){e.length>0&&(this.noticeN.active=!0,this.showNoticeLoop(0,e))},t.prototype.showNoticeLoop=function(e,t){var o=this;this.noticeN.children[0].removeAllChildren();var n=t[e],i=cc.instantiate(this.noticeItem);i.active=!0,i.parent=this.noticeN.children[0];var r="";if(n.wineType>0){var s=MyFun.findItemFromArr(u.default.inst.dojoWineConfigList,"wineType",n.wineType);r=app.i18nMgr._getLabel(s.name,[])}i.getChildByName("info").getComponent(app.i18nRichText).init("static_main8",[MyFun.maskName(n.userNickname),r,n.hostId+""]),i.getChildByName("num").getComponent(cc.Label).string=MyFun.formatDecimalPlaces(MyFun.getRealNum(n.gainGems)),cc.tween(i).set({x:750}).to(5,{x:-750}).set({x:750}).call(function(){e=(e+1)%t.length,o.showNoticeLoop(e,t)}).start()},t.prototype.handleCurrentChallengeInfo=function(e,t,o,n){return s(this,void 0,void 0,function(){var i,r=this;return c(this,function(a){switch(a.label){case 0:return cc.log(e),null!=e?[3,2]:(this.challengeNode.active=!1,this.energyBallSke.node.active=!1,this.startMenu.active=!0,this.curBossIndex=1,this.curWineType=this.wineProgress,this.wineSelectHandler(),this.btn_back.active=!1,this.hostHp.active=!1,i=this.bossSpr,[4,MyFun.loadPicFromBundle(l.Bundles.Game_GuessingDojo,"boss","1")]);case 1:return i.spriteFrame=a.sent(),this.title.getComponent(app.i18nLabel).init("static_main1",[]),this.power.node.parent.active=!0,app.AudioMgr.playMusic(l.Bundles.Game_GuessingDojo,"GymChallengeHallBgm"),[3,3];case 2:u.default.inst.revengeHost==e.currentHost?(app.AudioMgr.playMusic(l.Bundles.Game_GuessingDojo,"GymChallengeInteriorBgm"),this.handleInfo(e),3==e.challengeStatus&&this._showResult(e,t)):(this.doorSke.node.active=!0,this.doorSke.setAnimation(0,"kaimen",!1),this.doorSke.setCompleteListener(function(){return s(r,void 0,void 0,function(){return c(this,function(){return app.AudioMgr.playMusic(l.Bundles.Game_GuessingDojo,"GymChallengeInteriorBgm"),3==e.challengeStatus?this._showResult(e,t):this.showBossInfo(e,o,n),this.doorSke.setCompleteListener(null),this.doorSke.node.active=!1,[2]})})}),this.scheduleOnce(function(){r.handleInfo(e)},.5)),a.label=3;case 3:return[2]}})})},t.prototype._handleHp=function(e,t){t.active=!0,t.removeAllChildren();for(var o=0;o<this.totalHp;o++){var n=cc.instantiate(this.hpItem);n.active=!0,n.parent=t,n.children[0].active=this.totalHp-e>o}},t.prototype.btnStartClicked=function(){var e=this;this.curWineType>this.wineProgress?u.default.inst.showWarning("static_tip3"):this.isClickStarting||(this.isClickStarting=!0,this.scheduleOnce(function(){e.isClickStarting=!1},1),this.showBossSure())},t.prototype.showBossSure=function(){return s(this,void 0,void 0,function(){var e,t,o=this;return c(this,function(n){switch(n.label){case 0:return[4,MyFun.loadPrefab(l.getPrefabInfo(l.Bundles.Game_GuessingDojo,l.GuessingDojo_Pop.BossSure))];case 1:return e=n.sent(),(t=cc.instantiate(e)).parent=this.node,t.getComponent(f.default).setData(this.costGems.string,this.passGetLab.string,this.passGetFame.string,this.curWineName,function(){o.sureStartChallenge()}),[2]}})})},t.prototype.sureStartChallenge=function(){var e=this,t=new p.GuessingDojoHostChallengeStartReq;t.setWineType(this.curWineType),u.default.inst.GuessingDojoClient.guessingDojoHostChallengeStart(t,u.default.inst.metadata).then(function(t){if(0==t.getCode()){var o=t.getGuessingdojohostchallengestartresp().toObject();cc.log(o),u.default.inst.myGems=MyFun.getRealNum(o.myGemsNum),u.default.inst.curPower=o.myPowerNum,e.startMenu.active=!1,e.refreshPlayerInfo(),e.doorSke.node.active=!0,e.doorSke.setAnimation(0,"kaimen",!1),e.doorSke.setCompleteListener(function(){return s(e,void 0,void 0,function(){return c(this,function(){return this.doorSke.setCompleteListener(null),this.doorSke.node.active=!1,this.showBossInfo(o.currentChallenge,o.predictWinGems,o.predictFailGems),app.AudioMgr.playMusic(l.Bundles.Game_GuessingDojo,"GymChallengeInteriorBgm"),this.handleInfo(o.currentChallenge),this.showEnergyTime(o.nowTime,o.powerMaxTime),[2]})})})}else u.default.inst.handleCode(t.getCode())}).catch(function(e){cc.log(e.toString())})},t.prototype.wait=function(e){var t=this;return new Promise(function(o){t.scheduleOnce(function(){o()},e)})},t.prototype.showBossInfo=function(e,t,o){return s(this,void 0,void 0,function(){var n,i;return c(this,function(r){switch(r.label){case 0:return[4,MyFun.loadPrefab(l.getPrefabInfo(l.Bundles.Game_GuessingDojo,l.GuessingDojo_Pop.BossInfo))];case 1:return n=r.sent(),[4,this.wait(.2)];case 2:return r.sent(),(i=cc.instantiate(n)).parent=this.node,i.getComponent(h.default).setData(e,t,o),this.prizeTip.getComponent(app.i18nLabel).init("static_main11",[]),this.jackpot.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(t)),[2]}})})},t.prototype.handleInfo=function(e){return s(this,void 0,void 0,function(){var t,o;return c(this,function(n){switch(n.label){case 0:return t=MyFun.findItemFromArr(u.default.inst.dojoWineConfigList,"wineType",e.wineType),this.btn_back.active=!0,this.noticeN.active=!1,this.dojoName.parent.active=!1,this.title.getComponent(app.i18nLabel).init(t.name,[]),this.power.node.parent.active=!1,this.curWineType=e.wineType,this.mainLayer.getComponent(cc.Sprite).spriteFrame=this.bgList[this.curWineType-1],this.startMenu.active=!1,this.challengeNode.active=!0,this.curBossIndex=e.currentHost,o=this.bossSpr,[4,MyFun.loadPicFromBundle(l.Bundles.Game_GuessingDojo,"boss",e.currentHost.toString())];case 1:return o.spriteFrame=n.sent(),this.handleBossProgress(),this.maxAccPoint=e.maxAccpoint,this.myAccPoint=e.myAccpoint,this.energyBall.fillRange=this.myAccPoint/this.maxAccPoint,this.handlerEnergyProgress(),this.totalHp=e.targetNum,this._handleHp(e.userWinNum,this.hostHp),this._handleHp(e.hostWinNum,this.playerHp),this.resetPunchSet(),[2]}})})},t.prototype.handleBossProgress=function(){cc.tween(this.bossProgress).to(.1,{progress:(this.curBossIndex-1)/6}).start();for(var e=0;e<this.bossList.childrenCount;e++){var t=this.bossList.children[e];e<this.curBossIndex-1?(t.children[0].active=!0,t.children[1].active=!1):e==this.curBossIndex-1?t.children[1].active=!0:(t.children[0].active=!1,t.children[1].active=!1)}},t.prototype.resetPunchSet=function(){this.punchList.children.forEach(function(e){e.children[0].active=!1}),this.curPunchIndex=0},t.prototype.punchesSet=function(e,t){t==this.curPunchIndex||this.isShowEndingAni||(this.resetPunchSet(),this.curPunchIndex=t,e.target.children[0].active=!0)},t.prototype.btnPunchesClicked=function(){var e=this;if(!this.isClickPunching&&!this.isShowEndingAni)if(0!=this.curPunchIndex){this.isClickPunching=!0,this.scheduleOnce(function(){e.isClickPunching=!1},1);var t=new p.GuessingDojoHostChallengeResultReq;t.setMyGesture(this.curPunchIndex),u.default.inst.GuessingDojoClient.guessingDojoHostChallengeResult(t,u.default.inst.metadata).then(function(t){if(0==t.getCode()){var o=t.getGuessingdojohostchallengeresultresp().toObject();cc.log("punchResult",o),e.resetPunchSet(),e.myAccPoint=o.myAccpoint,e._showPunchAni(o)}else cc.log(t.getCode(),t.getMsg()),u.default.inst.handleCode(t.getCode())}).catch(function(e){cc.log(e)})}else u.default.inst.showWarning("static_tip1")},t.prototype._showPunchAni=function(e){return s(this,void 0,void 0,function(){var t,o,n=this;return c(this,function(i){switch(i.label){case 0:return this.isShowEndingAni=!0,[4,MyFun.loadPrefab(l.getPrefabInfo(l.Bundles.Game_GuessingDojo,l.GuessingDojo_Pop.PunchAni))];case 1:return t=i.sent(),(o=cc.instantiate(t)).parent=this.node,o.getComponent(y.default).setData(e,function(){app.AudioMgr.resumeMusic(),2==e.guessingResult?n.hostDamagedAni(function(){n.handleHpAndEnergyBall(e)}):3==e.guessingResult?n.playerDamagedAni(function(){n.handleHpAndEnergyBall(e)}):(n.energyBallSke.node.active=!0,app.AudioMgr.play(l.Bundles.Game_GuessingDojo,"CollectEnergy"),n.energyBallSke.setAnimation(0,"nengliang+1",!1),n.energyBallSke.setCompleteListener(function(){n.energyBall.fillRange<1&&(n.energyTip.getComponent(app.i18nLabel).init("+1",[]),cc.tween(n.energyTip).set({active:!0,opacity:255}).by(.5,{y:80}).set({opacity:0}).by(.1,{y:-80}).set({active:!1}).start()),n.handleHpAndEnergyBall(e),n.energyBallSke.setCompleteListener(null),n.energyBallSke.node.active=!1}))}),[2]}})})},t.prototype.hostDamagedAni=function(e){cc.tween(this.iconHost.node).parallel(cc.tween().to(.1,{color:new cc.Color(255,132,132,255)}),cc.tween().by(.1,{x:5,y:3}).by(.1,{x:-5,y:-3}).by(.1,{x:-3,y:-5}).by(.1,{x:3,y:5})).set({color:new cc.Color(255,255,255,255)}).delay(.2).call(function(){e&&e()}).start()},t.prototype.playerDamagedAni=function(e){this.shakeEffect(this.node,e)},t.prototype.handleHpAndEnergyBall=function(e){var t=this;app.AudioMgr.play(l.Bundles.Game_GuessingDojo,"WithholdBlood"),2==e.guessingResult?cc.tween(this.hpTip).set({active:!0,opacity:255}).parallel(cc.tween().by(.5,{y:100}),cc.tween().to(.5,{opacity:0})).call(function(){t.hpAni(e.userWinNum,t.hostHp,function(){1!==e.challengeResult?t._showResult(e):t.isShowEndingAni=!1})}).by(.1,{y:-100}).call(function(){t.hpTip.active=!1}).start():3==e.guessingResult?this.hpAni(e.hostWinNum,this.playerHp,function(){1!==e.challengeResult?t._showResult(e):t.isShowEndingAni=!1}):this.isShowEndingAni=!1,this.refreshEnergyBall()},t.prototype.hpAni=function(e,t,o){return s(this,void 0,void 0,function(){var n;return c(this,function(){return t.children[this.totalHp-e].children[0].active=!1,(n=t.children[this.totalHp-e].children[1]).active=!0,n.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),n.getComponent(sp.Skeleton).setCompleteListener(function(){n.getComponent(sp.Skeleton).setCompleteListener(null),n.active=!1,o&&o()}),[2]})})},t.prototype.shakeEffect=function(e,t){cc.Tween.stopAllByTarget(e),cc.tween(e).sequence(cc.moveTo(.02,cc.v2(5,7)),cc.moveTo(.02,cc.v2(-6,7)),cc.moveTo(.02,cc.v2(-13,3)),cc.moveTo(.02,cc.v2(3,-6)),cc.moveTo(.02,cc.v2(-5,5)),cc.moveTo(.02,cc.v2(2,-8)),cc.moveTo(.02,cc.v2(-8,-10)),cc.moveTo(.02,cc.v2(3,10)),cc.moveTo(.02,cc.v2(0,0))).repeat(2).delay(.2).call(function(){t&&t()}).start()},t.prototype._showResult=function(e,t){return s(this,void 0,void 0,function(){var o,n,i=this;return c(this,function(r){switch(r.label){case 0:return[4,MyFun.loadPrefab(l.getPrefabInfo(l.Bundles.Game_GuessingDojo,l.GuessingDojo_Pop.Result))];case 1:return o=r.sent(),(n=cc.instantiate(o)).parent=this.node,n.getComponent(v.default).showResult(e,function(){i.isShowEndingAni=!1,i._getGuessingDojoInfo()},this.curWineType,this.wineProgress,t),[2]}})})},t.prototype.refreshEnergyBall=function(){var e=this;cc.tween(this.energyBall).to(.5,{fillRange:this.myAccPoint/this.maxAccPoint}).call(function(){e.handlerEnergyProgress()}).start()},t.prototype.handlerEnergyProgress=function(){this.energyProgress.getComponent(app.i18nLabel).init(this.myAccPoint+"/"+this.maxAccPoint,[]),this.myAccPoint==this.maxAccPoint&&(this.energyProgress.getComponent(app.i18nLabel).init("static_main10",[]),this.energyBallSke.node.active=!0,this.energyBallSke.setAnimation(0,"nengliangman",!0))},t.prototype.btnEnergyBallClicked=function(){var e=this;if(!this.isEnergyBallClicking&&!this.isShowEndingAni)if(this.myAccPoint<6)u.default.inst.showWarning("static_tip2");else{this.isEnergyBallClicking=!0,this.scheduleOnce(function(){e.isEnergyBallClicking=!1},1);var t=new p.GuessingDojoHostChallengeWinReq;u.default.inst.GuessingDojoClient.guessingDojoHostChallengeWin(t,u.default.inst.metadata).then(function(t){if(0==t.getCode()){var o=t.getGuessingdojohostchallengeresultresp().toObject();cc.log(o),e.myAccPoint=o.myAccpoint,e.resetPunchSet(),e.isShowEndingAni=!0,e.energyBallSke.node.active=!0,app.AudioMgr.play(l.Bundles.Game_GuessingDojo,"EnergyEmission"),e.energyBallSke.setAnimation(0,"gongji",!1),e.energyBallSke.setCompleteListener(function(){e.refreshEnergyBall(),e.energyBallSke.setCompleteListener(null),e.energyBallSke.node.active=!1,e.hostDamagedAni(function(){e.handleHpAndEnergyBall(o)})})}else u.default.inst.handleCode(t.getCode())}).catch(function(e){cc.log(e)})}},t.prototype.btnCloseClicked=function(){u.default.inst.backToApp()},t.prototype.btnEnergyClicked=function(){return s(this,void 0,void 0,function(){var e,t,o=this;return c(this,function(n){switch(n.label){case 0:return[4,MyFun.loadPrefab(l.getPrefabInfo(l.Bundles.Game_GuessingDojo,l.GuessingDojo_Pop.Power))];case 1:return e=n.sent(),(t=cc.instantiate(e)).getComponent(w.default).setData(function(){o.btnBeastChallengeClicked()}),t.parent=this.node,[2]}})})},t.prototype.btnRecordClicked=function(){return s(this,void 0,void 0,function(){var e,t,o=this;return c(this,function(n){switch(n.label){case 0:return[4,MyFun.loadPrefab(l.getPrefabInfo(l.Bundles.Game_GuessingDojo,l.GuessingDojo_Pop.Record))];case 1:return e=n.sent(),(t=cc.instantiate(e)).parent=this.node,this.btnRecord.active=!1,t.getComponent(d.default).loadRecord(this.curBossIndex,function(){o.btnRecord.active=!0}),[2]}})})},t.prototype.btnFlowClicked=function(){return s(this,void 0,void 0,function(){var e,t,o,n=this;return c(this,function(i){switch(i.label){case 0:return[4,MyFun.loadPrefab(l.getPrefabInfo(l.Bundles.Game_GuessingDojo,l.GuessingDojo_Pop.Flow))];case 1:return e=i.sent(),(t=cc.instantiate(e)).parent=this.node,this.mainLayer.opacity=0,o=this.startMenu.active?1:0,t.getComponent(g.default).setType(o,function(){u.default.inst.curLayer=u.Layer.MAIN,n.mainLayer.opacity=255}),[2]}})})},t.prototype.btnRankClicked=function(){return s(this,void 0,void 0,function(){var e,t,o=this;return c(this,function(n){switch(n.label){case 0:return[4,MyFun.loadPrefab(l.getPrefabInfo(l.Bundles.Game_GuessingDojo,l.GuessingDojo_Pop.Rank))];case 1:return e=n.sent(),(t=cc.instantiate(e)).parent=this.node,this.mainLayer.opacity=0,t.getComponent(m.default).setCall(function(){u.default.inst.curLayer=u.Layer.MAIN,o.mainLayer.opacity=255}),[2]}})})},t.prototype.showPauseGame=function(){return s(this,void 0,void 0,function(){var e,t,o=this;return c(this,function(n){switch(n.label){case 0:return[4,MyFun.loadPrefab(l.getPrefabInfo(l.Bundles.Game_GuessingDojo,l.GuessingDojo_Pop.PauseGame))];case 1:return e=n.sent(),(t=cc.instantiate(e)).parent=this.node,t.getComponent(b.default).setCall(function(){var e=new p.GuessingDojoHostFailAbandonReq;u.default.inst.GuessingDojoClient.guessingDojoHostFailAbandon(e,u.default.inst.metadata).then(function(e){if(0==e.getCode()){var t=e.getGuessingdojohostfailabandonresp().toObject();cc.log("\u653e\u5f03",t),o._getGuessingDojoInfo(),u.default.inst.myGems=MyFun.getRealNum(t.myGemsNum)}else u.default.inst.handleCode(e.getCode())}).catch(function(e){cc.log(e)})}),[2]}})})},t.prototype.onToggleContainerHandler=function(e){var t=e.node.name;cc.log(t),"toggle1"==t||"toggle2"==t&&u.default.inst.showWarning("\u6682\u672a\u5f00\u653e\uff01")},t.prototype.btnBeastChallengeClicked=function(){return s(this,void 0,void 0,function(){var e;return c(this,function(t){switch(t.label){case 0:return[4,MyFun.loadPrefab(l.getPrefabInfo(l.Bundles.Game_GuessingDojo,l.GuessingDojo_Pop.BeastChallenge))];case 1:return e=t.sent(),cc.instantiate(e).parent=this.node.parent,this.node.destroy(),[2]}})})},t.prototype.btnGemsClicked=function(){return s(this,void 0,void 0,function(){return c(this,function(){return u.default.inst.sendMsgToUniApp("gems"),[2]})})},t.prototype.scrollToRuleInfo=function(){},r([P(cc.Node)],t.prototype,"mainLayer",void 0),r([P(cc.SpriteFrame)],t.prototype,"bgList",void 0),r([P(cc.ScrollView)],t.prototype,"wineScrollView",void 0),r([P(cc.Node)],t.prototype,"wineList",void 0),r([P(cc.Node)],t.prototype,"title",void 0),r([P(cc.Label)],t.prototype,"power",void 0),r([P(cc.Node)],t.prototype,"powerTimer",void 0),r([P(cc.Label)],t.prototype,"gems",void 0),r([P(cc.Label)],t.prototype,"jackpot",void 0),r([P(cc.Node)],t.prototype,"prizeTip",void 0),r([P(cc.Node)],t.prototype,"noticeN",void 0),r([P(cc.Node)],t.prototype,"noticeItem",void 0),r([P(cc.Sprite)],t.prototype,"iconHost",void 0),r([P(cc.Node)],t.prototype,"hostHp",void 0),r([P(cc.Node)],t.prototype,"hpTip",void 0),r([P(cc.Node)],t.prototype,"startMenu",void 0),r([P(cc.Node)],t.prototype,"dojoName",void 0),r([P(cc.Label)],t.prototype,"passGetLab",void 0),r([P(cc.Label)],t.prototype,"passGetFame",void 0),r([P(cc.Label)],t.prototype,"costGems",void 0),r([P(cc.Node)],t.prototype,"challengeNode",void 0),r([P(cc.Sprite)],t.prototype,"bossSpr",void 0),r([P(cc.ProgressBar)],t.prototype,"bossProgress",void 0),r([P(cc.Node)],t.prototype,"btn_back",void 0),r([P(cc.Node)],t.prototype,"bossList",void 0),r([P(cc.Node)],t.prototype,"btnRecord",void 0),r([P(cc.Node)],t.prototype,"punchList",void 0),r([P(cc.Sprite)],t.prototype,"energyBall",void 0),r([P(sp.Skeleton)],t.prototype,"energyBallSke",void 0),r([P(cc.Node)],t.prototype,"energyTip",void 0),r([P(cc.Node)],t.prototype,"energyProgress",void 0),r([P(cc.Node)],t.prototype,"playerHp",void 0),r([P(cc.Node)],t.prototype,"hpItem",void 0),r([P(sp.Skeleton)],t.prototype,"doorSke",void 0),r([C],t)}(a.default);o.default=L,cc._RF.pop()},{"../../core/components/gameBase":void 0,"../../game/beastMgr":void 0,"../../game/beast_config":void 0,"../../proto/mystibeast_pb":void 0,"./bossInfo":"bossInfo","./bossRecord":"bossRecord","./bossSure":"bossSure","./flowRecord":"flowRecord","./guessingdojo_punchAni":"guessingdojo_punchAni","./guessingdojo_rank":"guessingdojo_rank","./guessingdojo_result":"guessingdojo_result","./pauseGame":"pauseGame","./power":"power"}],guessingdojo_punchAni:[function(e,t,o){"use strict";cc._RF.push(t,"89073Q71rxGFKIPBgfQxyUh","guessingdojo_punchAni");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../game/beast_config"),c=cc._decorator,a=c.ccclass,l=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bgSke=null,t.playerPunch=null,t.playerItem=null,t.hostPunch=null,t.hostItem=null,t.flag=null,t.gestureList=[],t.flagList=[],t.total=20,t}return i(t,e),t.prototype.setData=function(e,t){var o=this;app.AudioMgr.pauseMusic(),this.bgSke.setAnimation(0,"BG",!1),this.loadPunchList(this.hostPunch,this.hostItem,e.hostGesture),this.loadPunchList(this.playerPunch,this.playerItem,e.myGesture),app.AudioMgr.play(s.Bundles.Game_GuessingDojo,"GamblingProcess"),this._rollingAni(this.playerPunch,21,-100,function(){o.flag.getComponent(cc.Sprite).spriteFrame=o.flagList[e.guessingResult-1],cc.tween(o.flag).delay(.4).set({scale:3,active:!0}).to(.2,{scale:.6}).call(function(){app.AudioMgr.play(s.Bundles.Game_GuessingDojo,"GamblingResults")}).to(.1,{scale:1}).call(function(){2==e.guessingResult?(app.AudioMgr.play(s.Bundles.Game_GuessingDojo,"FistKnockFlying"),cc.tween(o.playerPunch).to(.2,{y:80}).call(function(){cc.tween(o.hostPunch).to(.2,{position:cc.v3(o.hostPunch.x,1e3)}).call(function(){o.waitToDestroy(.5,t)}).start()}).to(.1,{y:-280}).start()):3==e.guessingResult?(app.AudioMgr.play(s.Bundles.Game_GuessingDojo,"FistKnockFlying"),cc.tween(o.hostPunch).to(.2,{y:-80}).call(function(){cc.tween(o.playerPunch).to(.2,{position:cc.v3(o.playerPunch.x,-1e3)}).call(function(){o.waitToDestroy(.5,t)}).start()}).to(.1,{y:280}).start()):o.waitToDestroy(.3,t)}).start()}),this._rollingAni(this.hostPunch,21,100)},t.prototype.loadPunchList=function(e,t,o){for(var n=0,i=0;n<20;n++){var r=cc.instantiate(t);r.parent=e,r.active=!0,r.children[0].getComponent(cc.Sprite).spriteFrame=this.gestureList[i],++i>2&&(i=0)}var s=cc.instantiate(this.playerItem);s.children[0].getComponent(cc.Sprite).spriteFrame=this.gestureList[o-1],s.parent=e,s.active=!0},t.prototype._rollingAni=function(e,t,o,n){var i=e.children[0].width+300;e.x=o;var r=o<0?-1:1,s=t/21*1.5;cc.tween(e).parallel(cc.tween().to(s,{position:cc.v3(o+r*i*(t-1),e.y,0)},{easing:"sineInOut"}).call(function(){cc.tween(e.children[21]).to(.2,{scale:1.3}).to(.2,{scale:1}).call(function(){n&&n()}).start()}),cc.tween().delay(.2*s).call(function(){})).start()},t.prototype.waitToDestroy=function(e,t){var o=this;this.scheduleOnce(function(){t&&t(),o.node.destroy()},e)},r([l(sp.Skeleton)],t.prototype,"bgSke",void 0),r([l(cc.Node)],t.prototype,"playerPunch",void 0),r([l(cc.Node)],t.prototype,"playerItem",void 0),r([l(cc.Node)],t.prototype,"hostPunch",void 0),r([l(cc.Node)],t.prototype,"hostItem",void 0),r([l(cc.Node)],t.prototype,"flag",void 0),r([l(cc.SpriteFrame)],t.prototype,"gestureList",void 0),r([l(cc.SpriteFrame)],t.prototype,"flagList",void 0),r([a],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../../game/beast_config":void 0}],guessingdojo_rank:[function(e,t,o){"use strict";cc._RF.push(t,"39f59rIe6tIgKofJxjOCUq6","guessingdojo_rank");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},s=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function s(e){try{a(n.next(e))}catch(t){r(t)}}function c(e){try{a(n.throw(e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,c)}a((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return a([e,t])}}function a(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(c){r=[6,c],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../game/beastMgr"),l=e("../../proto/mystibeast_pb"),u=e("../../core/components/LayerBase"),p=cc._decorator,h=p.ccclass,d=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.jackpotInfo=null,t.scrollView=null,t.content=null,t.item=null,t.user_rank=null,t.user_name=null,t.user_passed=null,t.user_fame=null,t.user_icon=null,t.cb=null,t.curUser=null,t.lastUser=null,t.curWeekRankList=[],t.lastWeekRankList=[],t}return i(t,e),t.prototype.start=function(){this._getRankInfo()},t.prototype.setCall=function(t){this.cb=t,e.prototype.setBackCall.call(this,this.cb)},t.prototype._getRankInfo=function(){var e=this,t=new l.GuessingDojoHostWeekRankReq;a.default.inst.GuessingDojoClient.guessingDojoHostWeekRank(t,a.default.inst.metadata).then(function(t){if(0==t.getCode()){var o=t.getGuessingdojohostweekrankresp().toObject();cc.log("rankInfo",o),e.jackpotInfo.string=MyFun.getRealNum(o.jackpotInfo.gemsNum).toFixed(2),e.curUser=o.currentWeekUser,e.lastUser=o.lastWeekUser,e.curWeekRankList=o.currentWeekListList,e.lastWeekRankList=o.lastWeekListList,e._loadUserInfo(e.curUser),e._loadWeekList(e.curWeekRankList)}else a.default.inst.handleCode(t.getCode())}).catch(function(e){cc.log(e)})},t.prototype.onToggleContainerHandler=function(e){var t=e.node.name;"curWeek"==t?(this._loadUserInfo(this.curUser),this._loadWeekList(this.curWeekRankList)):"lastWeek"==t&&(this._loadUserInfo(this.lastUser),this._loadWeekList(this.lastWeekRankList))},t.prototype._loadUserInfo=function(e){return s(this,void 0,void 0,function(){var t;return c(this,function(o){switch(o.label){case 0:return null==e?[2]:(this.user_rank.string=e.weekRank+"",this.user_passed.string=e.passedNum+"",this.user_fame.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(e.fameNum),0),""==e.userAvatar?[2]:(t=this.user_icon,[4,MyFun.loadPicFromRemote(e.userAvatar)]));case 1:return t.spriteFrame=o.sent(),[2]}})})},t.prototype._loadWeekList=function(e){return s(this,void 0,void 0,function(){return c(this,function(){return this.content.removeAllChildren(),this.loadByFrames(e),[2]})})},t.prototype.loadByFrames=function(e){var t=this,o=e.length,n=0,i=function(){for(var r=Math.min(o-n,30),s=0;s<r;s++)t.addItem(n,e),n++;n<o?t.scheduleOnce(function(){return i()}):t.scheduleOnce(function(){t.improveDC()})};i()},t.prototype.addItem=function(e,t){return s(this,void 0,void 0,function(){var o,n,i;return c(this,function(r){switch(r.label){case 0:return o=t[e],(n=cc.instantiate(this.item)).active=!0,n.parent=this.content,n.getChildByName("rank").getComponent(cc.Label).string=o.weekRank+"",n.getChildByName("name").getComponent(cc.Label).string=MyFun.maskName(o.userNickname),n.getChildByName("passed").getComponent(cc.Label).string=o.passedNum+"",n.getChildByName("fame").getComponent(cc.Label).string=MyFun.formatDecimalPlaces(MyFun.getRealNum(o.fameNum),0),""==o.userAvatar?[2]:(i=n.getChildByName("icon").getComponent(cc.Sprite),[4,MyFun.loadPicFromRemote(o.userAvatar)]);case 1:return i.spriteFrame=r.sent(),[2]}})})},t.prototype.btnCloseClicked=function(){e.prototype.onClose.call(this)},t.prototype.improveDC=function(){if(0!=this.content.childrenCount){var e=this.scrollView.parent.convertToWorldSpaceAR(cc.v2(this.scrollView.x-this.scrollView.anchorX*this.scrollView.width,this.scrollView.y-this.scrollView.anchorY*this.scrollView.height)),t=cc.rect(e.x,e.y,this.scrollView.width,this.scrollView.height);this.content.children.forEach(function(e){e.children.forEach(function(e){e.getBoundingBoxToWorld().intersects(t)?0===e.opacity&&(e.opacity=255):0!==e.opacity&&(e.opacity=0)})})}},r([d(cc.Label)],t.prototype,"jackpotInfo",void 0),r([d(cc.Node)],t.prototype,"scrollView",void 0),r([d(cc.Node)],t.prototype,"content",void 0),r([d(cc.Node)],t.prototype,"item",void 0),r([d(cc.Label)],t.prototype,"user_rank",void 0),r([d(cc.Label)],t.prototype,"user_name",void 0),r([d(cc.Label)],t.prototype,"user_passed",void 0),r([d(cc.Label)],t.prototype,"user_fame",void 0),r([d(cc.Sprite)],t.prototype,"user_icon",void 0),r([h],t)}(u.default);o.default=f,cc._RF.pop()},{"../../core/components/LayerBase":void 0,"../../game/beastMgr":void 0,"../../proto/mystibeast_pb":void 0}],guessingdojo_record:[function(e,t,o){"use strict";cc._RF.push(t,"b00b7cSfEVM84XWTu5JtJs5","guessingdojo_record");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../core/components/LayerBase"),c=e("../../game/beastMgr"),a=e("../../proto/mystibeast_pb"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hostName1=null,t.scrollView=null,t.content=null,t.item=null,t.gestureSF=[],t.flagList=[],t.cb=null,t.curHostId=0,t}return i(t,e),t.prototype.loadRecord=function(t,o){var n=this;o&&(this.cb=o,e.prototype.setBackCall.call(this,this.cb)),this.curHostId=t,this._loadCurHostInfo(t);var i=new a.GuessingDojoHostRecordReq;i.setHostId(t),c.default.inst.GuessingDojoClient.guessingDojoHostRecord(i,c.default.inst.metadata).then(function(e){if(0==e.getCode()){var t=e.getGuessingdojohostrecordresp().toObject();cc.log("recordInfo",t),n._showRecordInfo(t.recordListList)}else c.default.inst.handleCode(e.getCode())}).catch(function(e){cc.log(e)})},t.prototype._loadCurHostInfo=function(e){var t=MyFun.findItemFromArr(c.default.inst.dojoHostConfigList,"id",e);this.hostName1.getComponent(app.i18nLabel).init(t.name,[])},t.prototype._showRecordInfo=function(e){this.scrollView.stopAutoScroll(),this.scrollView.scrollToTop(),this.content.removeAllChildren(),this.loadByFrames(e)},t.prototype.loadByFrames=function(e){var t=this,o=e.length,n=0,i=function(){for(var r=Math.min(o-n,30),s=0;s<r;s++)t.addItem(n,e),n++;n<o?t.scheduleOnce(function(){return i()}):t.scheduleOnce(function(){t.improveDC()})};i()},t.prototype.addItem=function(e,t){var o=t[e],n=cc.instantiate(this.item);n.active=!0,n.parent=this.content,n.getChildByName("end").getComponent(cc.Sprite).spriteFrame=this.flagList[o.guessingResult-1],n.getChildByName("me").getComponent(cc.Sprite).spriteFrame=this.gestureSF[o.userGesture-1],n.getChildByName("host").getComponent(cc.Sprite).spriteFrame=this.gestureSF[o.hostGesture-1],1==o.guessingResult&&(n.getChildByName("info").active=!0)},t.prototype.improveDC=function(){if(0!=this.content.childrenCount){var e=this.scrollView.node.parent.convertToWorldSpaceAR(cc.v2(this.scrollView.node.x-this.scrollView.node.anchorX*this.scrollView.node.width,this.scrollView.node.y-this.scrollView.node.anchorY*this.scrollView.node.height)),t=cc.rect(e.x,e.y,this.scrollView.node.width,this.scrollView.node.height);this.content.children.forEach(function(e){e.children.forEach(function(e){e.getBoundingBoxToWorld().intersects(t)?0===e.opacity&&(e.opacity=255):0!==e.opacity&&(e.opacity=0)})})}},t.prototype.onRightClicked=function(){this.curHostId++,this.curHostId>7&&(this.curHostId=1),this.loadRecord(this.curHostId)},t.prototype.onLeftClicked=function(){this.curHostId--,this.curHostId<=0&&(this.curHostId=7),this.loadRecord(this.curHostId)},t.prototype.btnCloseClicked=function(){e.prototype.onClose.call(this)},r([p(cc.Label)],t.prototype,"hostName1",void 0),r([p(cc.ScrollView)],t.prototype,"scrollView",void 0),r([p(cc.Node)],t.prototype,"content",void 0),r([p(cc.Node)],t.prototype,"item",void 0),r([p(cc.SpriteFrame)],t.prototype,"gestureSF",void 0),r([p(cc.SpriteFrame)],t.prototype,"flagList",void 0),r([u],t)}(s.default);o.default=h,cc._RF.pop()},{"../../core/components/LayerBase":void 0,"../../game/beastMgr":void 0,"../../proto/mystibeast_pb":void 0}],guessingdojo_result:[function(e,t,o){"use strict";cc._RF.push(t,"6b284hixBFHhKSN+JA9Z9b5","guessingdojo_result");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../game/beast_config"),c=e("../../game/beastMgr"),a=e("../../proto/mystibeast_pb"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sucN=null,t.sucGainGems=null,t.continueGems=null,t.sucFame=null,t.failN=null,t.failGainGems=null,t.revengeGems=null,t.failFame=null,t.curBossGems=null,t.curLevelWinGems=null,t.curLevelWinFame=null,t.revengeTip=null,t.settleN=null,t.settleGain=null,t.settleFame1=null,t.settleFame2=null,t.settleTip=null,t.cb=null,t.curHost=1,t.curWine=1,t}return i(t,e),t.prototype.start=function(){app.AudioMgr.pauseMusic(),app.AudioMgr.play(s.Bundles.Common,"Settlement")},t.prototype.showResult=function(e,t,o,n,i){this.cb=t,this.curWine=o,"guessingResult"in e?(this.curHost=e.hostId,e.isPassed?this.showSettle(e.gainGems,e.gainFames,n):2==e.challengeResult?this.showSuc(e.gainGems,e.continueGems,e.hostId,e.gainFames):3==e.guessingResult&&this.showFail(e.gainGems,e.revengeGems,e.gainFames)):(this.curHost=e.currentHost,3==e.challengeStatus&&this.showFail(e.gainGems,i,e.fameNum))},t.prototype.showSuc=function(e,t,o,n){this.sucN.active=!0,this.sucGainGems.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(e)),this.continueGems.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(t)),this.sucFame.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(n),0)},t.prototype.btnKeepChallengeClicked=function(){c.default.inst.revengeHost=0,this.cb&&this.cb(),app.AudioMgr.resumeMusic(),this.node.destroy()},t.prototype.showFail=function(e,t,o){this.failN.active=!0,this.failGainGems.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(e)),this.revengeGems.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(t)),this.failFame.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(o),0);var n=MyFun.findItemFromArr(c.default.inst.dojoWineConfigList,"wineType",this.curWine),i=MyFun.findItemFromArr(c.default.inst.dojoHostConfigList,"id",this.curHost);this.curBossGems.string=MyFun.formatDecimalPlaces(n.cost*i.basicRate/1e4),this.curLevelWinGems.string=MyFun.formatDecimalPlaces(n.cost*this.getTotalRate()),this.curLevelWinFame.string=MyFun.formatDecimalPlaces(n.cost*this.getTotalFame(),0),6==this.curHost&&(this.curLevelWinFame.string=MyFun.formatDecimalPlaces(n.cost*this.getTotalFame()*2,0)),this.curHost==c.default.inst.revengeHost&&(this.curBossGems.string=MyFun.formatDecimalPlaces(n.cost*i.revengeRate/1e4),this.revengeTip.active=!1)},t.prototype.getTotalRate=function(){for(var e=0,t=0;t<this.curHost;t++)e+=c.default.inst.dojoHostConfigList[t].basicRate;return cc.log(this.curWine,e),e/1e4},t.prototype.getTotalFame=function(){for(var e=0,t=0;t<this.curHost;t++)e+=c.default.inst.dojoHostConfigList[t].fameBasic;return cc.log(this.curWine,e),e},t.prototype.btnAbandonClicked=function(){var e=this,t=new a.GuessingDojoHostFailAbandonReq;c.default.inst.GuessingDojoClient.guessingDojoHostFailAbandon(t,c.default.inst.metadata).then(function(t){if(0==t.getCode()){var o=t.getGuessingdojohostfailabandonresp().toObject();cc.log("\u653e\u5f03",o),c.default.inst.myGems=MyFun.getRealNum(o.myGemsNum),e.cb&&e.cb(),app.AudioMgr.resumeMusic(),e.node.destroy()}else c.default.inst.handleCode(t.getCode())}).catch(function(e){cc.log(e)})},t.prototype.btnRevengeClicked=function(){var e=this,t=new a.GuessingDojoHostRevengeReq;c.default.inst.GuessingDojoClient.guessingDojoHostRevenge(t,c.default.inst.metadata).then(function(t){if(0==t.getCode()){var o=t.getGuessingdojohostrevengeresp().toObject();cc.log("\u590d\u4ec7",o),c.default.inst.myGems=MyFun.getRealNum(o.myGemsNum),c.default.inst.revengeHost=e.curHost,e.cb&&e.cb(),app.AudioMgr.resumeMusic(),e.node.destroy()}else c.default.inst.handleCode(t.getCode())}).catch(function(e){cc.log(e)})},t.prototype.showSettle=function(e,t,o){if(this.settleN.active=!0,this.settleGain.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(e)),this.settleFame1.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(t)/2,0),this.settleFame2.string=MyFun.formatDecimalPlaces(MyFun.getRealNum(t)/2,0),this.curWine==o&&this.curWine<7){this.settleTip.active=!0;var n=MyFun.findItemFromArr(c.default.inst.dojoWineConfigList,"wineType",this.curWine+1),i=app.i18nMgr._getLabel(n.name,[]);this.settleTip.getComponent(app.i18nLabel).init("static_result13",[i])}},t.prototype.btnBackToMain=function(){this.cb&&this.cb(),this.node.destroy()},r([p(cc.Node)],t.prototype,"sucN",void 0),r([p(cc.Label)],t.prototype,"sucGainGems",void 0),r([p(cc.Label)],t.prototype,"continueGems",void 0),r([p(cc.Label)],t.prototype,"sucFame",void 0),r([p(cc.Node)],t.prototype,"failN",void 0),r([p(cc.Label)],t.prototype,"failGainGems",void 0),r([p(cc.Label)],t.prototype,"revengeGems",void 0),r([p(cc.Label)],t.prototype,"failFame",void 0),r([p(cc.Label)],t.prototype,"curBossGems",void 0),r([p(cc.Label)],t.prototype,"curLevelWinGems",void 0),r([p(cc.Label)],t.prototype,"curLevelWinFame",void 0),r([p(cc.Node)],t.prototype,"revengeTip",void 0),r([p(cc.Node)],t.prototype,"settleN",void 0),r([p(cc.Label)],t.prototype,"settleGain",void 0),r([p(cc.Label)],t.prototype,"settleFame1",void 0),r([p(cc.Label)],t.prototype,"settleFame2",void 0),r([p(cc.Node)],t.prototype,"settleTip",void 0),r([u],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../../game/beastMgr":void 0,"../../game/beast_config":void 0,"../../proto/mystibeast_pb":void 0}],pauseGame:[function(e,t,o){"use strict";cc._RF.push(t,"920c4z54BFFAYzpEaikKx1+","pauseGame");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../core/components/PopupBase"),c=cc._decorator,a=c.ccclass,l=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cb=null,t}return i(t,e),t.prototype.setCall=function(e){this.cb=e},t.prototype.btnCloseClick=function(){this.hide()},t.prototype.onAfterHide=function(){this.node.destroy()},t.prototype.btnAbandonClick=function(){this.cb&&this.cb(),this.hide()},r([a],t)}(s.default));o.default=l,cc._RF.pop()},{"../../core/components/PopupBase":void 0}],power:[function(e,t,o){"use strict";cc._RF.push(t,"1a1acZSUzNKLryBxS32mDNJ","power");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../core/components/PopupBase"),c=e("../../game/beastMgr"),a=cc._decorator,l=a.ccclass,u=a.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.curPower=null,t.recover=null,t.limit=null,t.jumpCall=null,t}return i(t,e),t.prototype.syncCountDown=function(){if(-5==c.default.inst.recoverPowerTime)return this.recover.active=!1,this.limit.getComponent(cc.Label).string=app.i18nMgr._getLabel("static_power7",[]),void(this.curPower.string=c.default.inst.curPower.toString());var e=c.default.inst.recoverPowerTime+1,t=MyFun.formatTimeToHMS(e);this.recover.getComponent(cc.Label).string=t+app.i18nMgr._getLabel("static_power4",[]),30-c.default.inst.curPower>1&&(e+=1800*(30-c.default.inst.curPower-1));var o=MyFun.formatTimeToHMS(e);this.limit.getComponent(cc.Label).string=o+app.i18nMgr._getLabel("static_power5",[]),this.curPower.string=c.default.inst.curPower.toString()},t.prototype.setData=function(e){this.jumpCall=e},t.prototype.btnCloseClicked=function(){this.hide()},t.prototype.onAfterHide=function(){this.node.destroy()},t.prototype.btnMonsterClicked=function(){c.default.inst.showWarning("static_tip4")},t.prototype.update=function(){this.syncCountDown()},r([u(cc.Label)],t.prototype,"curPower",void 0),r([u(cc.Node)],t.prototype,"recover",void 0),r([u(cc.Node)],t.prototype,"limit",void 0),r([l],t)}(s.default);o.default=p,cc._RF.pop()},{"../../core/components/PopupBase":void 0,"../../game/beastMgr":void 0}]},{},["beastChallenge","beastChallengeLog","beastChallengeResult","bossInfo","bossRecord","bossSure","flowRecord","flow_item","flow_itemDetail","guessingDojo","guessingdojo_punchAni","guessingdojo_rank","guessingdojo_record","guessingdojo_result","pauseGame","power"]);