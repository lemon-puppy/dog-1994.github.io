window.__require=function t(e,n,o){function i(a,c){if(!n[a]){if(!e[a]){var s=a.split("/");if(s=s[s.length-1],!e[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+a+"'")}a=s}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){return i(e[a][1][t]||t)},u,u.exports,t,e,n,o)}return n[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<o.length;a++)i(o[a]);return i}({eggIncubator:[function(t,e,n){"use strict";cc._RF.push(e,"c6e52DDI5lDrbffS5WAEQOd","eggIncubator");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function c(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../core/components/gameBase"),l=t("../../game/beast_config"),u=t("../../game/beastMgr"),p=t("../../proto/mystibeast_pb"),h=t("./egg_record"),f=t("./egg_result"),d=t("./item_slot"),g=t("./warehouse"),y=cc._decorator,m=y.ccclass,b=y.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gemsLab=null,e.sandLab=null,e.ratioLab=null,e.isJumpAnim=null,e.windowLayout1=null,e.windowLayout2=null,e.windowLayout3=null,e.end=null,e.item=null,e.content=null,e.mainContent=null,e.rule=null,e.scrollView=null,e.gemsNode=null,e.itemArrayLen=9,e.gems=0,e.sand=0,e.eggList_1=[],e.eggList_2=[],e.eggList_3=[],e.curEggType=0,e.num1=40,e.num2=60,e.num3=80,e.startPosY=-210,e.resultArr=[0,0,0],e.curResult=[10,10,10],e.curBeastInfo=null,e.isRolling=!1,e.isFirstRoll=!0,e}return i(e,t),e.prototype.onLoad=function(){var t=this;this.scheduleOnce(function(){t.content.height=cc.winSize.height+t.rule.height},1)},e.prototype.onEnable=function(){app.AudioMgr.playMusic(l.Bundles.Game_BeastEggIncubator,"GachaMachineBgm")},e.prototype.start=function(){t.prototype.start.call(this),this.loadEggInfo(),this.windowLayout1.active=!1,this.windowLayout2.active=!1,this.windowLayout3.active=!1,this._setWindowLayoutContent()},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),cc.Tween.stopAll(),this.unscheduleAllCallbacks()},e.prototype.loadEggInfo=function(){var t=this,e=new p.EggIncubatorInfoReq;u.default.inst.EggIncubatorClient.eggIncubatorInfo(e,u.default.inst.metadata).then(function(e){if(0==e.getCode()){var n=e.getEggincubatorinforesp().toObject();cc.log(n),t.gems=MyFun.getRealNum(n.myGemsNum),t.refreshPlayerInfo(),t.handleEggListByType(n.eggListList)}else u.default.inst.handleCode(e.getCode())}).catch(function(t){cc.log(t),u.default.inst.handleCode(t.code)})},e.prototype.handleEggListByType=function(t){for(var e=0;e<t.length;e++){var n=t[e];1==n.eggType?this.eggList_1.push(n):2==n.eggType?this.eggList_2.push(n):3==n.eggType&&this.eggList_3.push(n)}},e.prototype.eggTypeSelectHandler=function(t){this.curEggType=t.index,cc.log(this.curEggType),0==this.curEggType?this.gemsNode.active=!1:1==this.curEggType?this.gemsNode.active=!0:2==this.curEggType&&(this.gemsNode.active=!1)},e.prototype.refreshPlayerInfo=function(){this.gemsLab.string=MyFun.formatDecimalPlaces(this.gems),this.sandLab.string=MyFun.formatDecimalPlaces(this.sand,0)},e.prototype._setWindowLayoutContent=function(){cc.log(this.curResult),this._initWindowContent(this.windowLayout1,this.num1,this.curResult[0],this.resultArr[0]),this.windowLayout1.active=!0,this._initWindowContent(this.windowLayout2,this.num2,this.curResult[1],this.resultArr[1]),this.windowLayout2.active=!0,this._initWindowContent(this.windowLayout3,this.num3,this.curResult[2],this.resultArr[2]),this.windowLayout3.active=!0,this.resultArr=this.curResult.slice()},e.prototype._initWindowContent=function(t,e,n,o){var i,r=this;if(this.isFirstRoll||((i=cc.instantiate(t)).parent=t.parent),this.clearLayoutChildren(t),t.setPosition(0,this.startPosY,0),this.isFirstRoll){var a=this.getAdjacentIndices(n,this.itemArrayLen),c=a[0],s=a[1];this.populateItems(0,e-3,t,this.itemArrayLen),this._spawnItem(c,t),this._spawnItem(n,t),this._spawnItem(s,t)}else{var l=this.getAdjacentIndices(o,this.itemArrayLen),u=l[0],p=l[1];this._spawnItem(u,t),this._spawnItem(o,t),this._spawnItem(p,t),this.populateItems(p,e-6,t,this.itemArrayLen);var h=this.getAdjacentIndices(n,this.itemArrayLen);c=h[0],s=h[1],this._spawnItem(c,t),this._spawnItem(n,t),this._spawnItem(s,t),this.scheduleOnce(function(){r.clearLayoutChildren(i),i.destroy()})}},e.prototype.getAdjacentIndices=function(t,e){return[t>0?t-1:e-1,t<e-1?t+1:0]},e.prototype._spawnItem=function(t,e){app.nodePoolMgr.getNode(this.item,e).getComponent(d.default).setSprite(t,e.name)},e.prototype.clearLayoutChildren=function(t){for(;t.childrenCount>0;)app.nodePoolMgr.putNode(t.children[t.childrenCount-1])},e.prototype.populateItems=function(t,e,n,o){for(var i=t,r=0;r<e;r++)i>=o&&(i=0),this._spawnItem(i,n),i++},e.prototype._openEggReq=function(t,e){var n=this,o=new p.EggIncubatorHatchReq;o.setEggId(t),u.default.inst.EggIncubatorClient.eggIncubatorHatch(o,u.default.inst.metadata).then(function(t){if(0==t.getCode()){var o=t.getEggincubatorhatchresp().toObject();cc.log(o),n.curBeastInfo={cateId:o.cateId,quality:o.quality};var i=u.default.inst.BeastConfigList.findIndex(function(t){return t.cateId==o.cateId});n.curResult=[i,i,i],cc.log(i,n.curResult),e&&e()}else u.default.inst.handleCode(t.getCode())}).catch(function(t){cc.log(t),u.default.inst.handleCode(t.code)})},e.prototype.checkEgg=function(){var t=this;if(0==this.curEggType){if(this.eggList_1.length>0){var e=this.eggList_1[0].eggId;return this._openEggReq(e,function(){t.eggList_1.splice(0,1),t.isJumpAnim.isChecked?t._rollingEndCall():(t._setWindowLayoutContent(),t._startRolling())}),!1}return u.default.inst.showConfirm("egg_tip1",function(){u.default.inst.sendMsgToUniApp("product_magical")}),!1}return 1==this.curEggType?(u.default.inst.showWarning("egg_tip3"),!1):2!=this.curEggType||(u.default.inst.showWarning("egg_tip3"),!1)},e.prototype.btnSpinClicked=function(){if(!this.isRolling&&this.checkEgg()){var t=MyFun.getRandomInteger(0,u.default.inst.BeastConfigList.length-1);this.curResult=[t,t,t],this.curBeastInfo={cateId:u.default.inst.BeastConfigList[t].cateId,quality:u.default.inst.BeastConfigList[t].quality},this.isJumpAnim.isChecked?this._rollingEndCall():(this._setWindowLayoutContent(),this._startRolling())}},e.prototype._startRolling=function(){return a(this,void 0,void 0,function(){var t=this;return c(this,function(){return app.AudioMgr.pauseMusic(),app.AudioMgr.play(l.Bundles.Game_BeastEggIncubator,"GachaMachineDraw"),this.end.active=!1,this.isRolling=!0,this.isFirstRoll&&(this.isFirstRoll=!1),cc.log("rolling..........."),this._rollingAni(this.windowLayout1,this.num1),this._rollingAni(this.windowLayout2,this.num2),this._rollingAni(this.windowLayout3,this.num3,function(){return a(t,void 0,void 0,function(){return c(this,function(){return this._rollingEndCall(),[2]})})}),[2]})})},e.prototype._rollingEndCall=function(){return a(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return this.isRolling=!1,app.AudioMgr.resumeMusic(),this.isJumpAnim.isChecked?[3,2]:(this.end.active=!0,[4,this.wait(.5)]);case 1:t.sent(),t.label=2;case 2:return this.showResult(this.curBeastInfo),[2]}})})},e.prototype.wait=function(t){var e=this;return new Promise(function(n){e.scheduleOnce(function(){n()},t)})},e.prototype._stopRolling=function(t,e,n){var o=t.children[0].height,i=this.startPosY;cc.tween(t).parallel(cc.tween().to(.5,{position:cc.v3(0,i+-o*(e-3),0)},{easing:"sineOut"}).call(function(){n&&n()}),cc.tween().delay(.3).call(function(){cc.director.emit(t.name+"isEnd")})).start()},e.prototype._rollingAni=function(t,e,n){var o=t.children[0].height;t.y=this.startPosY;var i=e/20;cc.log(i),cc.tween(t).parallel(cc.tween().to(i,{position:cc.v3(0,this.startPosY+-o*(e-3),0)},{easing:"sineInOut"}).call(function(){n&&n()}),cc.tween().delay(.2*i).call(function(){})).start()},e.prototype.btnCloseClicked=function(){u.default.inst.backToApp()},e.prototype.btnPackageClicked=function(){return a(this,void 0,void 0,function(){var t,e,n=this;return c(this,function(o){switch(o.label){case 0:return[4,MyFun.loadPrefab(l.getPrefabInfo(l.Bundles.Game_BeastEggIncubator,l.BeastEgg_Pop.Warehouse))];case 1:return t=o.sent(),(e=cc.instantiate(t)).parent=this.node,this.scrollView.node.opacity=0,e.getComponent(g.default).setBackCall(function(){u.default.inst.curLayer=u.Layer.MAIN,n.scrollView.node.opacity=255}),[2]}})})},e.prototype.btnRecordClicked=function(){return a(this,void 0,void 0,function(){var t,e,n=this;return c(this,function(o){switch(o.label){case 0:return[4,MyFun.loadPrefab(l.getPrefabInfo(l.Bundles.Game_BeastEggIncubator,l.BeastEgg_Pop.Record))];case 1:return t=o.sent(),(e=cc.instantiate(t)).parent=this.node,this.scrollView.node.opacity=0,e.getComponent(h.default).setBackCall(function(){u.default.inst.curLayer=u.Layer.MAIN,n.scrollView.node.opacity=255}),[2]}})})},e.prototype.showResult=function(t){return a(this,void 0,void 0,function(){var e,n;return c(this,function(o){switch(o.label){case 0:return[4,MyFun.loadPrefab(l.getPrefabInfo(l.Bundles.Game_BeastEggIncubator,l.BeastEgg_Pop.Result))];case 1:return e=o.sent(),(n=cc.instantiate(e)).parent=this.node,n.getComponent(f.default).setData(t),[2]}})})},e.prototype.btnGemsClicked=function(){u.default.inst.sendMsgToUniApp("gems")},e.prototype.btnGemsFactoryClicked=function(){u.default.inst.sendMsgToUniApp("charge")},e.prototype.scrollToRuleInfo=function(){this.scrollView.scrollToOffset(cc.v2(0,cc.winSize.height),.5)},e.prototype.btnJumpToHuntClicked=function(){this.unscheduleAllCallbacks(),cc.Tween.stopAll(),u.default.inst.jumpToGame(u.gameType.beastHunt)},e.prototype.btnLockClicked=function(){u.default.inst.showWarning("egg_tip3")},r([b(cc.Label)],e.prototype,"gemsLab",void 0),r([b(cc.Label)],e.prototype,"sandLab",void 0),r([b(cc.Label)],e.prototype,"ratioLab",void 0),r([b(cc.Toggle)],e.prototype,"isJumpAnim",void 0),r([b(cc.Node)],e.prototype,"windowLayout1",void 0),r([b(cc.Node)],e.prototype,"windowLayout2",void 0),r([b(cc.Node)],e.prototype,"windowLayout3",void 0),r([b(cc.Node)],e.prototype,"end",void 0),r([b(cc.Prefab)],e.prototype,"item",void 0),r([b(cc.Node)],e.prototype,"content",void 0),r([b(cc.Node)],e.prototype,"mainContent",void 0),r([b(cc.Node)],e.prototype,"rule",void 0),r([b(cc.ScrollView)],e.prototype,"scrollView",void 0),r([b(cc.Node)],e.prototype,"gemsNode",void 0),r([m],e)}(s.default);n.default=_,cc._RF.pop()},{"../../core/components/gameBase":void 0,"../../game/beastMgr":void 0,"../../game/beast_config":void 0,"../../proto/mystibeast_pb":void 0,"./egg_record":"egg_record","./egg_result":"egg_result","./item_slot":"item_slot","./warehouse":"warehouse"}],egg_record:[function(t,e,n){"use strict";cc._RF.push(e,"eb0e1FbepRI5IAzwcSuT0Mv","egg_record");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function c(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../core/components/LayerBase"),l=t("../../game/beast_config"),u=t("../../game/beastMgr"),p=t("../../proto/mystibeast_pb"),h=cc._decorator,f=h.ccclass,d=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollView=null,e.content=null,e.item=null,e.qualityBgSF=[],e.qualityFlag=[],e.eggType=["egg_static10","egg_static11","egg_static12"],e}return i(e,t),e.prototype.start=function(){this._loadRecord()},e.prototype._loadRecord=function(){var t=this,e=new p.EggIncubatorHatchRecordReq;u.default.inst.EggIncubatorClient.eggIncubatorHatchRecord(e,u.default.inst.metadata).then(function(e){if(0==e.getCode()){var n=e.getEggincubatorhatchrecordresp().toObject();cc.log(n);var o=MyFun.sortByObjectValue(n.recordListList,"createTime",1);t.loadByFrames(o)}else u.default.inst.handleCode(e.getCode())}).catch(function(t){cc.log(t)})},e.prototype.loadByFrames=function(t){var e=this,n=t.length,o=0,i=function(){for(var r=Math.min(n-o,30),a=0;a<r;a++)e.addItem(o,t),o++;o<n?e.scheduleOnce(function(){return i()}):e.scheduleOnce(function(){e.improveDC()})};i()},e.prototype.addItem=function(t,e){return a(this,void 0,void 0,function(){var n,o,i,r;return c(this,function(a){switch(a.label){case 0:return t>=e.length?[2]:((n=cc.instantiate(this.item)).active=!0,n.parent=this.content,o=e[t],i=MyFun.findItemFromArr(u.default.inst.BeastConfigList,"cateId",o.cateId),n.getChildByName("date").getComponent(cc.Label).string=MyFun.formattedDateTime(1e3*o.createTime),n.getChildByName("type").getComponent(app.i18nLabel).init(this.eggType[o.eggType-1],[]),1==o.eggType?(n.getChildByName("cost2").active=!0,n.getChildByName("iconBg").x=270):2==o.eggType&&(n.getChildByName("cost1").active=!0,n.getChildByName("cost1").getChildByName("gems").getComponent(cc.Label).string=MyFun.formatDecimalPlaces(MyFun.getRealNum(o.costGems)),n.getChildByName("getSand").active=!0),n.getChildByName("iconBg").getComponent(cc.Sprite).spriteFrame=this.qualityBgSF[i.quality-1],r=n.getChildByName("iconBg").getChildByName("icon").getComponent(cc.Sprite),[4,MyFun.loadPicFromBundle(l.Bundles.Game_BeastEggIncubator,"beastIcon",i.icon)]);case 1:return r.spriteFrame=a.sent(),n.getChildByName("iconBg").getChildByName("flag").getComponent(cc.Sprite).spriteFrame=this.qualityFlag[i.quality-1],[2]}})})},e.prototype.btnCloseClicked=function(){t.prototype.onClose.call(this)},e.prototype.improveDC=function(){if(0!=this.content.childrenCount){var t=this.scrollView.parent.convertToWorldSpaceAR(cc.v2(this.scrollView.x-this.scrollView.anchorX*this.scrollView.width,this.scrollView.y-this.scrollView.anchorY*this.scrollView.height)),e=cc.rect(t.x,t.y,this.scrollView.width,this.scrollView.height);this.content.children.forEach(function(t){t.children.forEach(function(t){t.getBoundingBoxToWorld().intersects(e)?0===t.opacity&&(t.opacity=255):0!==t.opacity&&(t.opacity=0)})})}},r([d(cc.Node)],e.prototype,"scrollView",void 0),r([d(cc.Node)],e.prototype,"content",void 0),r([d(cc.Node)],e.prototype,"item",void 0),r([d(cc.SpriteFrame)],e.prototype,"qualityBgSF",void 0),r([d(cc.SpriteFrame)],e.prototype,"qualityFlag",void 0),r([f],e)}(s.default);n.default=g,cc._RF.pop()},{"../../core/components/LayerBase":void 0,"../../game/beastMgr":void 0,"../../game/beast_config":void 0,"../../proto/mystibeast_pb":void 0}],egg_result:[function(t,e,n){"use strict";cc._RF.push(e,"56adaXFUZZJm7BMC+rG16a6","egg_result");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function c(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../game/beast_config"),l=t("../../game/beastMgr"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.beastName=null,e.beast=null,e.quality=null,e.beastBg=null,e.qualityBgSF=[],e.qualityList=[],e}return i(e,t),e.prototype.start=function(){app.AudioMgr.play(s.Bundles.Game_BeastEggIncubator,"GachaMachineRewards")},e.prototype.setData=function(t){return a(this,void 0,void 0,function(){var e,n;return c(this,function(o){switch(o.label){case 0:return e=MyFun.findItemFromArr(l.default.inst.BeastConfigList,"cateId",t.cateId),n=this.beast,[4,MyFun.loadPicFromBundle(s.Bundles.Game_BeastEggIncubator,"beastIcon",e.icon)];case 1:return n.spriteFrame=o.sent(),this.beastBg.spriteFrame=this.qualityBgSF[t.quality-1],this.beastName.getComponent(app.i18nLabel).init(e.name,[]),this.quality.spriteFrame=this.qualityList[t.quality-1],[2]}})})},e.prototype.btnSureClicked=function(){this.node.destroy()},r([h(cc.Node)],e.prototype,"beastName",void 0),r([h(cc.Sprite)],e.prototype,"beast",void 0),r([h(cc.Sprite)],e.prototype,"quality",void 0),r([h(cc.Sprite)],e.prototype,"beastBg",void 0),r([h(cc.SpriteFrame)],e.prototype,"qualityBgSF",void 0),r([h(cc.SpriteFrame)],e.prototype,"qualityList",void 0),r([p],e)}(cc.Component);n.default=f,cc._RF.pop()},{"../../game/beastMgr":void 0,"../../game/beast_config":void 0}],item_slot:[function(t,e,n){"use strict";cc._RF.push(e,"b9078htm2ZDV414dVB15uF1","item_slot");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function c(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../game/beast_config"),l=t("../../game/beastMgr"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.beastBg=null,e.itemSpr=null,e.qualityBgSF=[],e.curParentName="",e}return i(e,t),e.prototype.start=function(){},e.prototype.setSprite=function(t,e){return a(this,void 0,void 0,function(){var n,o;return c(this,function(i){switch(i.label){case 0:return null==(n=l.default.inst.BeastConfigList[t])&&cc.log(t),this.beastBg.spriteFrame=this.qualityBgSF[n.quality-1],o=this.itemSpr,[4,MyFun.loadPicFromBundle(s.Bundles.Game_BeastEggIncubator,"beastIcon",n.icon)];case 1:return o.spriteFrame=i.sent(),this.curParentName=e,[2]}})})},e.prototype.rollingFlag=function(t){this.itemSpr.node.active=!t},e.prototype.onDisable=function(){cc.director.off(this.curParentName+"isRolling"),cc.director.off(this.curParentName+"isEnd")},r([h(cc.Sprite)],e.prototype,"beastBg",void 0),r([h(cc.Sprite)],e.prototype,"itemSpr",void 0),r([h(cc.SpriteFrame)],e.prototype,"qualityBgSF",void 0),r([p],e)}(cc.Component);n.default=f,cc._RF.pop()},{"../../game/beastMgr":void 0,"../../game/beast_config":void 0}],warehouse:[function(t,e,n){"use strict";cc._RF.push(e,"66c596lY5JJ2aKQTqUtKju/","warehouse");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function c(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../core/components/LayerBase"),l=t("../../game/beast_config"),u=t("../../game/beastMgr"),p=t("../../proto/mystibeast_pb"),h=cc._decorator,f=h.ccclass,d=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.content=null,e.item=null,e.qualityBgSF=[],e.qualityFlag=[],e.allList=[],e.beastList=[],e.materialList=[],e.sortMagicalBeasts=function(t){return t.sort(function(t,n){var o=e.getBeastQualityById(n.cateId)-e.getBeastQualityById(t.cateId);if(0!==o)return o;var i=t.cateId-n.cateId;return 0!==i?i:n.createTime-t.createTime})},e}return i(e,t),e.prototype.start=function(){this._loadWarehouse()},e.prototype._loadWarehouse=function(){var t=this,e=new p.EggIncubatorBeastWarehouseReq;u.default.inst.EggIncubatorClient.eggIncubatorBeastWarehouse(e,u.default.inst.metadata).then(function(e){if(0==e.getCode()){var n=e.getEggincubatorbeastwarehouseresp().toObject();cc.log(n),t._handleWarehouseData(n.beastListList)}else u.default.inst.handleCode(e.getCode())}).catch(function(t){cc.log(t)})},e.prototype._handleWarehouseData=function(t){this.beastList=this.sortMagicalBeasts(t),cc.log(this.beastList),this.allList=t,this.loadByFrames(t)},e.prototype.getBeastQualityById=function(t){return MyFun.findItemFromArr(u.default.inst.BeastConfigList,"cateId",t).quality},e.prototype.onToggleContainerHandle=function(t){"toggle1"==t.node.name?this.loadByFrames(this.allList):"toggle2"==t.node.name?this.loadByFrames(this.beastList):this.loadByFrames(this.materialList)},e.prototype.loadByFrames=function(t){var e=this;this.content.removeAllChildren();var n=t.length,o=0,i=function(){for(var r=Math.min(n-o,30),a=0;a<r;a++)e.addItem(o,t),o++;if(o<n)e.scheduleOnce(function(){return i()});else if(o<40)for(a=o;a<40;a++)e.addItem(o,t),o++};i()},e.prototype.addItem=function(t,e){return a(this,void 0,void 0,function(){var n,o,i,r;return c(this,function(a){switch(a.label){case 0:return(n=cc.instantiate(this.item)).active=!0,n.parent=this.content,t>=e.length?(n.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=null,[2]):(o=e[t],i=MyFun.findItemFromArr(u.default.inst.BeastConfigList,"cateId",o.cateId),n.getChildByName("qualityBg").getComponent(cc.Sprite).spriteFrame=this.qualityBgSF[i.quality-1],n.getChildByName("flag").getComponent(cc.Sprite).spriteFrame=this.qualityFlag[i.quality-1],r=n.getChildByName("icon").getComponent(cc.Sprite),[4,MyFun.loadPicFromBundle(l.Bundles.Game_BeastEggIncubator,"beastIcon",i.icon)]);case 1:return r.spriteFrame=a.sent(),[2]}})})},e.prototype.btnCloseClicked=function(){t.prototype.onClose.call(this)},r([d(cc.Node)],e.prototype,"content",void 0),r([d(cc.Node)],e.prototype,"item",void 0),r([d(cc.SpriteFrame)],e.prototype,"qualityBgSF",void 0),r([d(cc.SpriteFrame)],e.prototype,"qualityFlag",void 0),r([f],e)}(s.default);n.default=g,cc._RF.pop()},{"../../core/components/LayerBase":void 0,"../../game/beastMgr":void 0,"../../game/beast_config":void 0,"../../proto/mystibeast_pb":void 0}]},{},["eggIncubator","egg_record","egg_result","item_slot","warehouse"]);