window.__require=function t(e,n,o){function i(a,c){if(!n[a]){if(!e[a]){var s=a.split("/");if(s=s[s.length-1],!e[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+a+"'")}a=s}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){return i(e[a][1][t]||t)},u,u.exports,t,e,n,o)}return n[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<o.length;a++)i(o[a]);return i}({ani_afterDice:[function(t,e,n){"use strict";cc._RF.push(e,"55b76nIrdZDuqYdz5I44NfR","ani_afterDice");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../scripts/G"),c=cc._decorator,s=c.ccclass,l=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.num1=null,e.num2=null,e.accLab=null,e.diceAni=null,e}return i(e,t),e.prototype.start=function(){},e.prototype.setData=function(t,e){var n=this;this.num1.string=t+"",this.num2.string=e+"",this.accLab.string=t+e+"",this.diceAni.play(),this.scheduleOnce(function(){a.G.PoolManager.putNode(n.node)},1)},r([l(cc.Label)],e.prototype,"num1",void 0),r([l(cc.Label)],e.prototype,"num2",void 0),r([l(cc.Label)],e.prototype,"accLab",void 0),r([l(cc.Animation)],e.prototype,"diceAni",void 0),r([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../../../scripts/G":void 0}],ani_build:[function(t,e,n){"use strict";cc._RF.push(e,"7b82cwrSTVOTIQ0RXeOkTSl","ani_build");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function c(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../../scripts/G"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buildSke=null,e}return i(e,t),e.prototype.start=function(){},e.prototype.onEnable=function(){return a(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return this.buildSke.setAnimation(0,"jianzaodh1",!1),[4,this.sleep(1)];case 1:return t.sent(),this.buildSke.setAnimation(0,"jianzaodh2",!0),[4,this.sleep(1.2)];case 2:return t.sent(),s.G.PoolManager.putNode(this.node),[2]}})})},e.prototype.sleep=function(t){var e=this;return new Promise(function(n){e.scheduleOnce(function(){n()},t)})},r([p(sp.Skeleton)],e.prototype,"buildSke",void 0),r([u],e)}(cc.Component);n.default=d,cc._RF.pop()},{"../../../scripts/G":void 0}],ani_casinoReward:[function(t,e,n){"use strict";cc._RF.push(e,"b2de2FlvlBL0K7YmFDB8Hke","ani_casinoReward");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../scripts/G"),c=cc._decorator,s=c.ccclass,l=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Skeleton=null,e.ske_cn=null,e.ske_en=null,e.goldIcon=null,e.diamondIcon=null,e.mainNode=null,e.rewardLab=null,e.cardList=null,e.sfList=[],e.clickCall=null,e}return i(e,t),e.prototype.onEnable=function(){"cn"==a.G.curLanguage?this.Skeleton.skeletonData=this.ske_cn:this.Skeleton.skeletonData=this.ske_en},e.prototype.setData=function(t,e){var n=this;this.Skeleton.setAnimation(0,"chuxian",!1),this.clickCall=e,this.loadRewardData(t),this.scheduleOnce(function(){n.Skeleton.setAnimation(0,"xunhuan",!0),n.showReward()},.4)},e.prototype.loadRewardData=function(t){0==a.G.player.casinoInfo.playMode?this.goldIcon.active=!0:this.diamondIcon.active=!0,this.rewardLab.string=t.num;for(var e=0;e<this.cardList.childrenCount;e++)this.cardList.children[e].getComponent(cc.Sprite).spriteFrame=this.sfList[t.suits[e]-1]},e.prototype.showReward=function(){this.mainNode.active=!0},e.prototype.btnSureClick=function(){this.clickCall&&this.clickCall(),a.G.PoolManager.putNode(this.node)},r([l(sp.Skeleton)],e.prototype,"Skeleton",void 0),r([l(sp.SkeletonData)],e.prototype,"ske_cn",void 0),r([l(sp.SkeletonData)],e.prototype,"ske_en",void 0),r([l(cc.Node)],e.prototype,"goldIcon",void 0),r([l(cc.Node)],e.prototype,"diamondIcon",void 0),r([l(cc.Node)],e.prototype,"mainNode",void 0),r([l(cc.Label)],e.prototype,"rewardLab",void 0),r([l(cc.Node)],e.prototype,"cardList",void 0),r([l(cc.SpriteFrame)],e.prototype,"sfList",void 0),r([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../../../scripts/G":void 0}],ani_complete:[function(t,e,n){"use strict";cc._RF.push(e,"9a9d6C+RrdLP4MuMpgl5IKI","ani_complete");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../scripts/G"),c=cc._decorator,s=c.ccclass,l=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Skeleton=null,e.ske_cn=null,e.ske_en=null,e}return i(e,t),e.prototype.onEnable=function(){"cn"==a.G.curLanguage?this.Skeleton.skeletonData=this.ske_cn:this.Skeleton.skeletonData=this.ske_en},r([l(sp.Skeleton)],e.prototype,"Skeleton",void 0),r([l(sp.SkeletonData)],e.prototype,"ske_cn",void 0),r([l(sp.SkeletonData)],e.prototype,"ske_en",void 0),r([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../../../scripts/G":void 0}],ani_diceReward:[function(t,e,n){"use strict";cc._RF.push(e,"6e43e90C9VOjawhZjdZqSPm","ani_diceReward");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../scripts/G"),c=cc._decorator,s=c.ccclass,l=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardSp=null,e.ske_cn=null,e.ske_en=null,e}return i(e,t),e.prototype.onEnable=function(){"cn"==a.G.curLanguage?this.rewardSp.skeletonData=this.ske_cn:this.rewardSp.skeletonData=this.ske_en},e.prototype.setSkin=function(t){this.rewardSp.setSkin("shuangbei"+t),this.playAni()},e.prototype.playAni=function(){var t=this;this.rewardSp.setCompleteListener(function(){a.G.PoolManager.putNode(t.node)}),this.rewardSp.setAnimation(0,"shuangbei",!1)},r([l(sp.Skeleton)],e.prototype,"rewardSp",void 0),r([l(sp.SkeletonData)],e.prototype,"ske_cn",void 0),r([l(sp.SkeletonData)],e.prototype,"ske_en",void 0),r([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../../../scripts/G":void 0}],ani_dice:[function(t,e,n){"use strict";cc._RF.push(e,"aa8cbhMCoRM/52cyIvUpkbT","ani_dice");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function c(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../../scripts/G"),l=t("../../../scripts/GameConfig"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dice_ske=null,e.curNum=0,e}return i(e,t),e.prototype.setData=function(t){return a(this,void 0,void 0,function(){var e,n,o=this;return c(this,function(i){switch(i.label){case 0:return e=s.G.gameJson.diceSkinList[s.G.player.diceSkinId].spineName,n=this.dice_ske,[4,Myfun.loadSpineDataFromBundle(l.resInfo[l.resNames.spines].bundle,l.resInfo[l.resNames.spines].url,e)];case 1:return n.skeletonData=i.sent(),this.dice_ske.node.active=!0,this.curNum=t,this.dice_ske.setAnimation(0,"zhuan",!1),[4,this.sleep(.5)];case 2:return i.sent(),this.dice_ske.setAnimation(0,this.curNum+"",!1),this.scheduleOnce(function(){o.dice_ske.skeletonData=null,s.G.PoolManager.putNode(o.node)},1),[2]}})})},e.prototype.sleep=function(t){var e=this;return new Promise(function(n){e.scheduleOnce(function(){n()},t)})},r([d(sp.Skeleton)],e.prototype,"dice_ske",void 0),r([p],e)}(cc.Component);n.default=f,cc._RF.pop()},{"../../../scripts/G":void 0,"../../../scripts/GameConfig":void 0}],ani_guide:[function(t,e,n){"use strict";cc._RF.push(e,"7cc70xXgYhMYoz2YxsaFBmz","ani_guide");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../manager/gameManager"),c=cc._decorator,s=c.ccclass,l=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.start=function(){var t=this;this.node.once(cc.Node.EventType.TOUCH_START,function(){t.node.destroy(),a.default.inst.btnNextMapClicked()})},r([s],e)}(cc.Component));n.default=l,cc._RF.pop()},{"../manager/gameManager":"gameManager"}],buildManager:[function(t,e,n){"use strict";cc._RF.push(e,"26a06pnnmZJbY6Um4ECoO7p","buildManager");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../scripts/G"),c=t("../item/item_build"),s=cc._decorator,l=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buildMap=null,e.buildLayerName="",e.buildBeHind=null,e.buildFont=null,e.buildPre=null,e._layerGrass=null,e._commonBuildList=[],e.showingInfoId=-1,e.showingBuildId=-1,e.showingUpdateArr=[],e}var n;return i(e,t),n=e,Object.defineProperty(e,"inst",{get:function(){return this._ins},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){null!=n._ins?this.node.destroy():n._ins=this},e.prototype.onDisable=function(){n._ins=null},e.prototype.start=function(){this._layerGrass=this.buildMap.getLayer(this.buildLayerName),this._initBuildMap()},e.prototype._initBuildMap=function(){var t=[];if(0==a.G.player.buildInfo.length){for(var e=0;e<a.G.gameJson.mapList[a.G.player.curMapId].buildList.length;e++){var n=a.G.gameJson.mapList[a.G.player.curMapId].buildList[e],o={buildId:n.buildId,level:n.level};t.push(o)}a.G.player.buildInfo=t}else t=a.G.player.buildInfo;var i=function(e){var n=t[e].buildId,o=a.G.gameJson.mapList[a.G.player.curMapId].buildList.find(function(t){return t.buildId==n});o.level=t[e].level;var i=cc.instantiate(r.buildPre),s=r.getBuildPos(o.buildPosX,o.buildPosY);i.active=!0,i.setPosition(s);var l=i.getComponent(c.default);l.setData(o,t[e].level),i.zIndex=s.y,0==o.buildDepth?i.parent=r.buildFont:i.parent=r.buildBeHind,0==o.buildType&&r._commonBuildList.unshift(l)},r=this;for(e=t.length-1;e>=0;e--)i(e);this.checkBuildOrUpgrade()},e.prototype.getBuildPos=function(t,e){return this._layerGrass.getPositionAt(cc.v2(t,e))},e.prototype.checkBuildOrUpgrade=function(){for(var t=0;t<this._commonBuildList.length;t++){var e=this._commonBuildList[t],n=e.getData();if(this.showingBuildId==n.buildId)break;if(0==n.level){e.initBuild(),this.showingBuildId=n.buildId;var o=n.levelUpCoin1;if(a.G.player.accountCoinInfo.gold>=o){e.showBuild(o);break}break}}var i=Array.from(this._commonBuildList);this.sortByUpgradeNeedCoin(i);var r=function(t){var e=i[t],n=e.getData(),o=c.showingUpdateArr.findIndex(function(t){return t===n.buildId});if(o>=0||0==n.level||4==n.level)return"continue";if(-1==o&&c.showingUpdateArr.length<3){var r=n["levelUpCoin"+(n.level+1)];a.G.player.accountCoinInfo.gold>=r&&(c.showingUpdateArr.push(n.buildId),e.showUpgrade(r,void 0))}else-1==o&&e.initUpgrade()},c=this;for(t=0;t<i.length;t++)r(t)},e.prototype.sortByUpgradeNeedCoin=function(t){return t.sort(function(t,e){var n=t.getData(),o=e.getData(),i=n.level,r=o.level;return n["levelUpCoin"+i]-o["levelUpCoin"+r]})},e._ins=null,r([u(cc.TiledMap)],e.prototype,"buildMap",void 0),r([u],e.prototype,"buildLayerName",void 0),r([u(cc.Node)],e.prototype,"buildBeHind",void 0),r([u(cc.Node)],e.prototype,"buildFont",void 0),r([u(cc.Prefab)],e.prototype,"buildPre",void 0),n=r([l],e)}(cc.Component);n.default=p,cc._RF.pop()},{"../../../scripts/G":void 0,"../item/item_build":"item_build"}],dressup:[function(t,e,n){"use strict";cc._RF.push(e,"f696e0MvShCh5U/IrQAvsi/","dressup");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function c(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../../core_lmn/core"),l=t("../../../scripts/G"),u=t("../../../scripts/GameConfig"),p=t("../item/item_dressup"),d=t("../manager/mapManager"),f=t("../popup/popBase"),h=cc._decorator,y=h.ccclass,v=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemLv=null,e.itemName=null,e.iconSpr=null,e.costLab=null,e.benefitStr1=null,e.benefitStr2=null,e.upgradeStr=null,e.goldStr=null,e.playStr=null,e.diceStr=null,e.btnUnlock=null,e.btnSet=null,e.btnUpgrade=null,e.content=null,e.dressUpPre=null,e.curItem=null,e.curUpgradeCost=0,e.curCostType=0,e.curItemId=1,e.loadDataCall=function(t){e.curItemId=t;for(var n=0;n<e.content.childrenCount;n++){var o=e.content.children[n];o.children[6].active=!1,n==t-1&&(o.children[6].active=!0)}e.loadCurSkinData()},e.skinType=0,e}return i(e,t),e.prototype.start=function(){},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this.curItemId=l.G.player.roleSkinId,this.skinType=0,this.loadCurSkinData(),this.loadRoleSkinData(),this.loadPlayerAttr()},e.prototype.loadPlayerAttr=function(){var t=l.G.calculatePlayerAttr(),e=t.addGold,n=t.addPlay,o=t.addDice;this.goldStr.node.getComponent(s.i18nLabel).init("static_passby",["+"+e]),this.playStr.node.getComponent(s.i18nLabel).init("static_play",["+"+n]),this.diceStr.node.getComponent(s.i18nLabel).init("static_playLimit",["+"+o])},e.prototype.loadCurSkinData=function(){return a(this,void 0,void 0,function(){var t,e;return c(this,function(n){switch(n.label){case 0:return 0!=this.skinType?[3,2]:(t=l.G.gameJson.roleSkinList[this.curItemId],[4,this.getRoleItemInfo(t)]);case 1:return e=n.sent(),[3,4];case 2:return t=l.G.gameJson.diceSkinList[this.curItemId],[4,this.getDiceItemInfo(t)];case 3:e=n.sent(),n.label=4;case 4:return this.curItem=t,this.itemLv.string="Lv."+e.curLv,this.itemName.node.getComponent(s.i18nLabel).init(t.nameKey,[]),this.costLab.node.getComponent(s.i18nLabel).init("static_dressup_costUnlock",[t.price+""]),this.btnSet.active=!1,this.benefitStr1.node.getComponent(s.i18nLabel).init(e.benefit1,["+"+e.benefit1Num]),e.islock||(this.benefitStr2.node.getComponent(s.i18nLabel).init(e.benefit2,["+"+e.benefit2Num]),this.upgradeStr.node.getComponent(s.i18nLabel).init(e.cost.costStr,["+"+e.cost.costNum]),this.curUpgradeCost=e.cost.costNum,this.curCostType=e.cost.costType,this.btnSet.active=!e.isSet),this.btnUpgrade.active=!1,this.benefitStr2.node.active=!e.islock,e.curLv<5?this.btnUpgrade.active=!e.islock:this.benefitStr2.node.active=!1,this.costLab.node.parent.active=e.islock,this.btnUnlock.active=e.islock,[2]}})})},e.prototype.getRoleItemInfo=function(t){return a(this,void 0,Promise,function(){var e,n,o,i,r,a,s,p,d,f,h=this;return c(this,function(c){switch(c.label){case 0:return e=l.G.player.roleSkinUnlock.findIndex(function(t){return t.skinId==h.curItemId}),n=1,p=!1,-1!==e?(n=l.G.player.roleSkinUnlock[e].skinlv,o=t.roleSkinLv[n-1].addGold,null!=(d=t.roleSkinLv[n-1].gold)?(r=d,s="static_dressup_gold",a=0):(r=t.roleSkinLv[n-1].diamond,s="static_dressup_diamond",a=1),n<5&&(i=t.roleSkinLv[n].addGold),p=t.skinId==l.G.player.roleSkinId):o=t.roleSkinLv[t.level-1].addGold,f=this.iconSpr,[4,Myfun.loadPicFromBundle(u.resInfo[u.resNames.skinIcon].bundle,u.resInfo[u.resNames.skinIcon].url,t.skinPic)];case 1:return f.spriteFrame=c.sent(),[2,{islock:-1==e,curLv:n,benefit1:"static_passby",benefit1Num:o,benefit2:"static_dressup_nextLevel",benefit2Num:i,cost:{costNum:r,costType:a,costStr:s},isSet:p}]}})})},e.prototype.getDiceItemInfo=function(t){return a(this,void 0,Promise,function(){var e,n,o,i,r,a,s,p,d,f=this;return c(this,function(c){switch(c.label){case 0:return e=l.G.player.diceSkinUnlock.findIndex(function(t){return t.skinId==f.curItemId}),n=1,p=!1,-1!==e?(n=l.G.player.diceSkinUnlock[e].skinlv,o=t.diceSkinLv[n-1].addPlay,null!=t.diceSkinLv[n-1].gold?(r=t.diceSkinLv[n-1].gold,s="static_dressup_gold",a=0):(r=t.diceSkinLv[n-1].diamond,s="static_dressup_diamond",a=1),n<5&&(i=t.diceSkinLv[n].addPlay),p=t.skinId==l.G.player.diceSkinId):o=t.diceSkinLv[t.level-1].addPlay,d=this.iconSpr,[4,Myfun.loadPicFromBundle(u.resInfo[u.resNames.skinIcon].bundle,u.resInfo[u.resNames.skinIcon].url,t.skinPic)];case 1:return d.spriteFrame=c.sent(),[2,{islock:-1==e,curLv:n,benefit1:"static_play",benefit1Num:o,benefit2:"static_dressup_nextLevel",benefit2Num:i,cost:{costNum:r,costType:a,costStr:s},isSet:p}]}})})},e.prototype.loadRoleSkinData=function(){this.content.removeAllChildren();for(var t=0;t<3;t++){var e=l.G.gameJson.roleSkinList[t+1],n=cc.instantiate(this.dressUpPre);n.parent=this.content,n.getComponent(p.default).setData(this.skinType,e,this.loadDataCall)}},e.prototype.loadDiceSkinData=function(){this.content.removeAllChildren();for(var t=0;t<3;t++){var e=l.G.gameJson.diceSkinList[t+1],n=cc.instantiate(this.dressUpPre);n.parent=this.content,n.getComponent(p.default).setData(this.skinType,e,this.loadDataCall.bind(this))}},e.prototype.toggleChecked=function(t){t.isChecked&&("role<Toggle>"==t.name?(this.skinType=0,this.loadRoleSkinData(),this.curItemId=l.G.player.roleSkinId,this.loadCurSkinData()):"dice<Toggle>"==t.name&&(this.skinType=1,this.loadDiceSkinData(),this.curItemId=l.G.player.diceSkinId,this.loadCurSkinData()))},e.prototype.btn_backClicked=function(){l.G.PoolManager.putNode(this.node),l.G.saveGameData()},e.prototype.btn_upgradeClicked=function(){var t=this;if(0==this.curCostType){if(l.G.player.accountCoinInfo.gold<this.curUpgradeCost)return void cc.log("\u91d1\u5e01\u4e0d\u8db3");l.G.player.accountCoinInfo.gold-=this.curUpgradeCost}else{if(l.G.player.accountCoinInfo.diamond<this.curUpgradeCost)return void cc.log("\u94bb\u77f3\u4e0d\u8db3");l.G.player.accountCoinInfo.diamond-=this.curUpgradeCost}0==this.skinType?l.G.player.roleSkinUnlock.find(function(e){return e.skinId==t.curItemId}).skinlv+=1:l.G.player.diceSkinUnlock.find(function(e){return e.skinId==t.curItemId}).skinlv+=1,this.loadCurSkinData(),this.loadPlayerAttr(),l.G.saveGameData()},e.prototype.btn_unlockClicked=function(){if(l.G.player.accountCoinInfo.diamond>=this.curItem.price){if(l.G.player.accountCoinInfo.diamond-=this.curItem.price,0==this.skinType){var t={skinId:(e=l.G.gameJson.roleSkinList[this.curItem.skinId]).skinId,skinlv:e.level};l.G.player.roleSkinUnlock.push(t)}else{var e;t={skinId:(e=l.G.gameJson.diceSkinList[this.curItem.skinId]).skinId,skinlv:e.level},l.G.player.diceSkinUnlock.push(t)}this.content.children[this.curItem.skinId-1].children[5].active=!1,this.loadCurSkinData()}l.G.saveGameData()},e.prototype.btn_setClicked=function(){this.btnSet.active=!1,0==this.skinType?l.G.player.roleSkinId=this.curItem.skinId:l.G.player.diceSkinId=this.curItem.skinId,d.default.inst.updataPlayerRoleSkin(),l.G.saveGameData(),this.loadPlayerAttr(),this.loadCurSkinData()},r([v(cc.Label)],e.prototype,"itemLv",void 0),r([v(cc.Label)],e.prototype,"itemName",void 0),r([v(cc.Sprite)],e.prototype,"iconSpr",void 0),r([v(cc.Label)],e.prototype,"costLab",void 0),r([v(cc.Label)],e.prototype,"benefitStr1",void 0),r([v(cc.Label)],e.prototype,"benefitStr2",void 0),r([v(cc.Label)],e.prototype,"upgradeStr",void 0),r([v(cc.Label)],e.prototype,"goldStr",void 0),r([v(cc.Label)],e.prototype,"playStr",void 0),r([v(cc.Label)],e.prototype,"diceStr",void 0),r([v(cc.Node)],e.prototype,"btnUnlock",void 0),r([v(cc.Node)],e.prototype,"btnSet",void 0),r([v(cc.Node)],e.prototype,"btnUpgrade",void 0),r([v(cc.Node)],e.prototype,"content",void 0),r([v(cc.Prefab)],e.prototype,"dressUpPre",void 0),r([y],e)}(f.default);n.default=g,cc._RF.pop()},{"../../../core_lmn/core":void 0,"../../../scripts/G":void 0,"../../../scripts/GameConfig":void 0,"../item/item_dressup":"item_dressup","../manager/mapManager":"mapManager","../popup/popBase":"popBase"}],gameManager:[function(t,e,n){"use strict";cc._RF.push(e,"fca97U0NJlJSKx1A2PjSpkl","gameManager");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function c(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../../core_lmn/camera/cameraFollow"),l=t("../../../core_lmn/core"),u=t("../../../scripts/G"),p=t("../../../scripts/GameConfig"),d=t("../animation/ani_afterDice"),f=t("../animation/ani_casinoReward"),h=t("../animation/ani_dice"),y=t("../animation/ani_diceReward"),v=t("./buildManager"),g=t("./mapManager"),m=cc._decorator,b=m.ccclass,_=m.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.diceCountLab=null,e.mapNameLab=null,e.timeCountLab=null,e.starProgress=null,e.dicePre=null,e.vipLab=null,e.coinLab=null,e.diamondLab=null,e.diamondBindLab=null,e.starLab=null,e.goNextMapBtn=null,e.content=null,e.playerIcon=null,e.diceReward=null,e.mapComp=null,e.guidePre=null,e.diceAniPre=null,e.casinoAniPre=null,e.UI_signPre=null,e.UI_shopPre=null,e.UI_vipPre=null,e.UI_dressUpPre=null,e.UI_playerInfoPre=null,e.mapNode=null,e.diceArea=null,e.specialBuildDis=[],e.canDiceFlag=!0,e.getDoubleCoinReward=!1,e.isStartRecovered=!1,e.timeCountFun=null,e.startpos=null,e.startPos1=null,e.startPos2=null,e.pointsDis=0,e}var n;return i(e,t),n=e,Object.defineProperty(e,"inst",{get:function(){return this._ins},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){null!=n._ins?this.node.destroy():n._ins=this},e.prototype.onDestroy=function(){n._ins=null},e.prototype.start=function(){this.initPlayerUIData(),this.loadMapData()},e.prototype.initPlayerUIData=function(){this.showPlayerIcon()},e.prototype.showPlayerIcon=function(){return a(this,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return t=this.playerIcon,[4,Myfun.loadPicFromBundle(p.resInfo[p.resNames.playerIcon].bundle,p.resInfo[p.resNames.playerIcon].url,"img_dfw_tx"+u.G.player.playerIcon)];case 1:return t.spriteFrame=e.sent(),[2]}})})},e.prototype.showMainLayer=function(){this.node.opacity=255},e.prototype.hideMainLayer=function(){this.node.opacity=0},e.prototype.clearStorage=function(){cc.sys.localStorage.clear()},e.prototype.openDressUp=function(){cc.instantiate(this.UI_dressUpPre).parent=cc.find("Canvas")},e.prototype.openSign=function(){cc.instantiate(this.UI_signPre).parent=cc.find("Canvas")},e.prototype.openVipLayer=function(){cc.instantiate(this.UI_vipPre).parent=cc.find("Canvas")},e.prototype.openShopLayer=function(){cc.instantiate(this.UI_shopPre).parent=cc.find("Canvas")},e.prototype.openPlayerInfo=function(){cc.instantiate(this.UI_playerInfoPre).parent=cc.find("Canvas")},e.prototype.purchaseBuild=function(t){u.G.player.accountCoinInfo.gold-=t,u.G.player.playerStar+=1,this._playerInfoHasUpdated(),u.G.player.playerStar==u.G.gameJson.mapList[u.G.player.curMapId].starNum&&this.showMapCompFlag()},e.prototype.loadMapData=function(t){return a(this,void 0,void 0,function(){var e;return c(this,function(n){switch(n.label){case 0:return t&&(u.G.player.playerPos=u.G.gameJson.mapList[u.G.player.curMapId].startPos),this.mapNameLab.node.getComponent(l.i18nLabel).init(u.G.gameJson.mapList[u.G.player.curMapId].mapNameKey,[]),[4,Myfun.loadPrefabFromBundle(p.LevelNames[u.G.player.curMapId-1].bundle,"",p.LevelNames[u.G.player.curMapId-1].url)];case 1:return e=n.sent(),this.mapNode=cc.instantiate(e),this.mapNode.parent=this.content,this.diceArea=this.mapNode.getChildByName("diceArea"),5==u.G.player.curMapId&&(this.goNextMapBtn.node.active=!1),[4,this.sleep(.1)];case 2:return n.sent(),this._playerInfoHasUpdated(!0),this.diceCountRecover(),this.mapNode.on("touchstart",this.onTouchStart,this),this.mapNode.on("touchmove",this.onTouchMove,this),this.mapNode.on("touchend",this.onTouchEnd,this),this.mapNode.on("touchcancel",this.onTouchEnd,this),[2]}})})},e.prototype.showMapCompFlag=function(){var t=cc.instantiate(this.mapComp);t.y=400,t.parent=this.node,this.showGuide(this.goNextMapBtn.node),this.scheduleOnce(function(){u.G.PoolManager.putNode(t)},1.5)},e.prototype.showGuide=function(t){var e=cc.instantiate(this.guidePre),n=Myfun.getNodePos(t,this.node);e.parent=this.node,e.setPosition(n)},e.prototype.openBlindBox=function(){this.showGame(1)},e.prototype.openSlot=function(){this.showGame(0)},e.prototype.openEscape=function(){this.showGame(2)},e.prototype.testCard=function(){"cn"==u.G.curLanguage?l.i18nMgr.setLanguage("en"):l.i18nMgr.setLanguage("cn")},e.prototype.btnNextMapClicked=function(){this.canDiceFlag&&(u.G.player.casinoInfo.curCasinoKeyPos.length>0||u.G.eventMsg.emit(MI.MSG.show_Layer,p.GameUILayers.MAPSELECT,p.GameUILayerNames))},e.prototype.moveToNextMap=function(){5!=u.G.player.curMapId&&(u.G.player.curMapId+=1,u.G.player.buildInfo=[],u.G.player.casinoInfo.curCasinoKeyPos=[],u.G.player.casinoInfo.getCasinoKeysNum=0,this.mapNode.destroy(),this.loadMapData(!0))},e.prototype._curPlayerPos=function(t){u.G.player.playerPos=t,u.G.saveGameData()},e.prototype.getDice=function(t){u.G.player.playerDiceCount+=t,this._playerInfoHasUpdated()},e.prototype.getCoin=function(t){u.G.player.accountCoinInfo.gold+=t,this._playerInfoHasUpdated()},e.prototype.getDiamond=function(t){u.G.player.accountCoinInfo.diamond+=t,this._playerInfoHasUpdated()},e.prototype.stepMoveEnd=function(t){u.G.player.playerPos=t,this.checkSpecialBuildDis(t),v.default.inst.checkBuildOrUpgrade(),u.G.saveGameData()},e.prototype.checkIsLinkGame=function(t){return a(this,void 0,void 0,function(){var e,n;return c(this,function(o){switch(o.label){case 0:if(null==(e=u.G.gameJson.mapList[u.G.player.curMapId].mapLink.find(function(e){return e.posX==t.x&&e.posY==t.y})).buildId)return this.canDiceFlag=!0,[2];if(1==(n=u.G.gameJson.mapList[u.G.player.curMapId].buildList.find(function(t){return t.buildId==e.buildId})).buildType&&""!==n.linkGame&&null!==n.linkGame)if("casino"==n.linkGame&&0==u.G.player.casinoInfo.curShowCasinoCardNum)this.showCasinoEntrance();else switch(n.linkGame){case"slotMachine":this.openSlot();break;case"blindbox":this.openBlindBox();break;case"escape":this.openEscape()}return[4,this.sleep(.2)];case 1:return o.sent(),this.canDiceFlag=!0,[2]}})})},e.prototype.showCasinoEntrance=function(){u.G.eventMsg.emit(MI.MSG.show_Layer,p.GameUILayers.POP_CASINOENT,p.GameUILayerNames)},e.prototype.showCasinoRewardAni=function(t){var e=this;return new Promise(function(n){u.G.PoolManager.getNode(e.casinoAniPre,e.node).getComponent(f.default).setData(t,function(){n()})})},e.prototype.checkSpecialBuildDis=function(t){this.specialBuildDis=[];for(var e=0;e<u.G.gameJson.mapList[u.G.player.curMapId].specialBuildPos.length;e++){var n=u.G.gameJson.mapList[u.G.player.curMapId].specialBuildPos[e],o=g.default.inst.stepCountBetweenTwoTile(t,n,0);this.specialBuildDis.push(o)}},e.prototype.showGame=function(t){return a(this,void 0,void 0,function(){return c(this,function(){return u.G.eventMsg.emit(MI.MSG.show_Layer,t,p.GameNames),[2]})})},e.prototype._playerInfoHasUpdated=function(t){void 0===t&&(t=!1),u.G.player.playerDiceCount>=u.G.gameJson.mapList[u.G.player.curMapId].diceUpper+u.G.calculatePlayerAttr().addDice&&(this.unschedule(this.timeCountFun),this.timeCountLab.node.active=!1,this.isStartRecovered=!1),this._updateUIShow(t)},e.prototype._updateUIShow=function(t){void 0===t&&(t=!1),this.coinLab.string=Myfun.transferNumToK(u.G.player.accountCoinInfo.gold),this.diamondLab.string=Myfun.transferNumToK(u.G.player.accountCoinInfo.diamond),this.diamondBindLab.string=u.G.player.accountCoinInfo.diamondBinding.toString();var e=u.G.gameJson.mapList[u.G.player.curMapId].starNum;this.starLab.string=u.G.player.playerStar+"/"+e,this.starProgress.progress=u.G.player.playerStar/e,this.diceCountLab.string=u.G.player.playerDiceCount+"/"+(u.G.gameJson.mapList[u.G.player.curMapId].diceUpper+u.G.calculatePlayerAttr().addDice),this.vipLab.string="VIP"+u.G.player.vipLevel},e.prototype.getStepMin=function(){var t=0;if(this.specialBuildDis.length>0){if(this.specialBuildDis.sort(function(t,e){return t-e}),(t=Math.min.apply(Math,this.specialBuildDis))<=1&&(t=this.specialBuildDis[1]),t>u.G.gameJson.mapList[u.G.player.curMapId].limitRange[0]&&t<=u.G.gameJson.mapList[u.G.player.curMapId].limitRange[1])return Math.random()<.3&&(t=0),t;t=0}return t},e.prototype.playClickAni=function(){return a(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return this.diceCountLab.node.parent.children[1].active?[2]:(this.diceCountLab.node.parent.children[1].active=!0,this.diceCountLab.node.parent.children[1].getComponent(sp.Skeleton).setAnimation(0,"animation",!1),[4,this.sleep(1)]);case 1:return t.sent(),this.diceCountLab.node.parent.children[1].active=!1,[2]}})})},e.prototype.btnDiceClick=function(){return a(this,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return!this.canDiceFlag||u.G.player.playerDiceCount<=0?[2]:(this.playClickAni(),s.default.inst.moveCameraToTarget(this.diceArea),this.getDoubleCoinReward=!1,u.G.player.playerDiceCount--,this.canDiceFlag=!1,[4,this.showDiceAni(this.getStepMin())]);case 1:return(t=e.sent()).double&&u.G.PoolManager.getNode(this.diceReward,this.node).getComponent(y.default).setSkin(t.total),this._playerInfoHasUpdated(),t.double?[4,this.sleep(1.5)]:[3,3];case 2:e.sent(),e.label=3;case 3:return g.default.inst.countStepHandler(t.total),this.diceCountRecover(),[2]}})})},e.prototype.showDiceAni=function(t){return a(this,void 0,void 0,function(){var e,n,o,i,r,a,s,l,p,f;return c(this,function(c){switch(c.label){case 0:return e=Myfun.getRandomInteger(1,7),n=Myfun.getRandomInteger(1,7),t&&(e=Myfun.getRandomInteger(1,t),n=t-e),(o=u.G.PoolManager.getNode(this.dicePre,this.diceArea)).getComponent(h.default).setData(e),i=Myfun.getRandomInteger(-150,-80),r=Myfun.getRandomInteger(-100,160),o.setPosition(cc.v2(i,r)),(a=u.G.PoolManager.getNode(this.dicePre,this.diceArea)).getComponent(h.default).setData(n),s=Myfun.getRandomInteger(80,150),l=Myfun.getRandomInteger(-100,160),a.setPosition(cc.v2(s,l)),p=e==n,f=e+n,[4,this.sleep(1.5)];case 1:return c.sent(),u.G.PoolManager.getNode(this.diceAniPre,this.node).getComponent(d.default).setData(e,n),[4,this.sleep(1)];case 2:return c.sent(),[2,{total:f,double:p}]}})})},e.prototype.diceCountRecover=function(){var t=this;if(!(this.isStartRecovered||u.G.player.playerDiceCount>=u.G.gameJson.mapList[u.G.player.curMapId].diceUpper+u.G.calculatePlayerAttr().addDice)){this.isStartRecovered=!0;var e=function(){u.G.player.playerDiceCount+=1,t.unschedule(t.timeCountFun),t._playerInfoHasUpdated(),u.G.player.playerDiceCount<u.G.gameJson.mapList[u.G.player.curMapId].diceUpper+u.G.calculatePlayerAttr().addDice&&t.showTime(u.G.gameJson.mapList[u.G.player.curMapId].diceRecover,e)};this.showTime(u.G.gameJson.mapList[u.G.player.curMapId].diceRecover,e)}},e.prototype.showTime=function(t,e){var n=this;this.schedule(this.timeCountFun=function(){if(t>0){n.timeCountLab.node.active=!0;var o=Math.floor(t/60),i=t-60*o,r=i<10?"0"+o+":0"+i:"0"+o+":"+i;n.timeCountLab.string=r+"\u540e\u83b7\u5f97\u4e00\u4e2a\u9ab0\u5b50",t--}else n.timeCountLab.string="00:00\u540e\u83b7\u5f97\u4e00\u4e2a\u9ab0\u5b50",e&&e()},1)},e.prototype.sleep=function(t){var e=this;return new Promise(function(n){e.scheduleOnce(function(){n()},t)})},e.prototype.onTouchStart=function(t){var e=t.getTouches();1==e.length?this.startpos=t.getLocation():2==e.length&&(this.startPos1=this.node.convertToNodeSpaceAR(e[0].getLocation()),this.startPos2=this.node.convertToNodeSpaceAR(e[1].getLocation()),this.pointsDis=this.startPos1.sub(this.startPos2).mag())},e.prototype.onTouchMove=function(t){var e=t.getTouches();if(1==e.length){var n=t.getDelta();s.default.inst.moveToPos(n)}else if(2==e.length){var o=this.node.convertToNodeSpaceAR(e[0].getLocation()),i=this.node.convertToNodeSpaceAR(e[1].getLocation()),r=o.sub(i).mag();if(this.pointsDis||(this.pointsDis=0),r>this.pointsDis){if(this.mapNode.scale>=.8)return void(this.mapNode.scale=.8);this.pointsDis=r,this.mapNode.scale+=.05}else if(r<this.pointsDis){if(this.mapNode.scale<=.4)return void(this.mapNode.scale=.4);this.pointsDis=r,this.mapNode.scale-=.05}}},e.prototype.onTouchEnd=function(t){var e,n=t.getLocation();null===(e=this.startpos)||void 0===e||e.sub(n).mag(),this.restrictPic()},e.prototype.restrictPic=function(){var t=this.mapNode.getBoundingBox().width,e=this.mapNode.getBoundingBox().height;s.default.inst.moveRestrict(t,e)},e._ins=null,r([_(cc.Label)],e.prototype,"diceCountLab",void 0),r([_(cc.Label)],e.prototype,"mapNameLab",void 0),r([_(cc.Label)],e.prototype,"timeCountLab",void 0),r([_(cc.ProgressBar)],e.prototype,"starProgress",void 0),r([_(cc.Prefab)],e.prototype,"dicePre",void 0),r([_(cc.Label)],e.prototype,"vipLab",void 0),r([_(cc.Label)],e.prototype,"coinLab",void 0),r([_(cc.Label)],e.prototype,"diamondLab",void 0),r([_(cc.Label)],e.prototype,"diamondBindLab",void 0),r([_(cc.Label)],e.prototype,"starLab",void 0),r([_(cc.Button)],e.prototype,"goNextMapBtn",void 0),r([_(cc.Node)],e.prototype,"content",void 0),r([_(cc.Sprite)],e.prototype,"playerIcon",void 0),r([_(cc.Prefab)],e.prototype,"diceReward",void 0),r([_(cc.Prefab)],e.prototype,"mapComp",void 0),r([_(cc.Prefab)],e.prototype,"guidePre",void 0),r([_(cc.Prefab)],e.prototype,"diceAniPre",void 0),r([_(cc.Prefab)],e.prototype,"casinoAniPre",void 0),r([_(cc.Prefab)],e.prototype,"UI_signPre",void 0),r([_(cc.Prefab)],e.prototype,"UI_shopPre",void 0),r([_(cc.Prefab)],e.prototype,"UI_vipPre",void 0),r([_(cc.Prefab)],e.prototype,"UI_dressUpPre",void 0),r([_(cc.Prefab)],e.prototype,"UI_playerInfoPre",void 0),n=r([b],e)}(cc.Component);n.default=I,cc._RF.pop()},{"../../../core_lmn/camera/cameraFollow":void 0,"../../../core_lmn/core":void 0,"../../../scripts/G":void 0,"../../../scripts/GameConfig":void 0,"../animation/ani_afterDice":"ani_afterDice","../animation/ani_casinoReward":"ani_casinoReward","../animation/ani_dice":"ani_dice","../animation/ani_diceReward":"ani_diceReward","./buildManager":"buildManager","./mapManager":"mapManager"}],item_buildPopup:[function(t,e,n){"use strict";cc._RF.push(e,"674c9VQD7NAfKeBICtQJcAY","item_buildPopup");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function c(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../../core_lmn/core"),l=t("../../../scripts/G"),u=t("../manager/buildManager"),p=t("../manager/gameManager"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.infoNode=null,e.infoName=null,e.infoDesc=null,e.infoDesc2=null,e.upgradeNode=null,e.upgradeName=null,e.upgradeInfo1=null,e.upgradeInfo2=null,e.upgradeCostLab=null,e.btnUpgrade=null,e.btnBuild=null,e.curCost=0,e.curBuildData=null,e.curBuildInfo=null,e.callBack=null,e.hasClicked=!1,e}return i(e,t),e.prototype.start=function(){var t=this;cc.director.on("hideBuildInfo",function(){null==t||t.node.destroy()})},e.prototype.onDisable=function(){this._destroyCall(),cc.director.off("hideBuildInfo"),this.unscheduleAllCallbacks()},e.prototype.setData=function(t,e,n,o){this.infoNode.active=!1,this.upgradeNode.active=!1,this.node.opacity=255,this.curBuildData=t,this.curBuildInfo=l.G.gameJson.buildInfoList[t.buildInfoId-1],this.curCost=e,0==n?this._showBuildInfo():this._showUpgradeNode(),this.callBack=o},e.prototype._destroyCall=function(){var t=this,e=u.default.inst.showingUpdateArr.findIndex(function(e){return e===t.curBuildData.buildId});-1!==e&&u.default.inst.showingUpdateArr.splice(e,1),u.default.inst.showingBuildId==this.curBuildData.buildId&&(u.default.inst.showingBuildId=-1),u.default.inst.showingInfoId=-1,u.default.inst.checkBuildOrUpgrade()},e.prototype._showBuildInfo=function(){var t=this;if(this.infoNode.active=!0,this.infoName.node.getComponent(s.i18nLabel).init(this.curBuildInfo.buildNameKey,[]),this.infoDesc.node.getComponent(s.i18nLabel).init(this.curBuildInfo.buildDescKey,[]),u.default.inst.showingInfoId=this.curBuildData.buildId,0==this.curBuildData.buildType){var e=this.curBuildData["levelReward"+(this.curBuildData.level+1)];this.infoDesc2.node.getComponent(s.i18nLabel).init("static_gold",[e])}else null==this.curBuildInfo.buildInfo?this.infoDesc2.string="":this.infoDesc2.node.getComponent(s.i18nLabel).init(this.curBuildInfo.buildInfoKey,[]);this.scheduleOnce(function(){var e;null===(e=t.node)||void 0===e||e.destroy()},2)},e.prototype._showUpgradeNode=function(){var t=this;this.upgradeNode.active=!0,this.upgradeName.node.getComponent(s.i18nLabel).init(this.curBuildInfo.buildNameKey,[]);var e=this.curBuildData["levelReward"+(this.curBuildData.level+1)],n=e;this.curBuildData.level>0&&(n=e-this.curBuildData["levelReward"+this.curBuildData.level]),this.upgradeInfo1.node.getComponent(s.i18nLabel).init("static_getGold",["+"+n]),this.upgradeInfo2.node.getComponent(s.i18nLabel).init("static_getStar",["+1"]),this.upgradeCostLab.string=this.curCost+"",this.btnUpgrade.node.active=!1,this.btnBuild.node.active=!1,this.curBuildData.level>0?this.btnUpgrade.node.active=!0:(u.default.inst.showingBuildId=this.curBuildData.buildId,this.btnBuild.node.active=!0),l.G.player.accountCoinInfo.gold<this.curCost?(this.btnBuild.interactable=!1,this.btnUpgrade.interactable=!1):(this.btnBuild.interactable=!0,this.btnUpgrade.interactable=!0),this.scheduleOnce(function(){var e;null===(e=t.node)||void 0===e||e.destroy()},5)},e.prototype.btnUpgradeClicked=function(){var t;return a(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return this.hasClicked?[2]:l.G.player.accountCoinInfo.gold>=this.curCost?(this.hasClicked=!0,this.node.opacity=0,p.default.inst.purchaseBuild(this.curCost),this.callBack?[4,this.callBack()]:[3,2]):[3,3];case 1:e.sent(),e.label=2;case 2:this.hasClicked=!1,null===(t=this.node)||void 0===t||t.destroy(),e.label=3;case 3:return[2]}})})},r([h(cc.Node)],e.prototype,"infoNode",void 0),r([h(cc.Label)],e.prototype,"infoName",void 0),r([h(cc.Label)],e.prototype,"infoDesc",void 0),r([h(cc.Label)],e.prototype,"infoDesc2",void 0),r([h(cc.Node)],e.prototype,"upgradeNode",void 0),r([h(cc.Label)],e.prototype,"upgradeName",void 0),r([h(cc.Label)],e.prototype,"upgradeInfo1",void 0),r([h(cc.Label)],e.prototype,"upgradeInfo2",void 0),r([h(cc.Label)],e.prototype,"upgradeCostLab",void 0),r([h(cc.Button)],e.prototype,"btnUpgrade",void 0),r([h(cc.Button)],e.prototype,"btnBuild",void 0),r([f],e)}(cc.Component);n.default=y,cc._RF.pop()},{"../../../core_lmn/core":void 0,"../../../scripts/G":void 0,"../manager/buildManager":"buildManager","../manager/gameManager":"gameManager"}],item_build:[function(t,e,n){"use strict";cc._RF.push(e,"bb466dRY+tKHadxOdWbKcwh","item_build");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function c(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../../scripts/G"),l=t("../../../scripts/GameConfig"),u=t("../../../scripts/Sound_Mgr"),p=t("../manager/buildManager"),d=t("./item_buildPopup"),f=cc._decorator,h=f.ccclass,y=f.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.build=null,e.clickArea=null,e.canBuild=null,e.canUpgrade=null,e.buildAniPre=null,e.buildPopupPre=null,e.skeleton=null,e.curBuildData=null,e.buildPicName="",e.curCost=0,e.isBuilding=!1,e}return i(e,t),e.prototype.start=function(){var t=this;this.clickArea.on("touchstart",function(){t.curBuildData.level!=t.curBuildData.buildType&&(p.default.inst.showingInfoId!=t.curBuildData.buildId?t.showBuildPopup(0):cc.director.emit("hideBuildInfo"))},this)},e.prototype.showBuildPopup=function(t){var e=s.G.PopupManager.getPopup(this.buildPopupPre);e.active=!0,e.parent=this.node.parent,e.setPosition(this.node.getPosition()),this.canBuild.active=!1,this.canUpgrade.active=!1,e.getComponent(d.default).setData(this.curBuildData,this.curCost,t,this.purchaseBuildCall.bind(this))},e.prototype.setData=function(t,e){return a(this,void 0,void 0,function(){var n,o,i;return c(this,function(r){switch(r.label){case 0:return this.curBuildData=t,n=s.G.gameJson.buildInfoList[t.buildInfoId-1],this.buildPicName=n.buildPic,1!=t.buildType||1===t.buildId?[3,2]:(o=this.skeleton,[4,Myfun.loadSpineDataFromBundle(l.resInfo[l.resNames.spines].bundle,l.resInfo[l.resNames.spines].url,n.buildPic)]);case 1:return o.skeletonData=r.sent(),this.skeleton.node.active=!0,this.skeleton.setAnimation(0,"animation",!0),[3,4];case 2:return e>0?(i=this.build.getComponent(cc.Sprite),[4,Myfun.loadPicFromBundle(l.resInfo[l.resNames.building].bundle,l.resInfo[l.resNames.building].url,n.buildPic+e)]):[3,4];case 3:i.spriteFrame=r.sent(),r.label=4;case 4:return e>0&&(this.clickArea.active=!0),[2]}})})},e.prototype.getData=function(){return this.curBuildData},e.prototype.initBuild=function(){this.canBuild.active=!1},e.prototype.initUpgrade=function(){this.canUpgrade.active=!1},e.prototype.showBuild=function(t){this.isBuilding||(this.canBuild.active=!0,this.canUpgrade.active=!1,this.curCost=t)},e.prototype.showUpgrade=function(t){this.isBuilding||(this.canBuild.active=!1,this.canUpgrade.active=!0,this.curCost=t)},e.prototype.purchaseBuildCall=function(){return a(this,void 0,void 0,function(){var t,e,n=this;return c(this,function(o){switch(o.label){case 0:return this.isBuilding=!0,s.G.PoolManager.getNode(this.buildAniPre,this.node.parent).setPosition(this.node.getPosition()),u.default.Inst.play("build"),this.curBuildData.level+=1,1==this.curBuildData.level&&(this.clickArea.active=!0),s.G.player.buildInfo.find(function(t){return t.buildId==n.curBuildData.buildId}).level=this.curBuildData.level,s.G.saveGameData(),[4,this.sleep(1)];case 1:return o.sent(),t=this.build.getComponent(cc.Sprite),[4,Myfun.loadPicFromBundle(l.resInfo[l.resNames.building].bundle,l.resInfo[l.resNames.building].url,this.buildPicName+this.curBuildData.level)];case 2:return t.spriteFrame=o.sent(),this.isBuilding=!1,-1!==(e=p.default.inst.showingUpdateArr.findIndex(function(t){return t===n.curBuildData.buildId}))&&p.default.inst.showingUpdateArr.splice(e,1),p.default.inst.checkBuildOrUpgrade(),[4,this.sleep(.6)];case 3:return o.sent(),[2]}})})},e.prototype.btnBulidClick=function(){this.canBuild.active=!1,this.showBuildPopup(1)},e.prototype.btnUpgradeClick=function(){this.canUpgrade.active=!1,this.showBuildPopup(1)},e.prototype.sleep=function(t){var e=this;return new Promise(function(n){e.scheduleOnce(function(){n()},t)})},r([y(cc.Node)],e.prototype,"build",void 0),r([y(cc.Node)],e.prototype,"clickArea",void 0),r([y(cc.Node)],e.prototype,"canBuild",void 0),r([y(cc.Node)],e.prototype,"canUpgrade",void 0),r([y(cc.Prefab)],e.prototype,"buildAniPre",void 0),r([y(cc.Prefab)],e.prototype,"buildPopupPre",void 0),r([y(sp.Skeleton)],e.prototype,"skeleton",void 0),r([h],e)}(cc.Component);n.default=v,cc._RF.pop()},{"../../../scripts/G":void 0,"../../../scripts/GameConfig":void 0,"../../../scripts/Sound_Mgr":void 0,"../manager/buildManager":"buildManager","./item_buildPopup":"item_buildPopup"}],item_casinoCard:[function(t,e,n){"use strict";cc._RF.push(e,"56ab7/63XhBV7tjzQlfcLVU","item_casinoCard");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function c(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../../scripts/Sound_Mgr"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cardSpList=[],e.cardData=[],e.isJoker=!1,e.jokerIndex=0,e.colorArr=["#40efff","#ff2929","#ffef71","#9640ff","#ff9df0"],e.skinNameArr=["bing","huo","guang","an","quan"],e.skeAniNameArr=["zheng","zhuangtai1","zhuangtai2","zhuangtai3","zhuangtai4"],e.cardState=[0,0,0,0,0],e.count={},e.curIndex=0,e}return i(e,t),e.prototype.start=function(){},e.prototype.onEnable=function(){this.curIndex=0,this.cardState=[0,0,0,0,0],this.count={};for(var t=0;t<this.cardSpList.length;t++){var e=this.cardSpList[t];e.setSkin("default"),e.setAnimation(0,"bei",!0)}},e.prototype.test=function(){for(var t=0;t<this.cardSpList.length;t++){var e=this.cardSpList[t],n=this.cardData[t]-1,o=this.skinNameArr[n];e.setSkin(o),e.findSlot("hy1").color=Myfun.hexToRGBA(this.colorArr[n]),e.setAnimation(0,"zhuangtai4",!0),e.setSlotsToSetupPose()}},e.prototype.setCardData=function(t,e){this.cardData=t,this.isJoker=e,e&&(this.jokerIndex=this.replaceLastDuplicate(this.cardData,5))},e.prototype.replaceLastDuplicate=function(t,e){for(var n={},o=0,i=0;i<t.length;i++)n[t[i]]=i;for(i=0;i<t.length;i++){var r=n[t[i]];if(r!==i){t[r]=e,o=r;break}}return o},e.prototype.setShowNum=function(t){for(var e=0;e<t;e++){var n=this.cardSpList[e],o=this.cardData[e]-1,i=this.skinNameArr[o];n.setSkin(i),5==this.cardData[e]&&(this.cardData[e]=this.cardData[e-1]),this.displayWithState(this.cardData,this.cardState,this.count,e)}this.showAniByState(),this.curIndex=t},e.prototype.displayWithState=function(t,e,n,o){var i=t[o];n[i]=(n[i]||0)+1;for(var r=0;r<=o;r++)t[r]===i&&(e[r]=n[i])},e.prototype.showAniByState=function(){for(var t=0;t<this.cardState.length;t++){var e=this.cardState[t];if(e<=0)break;var n=this.skeAniNameArr[e-1];if(this.isJoker&&this.jokerIndex==t){var o=this.cardData[this.jokerIndex-1]-1,i=this.skinNameArr[o];this.cardSpList[t].setSkin(i)}n!==this.cardSpList[t].animation&&this.cardSpList[t].setAnimation(0,n,!0)}},e.prototype.showOneCard=function(){return a(this,void 0,void 0,function(){var t,e,n,o=this;return c(this,function(i){switch(i.label){case 0:return t=this.cardSpList[this.curIndex],e=this.cardData[this.curIndex]-1,n=this.skinNameArr[e],t.setSkin(n),t.setAnimation(0,"chuxian",!1),s.default.Inst.play("fanka"),[4,new Promise(function(t){o.scheduleOnce(function(){t()},1)})];case 1:return i.sent(),5==this.cardData[this.curIndex]&&(this.cardData[this.curIndex]=this.cardData[this.curIndex-1]),this.displayWithState(this.cardData,this.cardState,this.count,this.curIndex),this.showAniByState(),this.curIndex++,[4,new Promise(function(t){o.scheduleOnce(function(){t()},.2)})];case 2:return i.sent(),[2]}})})},r([p(sp.Skeleton)],e.prototype,"cardSpList",void 0),r([u],e)}(cc.Component);n.default=d,cc._RF.pop()},{"../../../scripts/Sound_Mgr":void 0}],item_casinoKey:[function(t,e,n){"use strict";cc._RF.push(e,"2ae4fBiEg1Kf7cU8d1BklKq","item_casinoKey");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../scripts/G"),c=cc._decorator,s=c.ccclass,l=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.keySp=null,e}return i(e,t),e.prototype.start=function(){},e.prototype.onEnable=function(){var t=this;this.keySp.setCompleteListener(function(){t.keySp.setAnimation(0,"ysdaiji",!0)}),this.keySp.setAnimation(0,"yschuxian",!1)},e.prototype.getKey=function(){var t=this;this.keySp.setCompleteListener(function(){a.G.PoolManager.putNode(t.node)}),this.keySp.setAnimation(0,"ysdakai",!1)},e.prototype.onDisable=function(){},r([l(sp.Skeleton)],e.prototype,"keySp",void 0),r([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../../../scripts/G":void 0}],item_checkState:[function(t,e,n){"use strict";cc._RF.push(e,"b315dlqSdBJN5mlHQHRNCkg","item_checkState");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../scripts/G"),c=cc._decorator,s=c.ccclass,l=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ske=null,e.skeAniname="",e.ske_cn=null,e.ske_en=null,e.lastLanguage="",e}return i(e,t),e.prototype.onEnable=function(){this.loadSkeData()},e.prototype.loadSkeData=function(){"cn"==a.G.curLanguage?this.ske.skeletonData=this.ske_cn:this.ske.skeletonData=this.ske_en,this.lastLanguage=a.G.curLanguage,this.ske.setAnimation(0,this.skeAniname,!0)},e.prototype.update=function(){a.G.curLanguage!==this.lastLanguage&&this.loadSkeData()},r([l(sp.Skeleton)],e.prototype,"ske",void 0),r([l],e.prototype,"skeAniname",void 0),r([l(sp.SkeletonData)],e.prototype,"ske_cn",void 0),r([l(sp.SkeletonData)],e.prototype,"ske_en",void 0),r([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../../../scripts/G":void 0}],item_coin:[function(t,e,n){"use strict";cc._RF.push(e,"490ffkyC/RAVKOX4BRyvcbw","item_coin");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../scripts/G"),c=cc._decorator,s=c.ccclass,l=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.coinLab=null,e.curCoin=0,e}return i(e,t),e.prototype.start=function(){},e.prototype.setData=function(t){this.curCoin=t,this.coinLab.string=t+""},e.prototype.getData=function(){return this.curCoin},e.prototype.onPlayCoinAni=function(t,e,n,o,i){var r=this;return new Promise(function(a){for(var c=Myfun.getNodePos(t,e),s=cc.find(o),l=Myfun.getCirclePoints(100,c,3,15),u=function(t){var o=cc.instantiate(n);o.active=!0,o.parent=r.node,o.setPosition(c);var u=l[t].x,p=l[t].y;cc.tween(o).to(.1,{position:cc.v3(u,p)}).start(),r.scheduleOnce(function(){cc.Tween.stopAllByTarget(o);var n=o.getPosition(),r=Myfun.getNodePos(s,e),c=n.sub(r).mag()/1e3;cc.tween(o).to(c,{position:cc.v3(r.x,r.y)},{easing:"sineInOut"}).call(function(){o.destroy(),2==t&&i&&i(),a()}).start()},.1+.1*.1*t)},p=0;p<3;p++)u(p)})},e.prototype.playAni=function(){var t=this;cc.tween(this.node).by(.2,{position:cc.v3(0,150,0),opacity:0}).call(function(){a.G.PoolManager.putNode(t.node)},this).start()},r([l(cc.Node)],e.prototype,"icon",void 0),r([l(cc.Label)],e.prototype,"coinLab",void 0),r([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../../../scripts/G":void 0}],item_dressup:[function(t,e,n){"use strict";cc._RF.push(e,"b1753/i2c5N9qe8hRoOLwaN","item_dressup");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function c(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../../core_lmn/core"),l=t("../../../scripts/G"),u=t("../../../scripts/GameConfig"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemLvLab=null,e.itemNameLab=null,e.skeleton=null,e.iconSpr=null,e.selectFlag=null,e.lockFlag=null,e.callBack=null,e.curIndex=0,e}return i(e,t),e.prototype.start=function(){},e.prototype.itemUnlocked=function(){this.lockFlag.active=!1},e.prototype.itemSelected=function(){this.callBack&&this.callBack(this.curIndex)},e.prototype.setData=function(t,e,n){return a(this,void 0,void 0,function(){var o,i;return c(this,function(r){switch(r.label){case 0:return this.itemNameLab.node.getComponent(s.i18nLabel).init(e.nameKey,[]),0!=t?[3,1]:(this.iconSpr.node.active=!1,o=l.G.player.roleSkinUnlock.findIndex(function(t){return t.skinId==e.skinId}),l.G.player.roleSkinId==e.skinId&&(this.selectFlag.active=!0),this.skeleton.setSkin(e.spineName),[3,3]);case 1:return this.skeleton.node.active=!1,this.iconSpr.node.active=!0,o=l.G.player.diceSkinUnlock.findIndex(function(t){return t.skinId==e.skinId}),l.G.player.diceSkinId==e.skinId&&(this.selectFlag.active=!0),i=this.iconSpr,[4,Myfun.loadPicFromBundle(u.resInfo[u.resNames.skinIcon].bundle,u.resInfo[u.resNames.skinIcon].url,e.skinPic)];case 2:i.spriteFrame=r.sent(),r.label=3;case 3:return this.lockFlag.active=-1==o,this.curIndex=e.skinId,this.callBack=n,[2]}})})},r([f(cc.Label)],e.prototype,"itemLvLab",void 0),r([f(cc.Label)],e.prototype,"itemNameLab",void 0),r([f(sp.Skeleton)],e.prototype,"skeleton",void 0),r([f(cc.Sprite)],e.prototype,"iconSpr",void 0),r([f(cc.Node)],e.prototype,"selectFlag",void 0),r([f(cc.Node)],e.prototype,"lockFlag",void 0),r([d],e)}(cc.Component);n.default=h,cc._RF.pop()},{"../../../core_lmn/core":void 0,"../../../scripts/G":void 0,"../../../scripts/GameConfig":void 0}],item_shop:[function(t,e,n){"use strict";cc._RF.push(e,"88fd2WxCfdEAqj6qa6KaRM7","item_shop");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function c(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../../scripts/G"),l=t("../../../scripts/GameConfig"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.numLab=null,e.extraLab=null,e.tag=null,e.tag1=null,e.tag2=null,e.priceLab=null,e.callBack=null,e.curData=null,e._tagFlag=!0,e._isFirstPurchase=!1,e}return i(e,t),e.prototype.start=function(){},e.prototype._setData=function(t,e){return a(this,void 0,void 0,function(){var n,o;return c(this,function(i){switch(i.label){case 0:return this.numLab.string=Myfun.transferNumToK(t.num),this.extraLab.string=t.extraStr,this.priceLab.string="US$"+t.price,this.tag2.getComponent(cc.Label).string="+"+Myfun.transferNumToK(t.extraNum),n=this.icon,[4,Myfun.loadPicFromBundle(l.resInfo[l.resNames.shopIcon].bundle,l.resInfo[l.resNames.shopIcon].url,t.pic)];case 1:return n.spriteFrame=i.sent(),this.curData=t,this.callBack=e,o=t.type+"-"+t.id,this._checkIsFirstPurchase(o),[2]}})})},e.prototype._checkIsFirstPurchase=function(t){-1==s.G.player.firstPurchase.findIndex(function(e){return e==t})?(this._isFirstPurchase=!0,this._showFirstPurhaseAni()):this.tag.active=!1},e.prototype._showFirstPurhaseAni=function(){var t=this;this.schedule(function(){cc.tween(t.tag).to(.3,{scaleX:0}).delay(.1).call(function(){t._tagFlag?(t.tag1.active=!1,t.tag2.active=!0):(t.tag1.active=!0,t.tag2.active=!1),t._tagFlag=!t._tagFlag}).to(.3,{scaleX:.5}).start()},5)},e.prototype._purchaseSuccess=function(){var t=this;this.tag.active=!1,this.unscheduleAllCallbacks(),-1==s.G.player.firstPurchase.findIndex(function(e){return e==t.curData.type+"-"+t.curData.id})&&s.G.player.firstPurchase.push(this.curData.type+"-"+this.curData.id);var e=this.curData.num;this._isFirstPurchase&&(e=this.curData.num+this.curData.extraNum),0==this.curData.type?s.G.player.accountCoinInfo.gold+=e:1==this.curData.type&&(s.G.player.accountCoinInfo.diamond+=e,s.G.updatePlayerVipLevel(e)),this.callBack&&this.callBack(this.icon.node,this.curData.type),this._isFirstPurchase=!1},e.prototype.btnPurchaseClicked=function(){this._purchaseSuccess()},r([d(cc.Sprite)],e.prototype,"icon",void 0),r([d(cc.Label)],e.prototype,"numLab",void 0),r([d(cc.Label)],e.prototype,"extraLab",void 0),r([d(cc.Node)],e.prototype,"tag",void 0),r([d(cc.Node)],e.prototype,"tag1",void 0),r([d(cc.Node)],e.prototype,"tag2",void 0),r([d(cc.Label)],e.prototype,"priceLab",void 0),r([p],e)}(cc.Component);n.default=f,cc._RF.pop()},{"../../../scripts/G":void 0,"../../../scripts/GameConfig":void 0}],item_vipReward:[function(t,e,n){"use strict";cc._RF.push(e,"83171DiJYxDjqto512K5LKH","item_vipReward");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../scripts/G"),c=cc._decorator,s=c.ccclass,l=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.goldStr=null,e.diamondStr=null,e.btnGetReward=null,e.curVip=0,e.rewardGold=0,e.rewardDiamond=0,e}return i(e,t),e.prototype.setData=function(t,e,n,o){this.goldStr.string="\u91d1\u5e01\uff1a"+t,this.diamondStr.string="\u94bb\u77f3\uff1a"+e,this.rewardGold=t,this.rewardDiamond=e,this.btnGetReward.interactable=o,-1!==a.G.player.vipBenefitGot.findIndex(function(t){return t==n})&&(this.btnGetReward.node.active=!1),this.curVip=n},e.prototype.getReward=function(){var t=this;-1==a.G.player.vipBenefitGot.findIndex(function(e){return e==t.curVip})&&(a.G.player.accountCoinInfo.gold=Myfun.sumFloat(a.G.player.accountCoinInfo.gold,this.rewardGold),a.G.player.accountCoinInfo.diamond=Myfun.sumFloat(a.G.player.accountCoinInfo.diamond,this.rewardDiamond),a.G.player.vipBenefitGot.push(this.curVip)),this.btnGetReward.node.active=!1},r([l(cc.Label)],e.prototype,"goldStr",void 0),r([l(cc.Label)],e.prototype,"diamondStr",void 0),r([l(cc.Button)],e.prototype,"btnGetReward",void 0),r([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../../../scripts/G":void 0}],mapManager:[function(t,e,n){"use strict";cc._RF.push(e,"1456fPYPZ5DW5k30HxmN3Lv","mapManager");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function c(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../../core_lmn/camera/cameraFollow"),l=t("../../../scripts/G"),u=t("../item/item_casinoCard"),p=t("../item/item_casinoKey"),d=t("../item/item_coin"),f=t("./gameManager"),h=cc._decorator,y=h.ccclass,v=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tileMap=null,e.playerNode=null,e.player_ske=null,e.coinArea=null,e.coinPre=null,e.keyPre=null,e.casinoCardPre=null,e.frontSke=null,e.backSke=null,e.floorLayerName="",e._curTile=null,e._layerFloor=null,e.curKeysNodes=[],e.curCardNode=null,e.curCoinArr=[],e.stepPosArr=[],e.spineSkinName="",e}var n;return i(e,t),n=e,Object.defineProperty(e,"inst",{get:function(){return this._ins},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){cc.log("onLoad"),null!==n._ins?this.node.destroy():n._ins=this},e.prototype.start=function(){this._layerFloor=this.tileMap.getLayer(this.floorLayerName),this._initPlayerPos(),this.reloadCurCasinoData(),this.updataPlayerRoleSkin(),this.updateRoleDirection(this._curTile),this.player_ske.setAnimation(0,"daiji",!0)},e.prototype.onDisable=function(){cc.log("onDisable"),n._ins=null},e.prototype.reloadCurCasinoData=function(){l.G.player.casinoInfo.curCasinoKeyPos.length>0&&this.showKeysInRoad(l.G.player.casinoInfo.curCasinoKeyPos),l.G.player.casinoInfo.hasShowCasinoCard&&this.showCasinoCard(l.G.player.casinoInfo.curCasinoCardData,l.G.player.casinoInfo.curShowCasinoCardNum)},e.prototype.generateCasinoKeys=function(){if(!(l.G.player.casinoInfo.hasShowCasinoCard||l.G.player.casinoInfo.getCasinoKeysNum>0||l.G.player.casinoInfo.curCasinoKeyPos.length>0)){l.G.player.casinoInfo.curCasinoKeyPos=[];var t=this._curTile,e=l.G.gameJson.mapList[l.G.player.curMapId].mapLink;l.G.player.casinoInfo.curCasinoKeyPos=this.getRandomElementsFromArrayExcludingValue(e,5,t),this.showKeysInRoad(l.G.player.casinoInfo.curCasinoKeyPos)}},e.prototype.showKeysInRoad=function(t){for(var e=0;e<t.length;e++){var n=t[e],o=this._layerFloor.getPositionAt(n),i=l.G.PoolManager.getNode(this.keyPre,this.coinArea);i.setPosition(o),this.curKeysNodes.push(i)}},e.prototype.getRandomElementsFromArrayExcludingValue=function(t,e,n){for(var o=[],i=function(){var e=Math.floor(Math.random()*t.length),i=t[e],r=o.findIndex(function(t){return t.x==i.posX&&t.y==i.posY});i.posX===n.x&&i.posY===n.y||-1!=r||o.push(cc.v2(i.posX,i.posY))};o.length<e;)i();return o},e.prototype.testGetCard=function(){for(var t=0,e=0,n=0,o=0,i=0,r=0,a=0;a<10;a++){var c=this.getCasinoCard();e++,t+=l.G.gameJson.casinoConfig[0].cardPrizeReward[c.reward],0==c.reward?n++:1==c.reward?o++:2==c.reward?i++:3==c.reward&&r++}console.log("\u603b\u6b21\u6570",10,"\n\u7ec4\u5408\u4e00\uff085\u79cd\u76f8\u540c\uff09 \u6b21\u6570\uff1a"+n+" \u6982\u7387\uff1a"+(n/e).toFixed(4),"\n\u7ec4\u5408\u4e8c\uff084\u79cd\u76f8\u540c\uff09 \u6b21\u6570\uff1a"+o+" \u6982\u7387\uff1a"+(o/e).toFixed(4),"\n\u7ec4\u5408\u4e09\uff083\u79cd\u76f8\u540c\uff09 \u6b21\u6570\uff1a"+i+" \u6982\u7387\uff1a"+(i/e).toFixed(4),"\n\u7ec4\u5408\u56db\uff082\u79cd\u76f8\u540c\uff09 \u6b21\u6570\uff1a"+r+" \u6982\u7387\uff1a"+(r/e).toFixed(4),"\n\u82b1\u8d39\u94bb\u77f3:",5e3,"\u83b7\u5f97\u94bb\u77f3:",t)},e.prototype.getCasinoCard=function(){var t,e,n=[],o=!1;return Math.random()<=l.G.gameJson.casinoConfig[0].jokerRate&&(o=!0),t=e=o?Myfun.getWeightedIndex(l.G.gameJson.casinoConfig[0].jokerPrizeWeight):Myfun.getWeightedIndex(l.G.gameJson.casinoConfig[0].cardPrizeWeight),0==e?n=this.generateRandomCardGroupType1():1==e?n=this.generateRandomCardGroupType2():2==e?n=this.generateRandomCardGroupType3():3==e&&(n=this.generateRandomCardGroupType4()),{cardSuits:n,reward:t,isJoker:o}},e.prototype.generateRandomCardGroupType1=function(){var t=[],e=Math.floor(Math.random()*(l.G.gameJson.casinoConfig[0].cardSuits.length-1)),n=l.G.gameJson.casinoConfig[0].cardSuits[e];return t.push(n,n,n,n,n),t},e.prototype.generateRandomCardGroupType2=function(){var t=[],e=Math.floor(Math.random()*(l.G.gameJson.casinoConfig[0].cardSuits.length-1)),n=l.G.gameJson.casinoConfig[0].cardSuits[e];t.push(n,n,n,n);for(var o=l.G.gameJson.casinoConfig[0].cardSuits.filter(function(t){return t!==n});t.length<5;){var i=Math.floor(Math.random()*(o.length-1));t.push(o[i])}return t},e.prototype.generateRandomCardGroupType3=function(){var t=[],e=Math.floor(Math.random()*(l.G.gameJson.casinoConfig[0].cardSuits.length-1)),n=l.G.gameJson.casinoConfig[0].cardSuits[e];t.push(n,n,n);for(var o=l.G.gameJson.casinoConfig[0].cardSuits.filter(function(t){return t!==n});t.length<5;){var i=Math.floor(Math.random()*(o.length-1));t.push(o[i])}return t},e.prototype.generateRandomCardGroupType4=function(){for(var t=Math.floor(Math.random()*(l.G.gameJson.casinoConfig[0].cardSuits.length-1)),e=l.G.gameJson.casinoConfig[0].cardSuits[t],n=[e,e],o=[],i=l.G.gameJson.casinoConfig[0].cardSuits.filter(function(t){return t!==e}),r=0;r<3;r++){for(var a=Math.floor(Math.random()*(i.length-1)),c=i[a];2==r&&o.includes(c);)c=i[a=Math.floor(Math.random()*(i.length-1))];o.push(i[a])}return n.concat(o)},e.prototype.generateRandomCardGroupType5=function(){var t=[],e=Math.floor(Math.random()*l.G.gameJson.casinoConfig[0].cardSuits.length-1),n=l.G.gameJson.casinoConfig[0].cardSuits[e];t.push(n);for(var o=l.G.gameJson.casinoConfig[0].cardSuits.filter(function(t){return t!==n}),i=function(){var e=Math.floor(Math.random()*o.length);t.push(o[e]),o=o.filter(function(t){return t!==o[e]})};t.length<5;)i();return t},e.prototype.showCasinoCard=function(t,e){if(t||!l.G.player.casinoInfo.hasShowCasinoCard){l.G.player.casinoInfo.getCasinoKeysNum=0,l.G.player.casinoInfo.hasShowCasinoCard=!0;var n=l.G.PoolManager.getNode(this.casinoCardPre,this.playerNode);t||(t=this.getCasinoCard()),cc.log(t),n.getComponent(u.default).setCardData(t.cardSuits,t.isJoker),e&&n.getComponent(u.default).setShowNum(e),l.G.player.casinoInfo.curCasinoCardData=t,this.curCardNode=n}},e.prototype.showCardByStep=function(){var t;return a(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return l.G.player.casinoInfo.hasShowCasinoCard?(l.G.player.casinoInfo.curShowCasinoCardNum++,[4,null===(t=this.curCardNode)||void 0===t?void 0:t.getComponent(u.default).showOneCard()]):[3,3];case 1:return e.sent(),5!=l.G.player.casinoInfo.curShowCasinoCardNum?[3,3]:(l.G.PoolManager.putNode(this.curCardNode),[4,n.inst.hasShowAllCard()]);case 2:e.sent(),e.label=3;case 3:return[2]}})})},e.prototype.hasShowAllCard=function(){return a(this,void 0,void 0,function(){var t,e;return c(this,function(n){switch(n.label){case 0:return t=l.G.gameJson.casinoConfig[0].cardPrizeReward[l.G.player.casinoInfo.curCasinoCardData.reward],e={num:t,suits:structuredClone(l.G.player.casinoInfo.curCasinoCardData.cardSuits)},l.G.player.casinoInfo.curShowCasinoCardNum=0,l.G.player.casinoInfo.hasShowCasinoCard=!1,l.G.player.casinoInfo.curCasinoCardData.cardSuits=[],l.G.player.casinoInfo.curCasinoCardData.reward=0,[4,f.default.inst.showCasinoRewardAni(e)];case 1:return n.sent(),0==l.G.player.casinoInfo.playMode?f.default.inst.getCoin(t):f.default.inst.getDiamond(t),l.G.saveGameData(),[2]}})})},e.prototype._initPlayerPos=function(){this._curTile=l.G.player.playerPos;var t=this._layerFloor.getPositionAt(this._curTile);this.playerNode.setPosition(t),s.default.inst.targetNode=this.playerNode,l.G.player.curMapId>1&&(s.default.inst.isMoving=!0,this.scheduleOnce(function(){s.default.inst.isMoving=!1},1))},e.prototype.showCoinByPos=function(t){return a(this,void 0,void 0,function(){var e,n,o;return c(this,function(i){switch(i.label){case 0:e=function(e){var o,i,r;return c(this,function(a){switch(a.label){case 0:return o=n.stepPosArr[e],i=l.G.PoolManager.getNode(n.coinPre,n.coinArea),r=n._layerFloor.getPositionAt(o),i.setPosition(r),-1!==l.G.player.casinoInfo.curCasinoKeyPos.findIndex(function(t){return t.x==o.x&&t.y==o.y})&&(t[e]=0),t[e]>0&&(t[e]+=l.G.calculatePlayerAttr().addGold),i.getComponent(d.default).setData(t[e]),n.curCoinArr.push(i),0==t[e]?(i.active=!1,[2,"continue"]):[4,n.sleep(.1)];case 1:return a.sent(),[2]}})},n=this,o=0,i.label=1;case 1:return o<this.stepPosArr.length?[5,e(o)]:[3,4];case 2:i.sent(),i.label=3;case 3:return o++,[3,1];case 4:return s.default.inst.isMoving=!0,this._tryStepMove(),[2]}})})},e.prototype.sleep=function(t){var e=this;return new Promise(function(n){e.scheduleOnce(function(){n()},t)})},e.prototype._tryMoveToNewTile=function(t,e){var n=this.tileMap.getMapSize();if(!(t.x<0||t.x>=n.width||t.y<0||t.y>=n.height)){if(0==this._layerFloor.getTileGIDAt(t))return!1;this._curTile=t,this._updatePlayerPos(e)}},e.prototype.checkGetKey=function(t){if(0!=l.G.player.casinoInfo.curCasinoKeyPos.length){for(var e=0;e<l.G.player.casinoInfo.curCasinoKeyPos.length;e++){var n=l.G.player.casinoInfo.curCasinoKeyPos[e];if(n.x==t.x&&n.y==t.y){l.G.player.casinoInfo.getCasinoKeysNum++,0==l.G.player.casinoInfo.keyMode?l.G.player.accountCoinInfo.casinoGoldKey++:l.G.player.accountCoinInfo.casinoDiamondKey++,l.G.player.casinoInfo.curCasinoKeyPos.splice(e,1);for(var o=this._layerFloor.getPositionAt(t),i=0;i<this.curKeysNodes.length;i++){var r=this.curKeysNodes[i];r.x==o.x&&r.y==o.y&&r.getComponent(p.default).getKey()}break}}5==l.G.player.casinoInfo.getCasinoKeysNum&&(this.curKeysNodes=[],l.G.player.casinoInfo.curCasinoKeyPos=[])}},e.prototype._updatePlayerPos=function(t){var e=this,n=this._layerFloor.getPositionAt(this._curTile);this.stepPosArr.length>0?this.player_ske.setAnimation(0,"zou",!0):this.player_ske.setAnimation(0,"zou2",!0),cc.tween(this.playerNode).to(.2,{position:cc.v3(n,0)}).call(function(){return a(e,void 0,void 0,function(){var e,o;return c(this,function(i){switch(i.label){case 0:return void 0!==this.curCoinArr&&this.curCoinArr.length>0&&((e=this.curCoinArr.shift()).getComponent(d.default).playAni(),o=e.getComponent(d.default).getData(),f.default.inst.getCoin(o)),l.G.player.casinoInfo.curCasinoKeyPos.length>0&&this.checkGetKey(this._curTile),this.updateRoleDirection(this._curTile),[4,f.default.inst._curPlayerPos(this._curTile,n)];case 1:return i.sent(),t&&this.scheduleOnce(function(){t()},.2),[2]}})})},this).start()},e.prototype.curRoadCoinData=function(t){for(var e=[],n=function(n){var o=t[n],i=l.G.gameJson.mapList[l.G.player.curMapId].mapLink.find(function(t){return t.posX==o.x&&t.posY==o.y}),r=0;if(null!==i.buildId&&void 0!==i.buildId){var a=l.G.gameJson.mapList[l.G.player.curMapId].buildList.find(function(t){return t.buildId==i.buildId});0==a.buildType&&(r=a["levelReward"+(a.level+1)])}f.default.inst.getDoubleCoinReward&&(r*=2),e.push(r)},o=0;o<t.length;o++)n(o);this.showCoinByPos(e)},e.prototype.countStepHandler=function(t){var e=this._curTile;if(t<=0){var n=this.stepPosArr;this.curRoadCoinData(n)}else{var o=this.countStepByMapId(t,e,[]);this.stepPosArr=o,this.curRoadCoinData(o)}},e.prototype.countStepByMapId=function(t,e,n){if(t<=0)return n;var o,i=l.G.player.curMapId;return 1==i?o=this._mapNextStepHandler1(e):2==i?o=this._mapNextStepHandler2(e):3==i?o=this._mapNextStepHandler3(e):4==i?o=this._mapNextStepHandler4(e):5==i&&(o=this._mapNextStepHandler5(e)),t--,n.push(o),this.countStepByMapId(t,o,n)},e.prototype._mapNextStepHandler1=function(t){var e;return 0==t.x&&t.y>0?e=cc.v2(t.x,t.y-1):t.x>=0&&t.x<5&&0==t.y?e=cc.v2(t.x+1,t.y):5==t.x&&t.y<5?e=cc.v2(t.x,t.y+1):t.x>0&&t.x<=5&&5==t.y&&(e=cc.v2(t.x-1,t.y)),e},e.prototype._mapNextStepHandler2=function(t){var e;return t.x<=9&&t.x>0&&9==t.y?e=cc.v2(t.x-1,t.y):0==t.x&&t.y<=9&&t.y>4||4==t.x&&t.y<=4&&t.y>0?e=cc.v2(t.x,t.y-1):t.x>=0&&t.x<4&&4==t.y||t.x>=4&&t.x<9&&0==t.y?e=cc.v2(t.x+1,t.y):9==t.x&&t.y>=0&&t.y<9&&(e=cc.v2(t.x,t.y+1)),e},e.prototype._mapNextStepHandler3=function(t){var e;return 0==t.x&&t.y<=9&&t.y>4||4==t.x&&t.y<=4&&t.y>0?e=cc.v2(t.x,t.y-1):t.x>=0&&t.x<4&&4==t.y||t.x>=4&&t.x<7&&0==t.y?e=cc.v2(t.x+1,t.y):7==t.x&&t.y>=0&&t.y<9?e=cc.v2(t.x,t.y+1):t.x<=7&&t.x>0&&9==t.y&&(e=cc.v2(t.x-1,t.y)),e},e.prototype._mapNextStepHandler4=function(t){var e;return 0==t.x&&t.y>0?e=cc.v2(t.x,t.y-1):t.x>=0&&t.x<7&&0==t.y?e=cc.v2(t.x+1,t.y):7==t.x&&t.y<7?e=cc.v2(t.x,t.y+1):t.x>0&&t.x<=7&&7==t.y&&(e=cc.v2(t.x-1,t.y)),e},e.prototype._mapNextStepHandler5=function(t){var e;return t.x<=5&&t.x>0&&7==t.y?e=cc.v2(t.x-1,t.y):0==t.x&&t.y<=7&&t.y>0?e=cc.v2(t.x,t.y-1):t.x>=0&&t.x<5&&0==t.y?e=cc.v2(t.x+1,t.y):5==t.x&&t.y>=0&&t.y<7&&(e=cc.v2(t.x,t.y+1)),e},e.prototype.stepCountBetweenTwoTile=function(t,e,n){return t.x==e.x&&t.y==e.y?n:(n++,(o=1==l.G.player.curMapId?this._mapNextStepHandler1(t):2==l.G.player.curMapId?this._mapNextStepHandler2(t):3==l.G.player.curMapId?this._mapNextStepHandler3(t):4==l.G.player.curMapId?this._mapNextStepHandler4(t):this._mapNextStepHandler5(t)).x==e.x&&o.y==e.posY?n:this.stepCountBetweenTwoTile(o,e,n));var o},e.prototype._tryStepMove=function(){return a(this,void 0,void 0,function(){var t,e=this;return c(this,function(n){switch(n.label){case 0:return null!=this.stepPosArr&&0!=this.stepPosArr.length?[3,2]:(this.player_ske.setAnimation(0,"daiji",!0),s.default.inst.isMoving=!1,f.default.inst.stepMoveEnd(this._curTile),[4,this.showCardByStep()]);case 1:return n.sent(),f.default.inst.checkIsLinkGame(this._curTile),[2];case 2:return t=this.stepPosArr.shift(),this._tryMoveToNewTile(t,function(){e._tryStepMove()}),[2]}})})},e.prototype.updataPlayerRoleSkin=function(){var t=l.G.gameJson.roleSkinList[l.G.player.roleSkinId].spineName;this.spineSkinName=t,this.player_ske.setSkin(t)},e.prototype.getDir=function(t){return-1!==l.G.gameJson.mapList[l.G.player.curMapId].dir1.findIndex(function(e){return e.x==t.x&&e.y==t.y})?0:-1!==l.G.gameJson.mapList[l.G.player.curMapId].dir2.findIndex(function(e){return e.x==t.x&&e.y==t.y})?1:-1!==l.G.gameJson.mapList[l.G.player.curMapId].dir3.findIndex(function(e){return e.x==t.x&&e.y==t.y})?2:-1!==l.G.gameJson.mapList[l.G.player.curMapId].dir4.findIndex(function(e){return e.x==t.x&&e.y==t.y})?3:null},e.prototype.setRoleStay=function(){this.player_ske.node.scaleX=.2,this.player_ske.skeletonData=this.frontSke,this.player_ske.setSkin(this.spineSkinName)},e.prototype.updateRoleDirection=function(t){var e=this.getDir(t);null!=e&&(0==e?(this.player_ske.node.scaleX=.2,this.player_ske.skeletonData=this.backSke):1==e?(this.player_ske.node.scaleX=.2,this.player_ske.skeletonData=this.frontSke):2==e?(this.player_ske.node.scaleX=-.2,this.player_ske.skeletonData=this.frontSke):3==e&&(this.player_ske.node.scaleX=-.2,this.player_ske.skeletonData=this.backSke),this.player_ske.setSkin(this.spineSkinName))},e._ins=null,r([v(cc.TiledMap)],e.prototype,"tileMap",void 0),r([v(cc.Node)],e.prototype,"playerNode",void 0),r([v(sp.Skeleton)],e.prototype,"player_ske",void 0),r([v(cc.Node)],e.prototype,"coinArea",void 0),r([v(cc.Prefab)],e.prototype,"coinPre",void 0),r([v(cc.Prefab)],e.prototype,"keyPre",void 0),r([v(cc.Prefab)],e.prototype,"casinoCardPre",void 0),r([v(sp.SkeletonData)],e.prototype,"frontSke",void 0),r([v(sp.SkeletonData)],e.prototype,"backSke",void 0),r([v],e.prototype,"floorLayerName",void 0),n=r([y],e)}(cc.Component);n.default=g,cc._RF.pop()},{"../../../core_lmn/camera/cameraFollow":void 0,"../../../scripts/G":void 0,"../item/item_casinoCard":"item_casinoCard","../item/item_casinoKey":"item_casinoKey","../item/item_coin":"item_coin","./gameManager":"gameManager"}],mapSelect:[function(t,e,n){"use strict";cc._RF.push(e,"eb82fTSuqpOT4EpMo1uJ2G1","mapSelect");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../scripts/G"),c=t("../manager/gameManager"),s=cc._decorator,l=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mapNode=null,e.itemList=[],e.posYArr=[-440,-1110,-1700,-2300],e}return i(e,t),e.prototype.start=function(){this.loadMapData()},e.prototype.loadMapData=function(){var t=this,e=0;a.G.player.curMapId>=2&&(e=this.posYArr[a.G.player.curMapId-2]),cc.tween(this.mapNode).set({y:e}).to(1,{y:this.posYArr[a.G.player.curMapId-1]}).start();for(var n=0;n<this.itemList.length;n++){var o=this.itemList[n];n==a.G.player.curMapId?(o.children[1].active=!1,o.on("click",function(){t.node.destroy(),c.default.inst.moveToNextMap()},this)):o.children[1].active=!0}},e.prototype.btnCloseClicked=function(){this.node.destroy()},r([u(cc.Node)],e.prototype,"mapNode",void 0),r([u(cc.Node)],e.prototype,"itemList",void 0),r([l],e)}(cc.Component);n.default=p,cc._RF.pop()},{"../../../scripts/G":void 0,"../manager/gameManager":"gameManager"}],personalInfo:[function(t,e,n){"use strict";cc._RF.push(e,"4b2901+Ll5BJ5F5sQA4edz8","personalInfo");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function c(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../../core_lmn/core"),l=t("../../../scripts/G"),u=t("../../../scripts/GameConfig"),p=t("../manager/gameManager"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.infoNode=null,e.playerIconSprite=null,e.playerNameLab=null,e.vipFlag=null,e.vipLab=null,e.playerLv=null,e.playerLvName=null,e.playerLvProgressBar=null,e.playerLvProgressLab=null,e.btnUpgrade=null,e.roleSkinName=null,e.roleSkinSprite=null,e.diceSkinName=null,e.diceSkinSprite=null,e.iconSelectNode=null,e.content=null,e.item=null,e.addGoldStr=null,e.addPlayStr=null,e.addDiceStr=null,e.playerIconIndex=0,e}return i(e,t),e.prototype.onEnable=function(){this.loadPlayerInfo(),this.loadPlayerAttr()},e.prototype.btnCloseClicked=function(){this.hide()},e.prototype.onAfterHide=function(){this.node.destroy()},e.prototype.loadPlayerInfo=function(){return a(this,void 0,void 0,function(){var t,e,n,o,i,r,a;return c(this,function(c){switch(c.label){case 0:return t=l.G.gameJson.playerLvList[l.G.player.level-1],e=this.playerIconSprite,[4,Myfun.loadPicFromBundle(u.resInfo[u.resNames.playerIcon].bundle,u.resInfo[u.resNames.playerIcon].url,"img_dfw_tx"+l.G.player.playerIcon)];case 1:return e.spriteFrame=c.sent(),this.playerNameLab.string=l.G.player.playerName,this.vipLab.string="VIP"+l.G.player.vipLevel,this.playerLv.string="LV"+l.G.player.level,this.playerLvName.node.getComponent(s.i18nLabel).init(t.levelNameKey,[]),null!=(n=l.G.gameJson.playerLvList[l.G.player.level])?(this.playerLvProgressLab.string=l.G.player.playerStar+"/"+n.exp,this.playerLvProgressBar.progress=l.G.player.playerStar/n.exp):(this.playerLvProgressLab.string="\u5df2\u6ee1\u7ea7",this.playerLvProgressBar.progress=1,this.btnUpgrade.active=!1),o=l.G.gameJson.roleSkinList[l.G.player.roleSkinId],i=l.G.gameJson.diceSkinList[l.G.player.diceSkinId],this.roleSkinName.node.getComponent(s.i18nLabel).init(o.nameKey,[]),this.diceSkinName.node.getComponent(s.i18nLabel).init(i.nameKey,[]),r=this.diceSkinSprite,[4,Myfun.loadPicFromBundle(u.resInfo[u.resNames.skinIcon].bundle,u.resInfo[u.resNames.skinIcon].url,i.skinPic)];case 2:return r.spriteFrame=c.sent(),a=this.roleSkinSprite,[4,Myfun.loadPicFromBundle(u.resInfo[u.resNames.skinIcon].bundle,u.resInfo[u.resNames.skinIcon].url,o.skinPic)];case 3:return a.spriteFrame=c.sent(),[2]}})})},e.prototype.loadPlayerAttr=function(){var t=l.G.calculatePlayerAttr(),e=t.addGold,n=t.addPlay,o=t.addDice;this.addGoldStr.string="+"+e,this.addPlayStr.string="+"+n,this.addDiceStr.string="+"+o},e.prototype.btnUpgradeClick=function(){l.G.player.playerStar>l.G.gameJson.playerLvList[l.G.player.level].exp?(l.G.player.level++,this.loadPlayerInfo(),this.loadPlayerAttr(),l.G.saveGameData()):cc.log("need star...")},e.prototype.loadIconSelectData=function(){return a(this,void 0,void 0,function(){var t,e,n,o=this;return c(this,function(i){switch(i.label){case 0:t=function(t){var n,i;return c(this,function(r){switch(r.label){case 0:return[4,Myfun.loadPicFromBundle(u.resInfo[u.resNames.playerIcon].bundle,u.resInfo[u.resNames.playerIcon].url,"img_dfw_tx"+t)];case 1:return n=r.sent(),(i=cc.instantiate(e.item)).active=!0,i.children[0].getComponent(cc.Sprite).spriteFrame=n,t==l.G.player.playerIcon&&(i.children[1].active=!0,e.playerIconIndex=l.G.player.playerIcon),i.parent=e.content,i.on(cc.Node.EventType.TOUCH_START,function(){o.playerIconIndex=t,o.updateOtherIcon(),i.children[1].active=!0}),[2]}})},e=this,n=0,i.label=1;case 1:return n<6?[5,t(n)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e.prototype.updateOtherIcon=function(){for(var t=0;t<this.content.childrenCount;t++)this.content.children[t].children[1].active=!1},e.prototype.btnIconClick=function(){this.infoNode.active=!1,this.iconSelectNode.active=!0,0==this.content.childrenCount&&this.loadIconSelectData()},e.prototype.updateIcon=function(){return a(this,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return l.G.player.playerIcon=this.playerIconIndex,t=this.playerIconSprite,[4,Myfun.loadPicFromBundle(u.resInfo[u.resNames.playerIcon].bundle,u.resInfo[u.resNames.playerIcon].url,"img_dfw_tx"+l.G.player.playerIcon)];case 1:return t.spriteFrame=e.sent(),p.default.inst.showPlayerIcon(),[2]}})})},e.prototype.btnSelectIconClick=function(){this.iconSelectNode.active=!1,this.infoNode.active=!0,this.updateIcon()},r([h(cc.Node)],e.prototype,"infoNode",void 0),r([h(cc.Sprite)],e.prototype,"playerIconSprite",void 0),r([h(cc.Label)],e.prototype,"playerNameLab",void 0),r([h(cc.Node)],e.prototype,"vipFlag",void 0),r([h(cc.Label)],e.prototype,"vipLab",void 0),r([h(cc.Label)],e.prototype,"playerLv",void 0),r([h(cc.Label)],e.prototype,"playerLvName",void 0),r([h(cc.ProgressBar)],e.prototype,"playerLvProgressBar",void 0),r([h(cc.Label)],e.prototype,"playerLvProgressLab",void 0),r([h(cc.Node)],e.prototype,"btnUpgrade",void 0),r([h(cc.Label)],e.prototype,"roleSkinName",void 0),r([h(cc.Sprite)],e.prototype,"roleSkinSprite",void 0),r([h(cc.Label)],e.prototype,"diceSkinName",void 0),r([h(cc.Sprite)],e.prototype,"diceSkinSprite",void 0),r([h(cc.Node)],e.prototype,"iconSelectNode",void 0),r([h(cc.Node)],e.prototype,"content",void 0),r([h(cc.Node)],e.prototype,"item",void 0),r([h(cc.Label)],e.prototype,"addGoldStr",void 0),r([h(cc.Label)],e.prototype,"addPlayStr",void 0),r([h(cc.Label)],e.prototype,"addDiceStr",void 0),r([f],e)}(s.PopupBase);n.default=y,cc._RF.pop()},{"../../../core_lmn/core":void 0,"../../../scripts/G":void 0,"../../../scripts/GameConfig":void 0,"../manager/gameManager":"gameManager"}],popBase:[function(t,e,n){"use strict";cc._RF.push(e,"085b6vZhuZBYJc8rp1s/ZpS","popBase");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../scripts/G"),c=t("../manager/gameManager"),s=cc._decorator,l=s.ccclass,u=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onEnable=function(){c.default.inst.hideMainLayer()},e.prototype.onDisable=function(){cc.audioEngine.stopMusic(),cc.audioEngine.stopAllEffects(),a.G.saveGameData(),c.default.inst.showMainLayer(),c.default.inst._updateUIShow(!0)},r([l()],e)}(cc.Component));n.default=u,cc._RF.pop()},{"../../../scripts/G":void 0,"../manager/gameManager":"gameManager"}],pop_casinoEnt:[function(t,e,n){"use strict";cc._RF.push(e,"832b5qSF8hPn5cxrxr4LwqM","pop_casinoEnt");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../core_lmn/core"),c=t("../../../scripts/G"),s=t("../manager/gameManager"),l=t("../manager/mapManager"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mainLayer=null,e.btn_diamond=null,e.btn_gold=null,e.infoLab=null,e.isGold=!1,e.keyNum=5,e.goldKeyPrice=200,e.diamondKeyPrice=200,e}return i(e,t),e.prototype.btnMainClose=function(){this.hide()},e.prototype.onAfterHide=function(){this.node.destroy(),c.G.saveGameData(),s.default.inst._updateUIShow()},e.prototype.btnChangeClick=function(){this.isGold=!this.isGold,this.btn_diamond.active=!this.isGold,this.btn_gold.active=this.isGold,this.infoLab.node.getComponent(a.i18nLabel).init(this.isGold?"static_casino1":"static_casino2",[])},e.prototype.btnRuleClick=function(){c.G.eventMsg.emit(MI.MSG.rule,"static_blindbox_gamerule")},e.prototype.btnOpen_goldClick=function(){var t=this,e="static_confirm1",n=this.keyNum;c.G.eventMsg.emit(MI.MSG.confirm,e,function(){if(c.G.player.accountCoinInfo.casinoGoldKey>=t.keyNum)c.G.player.accountCoinInfo.casinoGoldKey-=t.keyNum,c.G.player.casinoInfo.playMode=t.isGold?0:1,l.default.inst.showCasinoCard(),t.hide();else{e="static_confirm2",n=t.goldKeyPrice*t.keyNum;var o=t.keyNum;c.G.eventMsg.emit(MI.MSG.confirm,e,function(){c.G.player.accountCoinInfo.gold-=t.goldKeyPrice*t.keyNum,c.G.player.casinoInfo.keyMode=t.isGold?0:1,l.default.inst.generateCasinoKeys(),t.hide()},null,n,o)}},null,n,"")},e.prototype.btnOpen_diamondClick=function(){var t=this,e="static_confirm3",n=this.keyNum;c.G.eventMsg.emit(MI.MSG.confirm,e,function(){if(c.G.player.accountCoinInfo.casinoDiamondKey>=t.keyNum)c.G.player.accountCoinInfo.casinoDiamondKey-=t.keyNum,c.G.player.casinoInfo.playMode=t.isGold?0:1,l.default.inst.showCasinoCard(),t.hide();else{e="static_confirm4",n=t.diamondKeyPrice*t.keyNum;var o=t.keyNum;c.G.eventMsg.emit(MI.MSG.confirm,e,function(){c.G.player.accountCoinInfo.diamond-=t.diamondKeyPrice*t.keyNum,c.G.player.casinoInfo.keyMode=t.isGold?0:1,l.default.inst.generateCasinoKeys(),t.hide()},null,n,o)}},null,n,"")},e.prototype.btnSureClick=function(){this.isGold?c.G.player.accountCoinInfo.casinoGoldKey-=5:c.G.player.accountCoinInfo.casinoDiamondKey-=5,l.default.inst.showCasinoCard(),this.hide()},r([d(cc.Node)],e.prototype,"mainLayer",void 0),r([d(cc.Node)],e.prototype,"btn_diamond",void 0),r([d(cc.Node)],e.prototype,"btn_gold",void 0),r([d(cc.Label)],e.prototype,"infoLab",void 0),r([p],e)}(a.PopupBase);n.default=f,cc._RF.pop()},{"../../../core_lmn/core":void 0,"../../../scripts/G":void 0,"../manager/gameManager":"gameManager","../manager/mapManager":"mapManager"}],pop_confirm:[function(t,e,n){"use strict";cc._RF.push(e,"cf0e84NdlROhoVIzCBck+Nc","pop_confirm");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function c(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../../core_lmn/core"),l=cc._decorator,u=l.ccclass,p=l.property,d=l.menu,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.sureCall=null,e.cancelCall=null,e}return i(e,t),e.prototype.showTip=function(t,e,n,o,i){this.label.node.getComponent(s.i18nLabel).init(t,[o,i]),this.sureCall=e,this.cancelCall=n},e.prototype.onBtnSureClick=function(){return a(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,this.hide()];case 1:return t.sent(),this.sureCall&&this.sureCall(),[2]}})})},e.prototype.onBtnCancelClick=function(){return a(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,this.hide()];case 1:return t.sent(),this.cancelCall&&this.cancelCall(),[2]}})})},e.prototype.onAfterHide=function(){this.node.destroy()},r([p(cc.Label)],e.prototype,"label",void 0),r([u,d("\u5f39\u7a97/pop_confirm")],e)}(s.PopupBase);n.default=f,cc._RF.pop()},{"../../../core_lmn/core":void 0}],pop_rule:[function(t,e,n){"use strict";cc._RF.push(e,"b83199Bjy5HHabxGJs30C3D","pop_rule");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../core_lmn/core"),c=cc._decorator,s=c.ccclass,l=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e}return i(e,t),e.prototype.showContent=function(t){this.label.node.getComponent(a.i18nLabel).init(t,[])},e.prototype.btnCloseClicked=function(){this.hide()},e.prototype.onAfterHide=function(){this.node.destroy()},r([l(cc.Label)],e.prototype,"label",void 0),r([s],e)}(a.PopupBase);n.default=u,cc._RF.pop()},{"../../../core_lmn/core":void 0}],pop_tip:[function(t,e,n){"use strict";cc._RF.push(e,"2543bhVcn9GnraDm+yP2wH+","pop_tip");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../core_lmn/core"),c=cc._decorator,s=c.ccclass,l=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e}return i(e,t),e.prototype.start=function(){},e.prototype.showTip=function(t){var e=this;this.label.node.getComponent(a.i18nLabel).init(t,[]),this.scheduleOnce(function(){cc.tween(e.node).to(1,{opacity:0}).call(function(){e.node.destroy()}).start()},1)},r([l(cc.Label)],e.prototype,"label",void 0),r([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../../../core_lmn/core":void 0}],shop:[function(t,e,n){"use strict";cc._RF.push(e,"f59f7p9Sd1K9rRTENXCLqZB","shop");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function c(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s,l=t("../../../scripts/G"),u=t("../item/item_shop"),p=t("../manager/buildManager"),d=t("../popup/popBase"),f=cc._decorator,h=f.ccclass,y=f.property;(function(t){t[t.Coin=0]="Coin",t[t.Diamond=1]="Diamond"})(s||(s={}));var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollView=null,e.goldLab=null,e.diamondLab=null,e.diamondBindLab=null,e.indicator=null,e.content=null,e.content_item=null,e.iconSFList=[],e.itemPre=null,e.goldAniPre=null,e.diamondAni=null,e.coinItems=[],e.diamondItems=[],e.slotItems=[],e.blindItems=[],e.keyItems=[],e.rewardInfo={Coin:{type:s.Coin,url:"Canvas/UI_shop/main/top/gold/icon"},Diamond:{type:s.Diamond,url:"Canvas/UI_shop/main/top/diamond/icon"}},e}return i(e,t),e.prototype.start=function(){this.loadShopData(),this.loadPlayerData(!0),this.loadUI(),this.scrollView.on("scroll-ended",this.onScrollEnded,this),this.scrollView.on("scrolling",this.onScrollEnded,this)},e.prototype.onScrollEnded=function(){this.improveDC()},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this.improveDC()},e.prototype.onDisable=function(){t.prototype.onDisable.call(this)},e.prototype.loadShopData=function(){for(var t=0;t<l.G.gameJson.shopList.length;t++){var e=l.G.gameJson.shopList[t];0==e.type?this.coinItems.push(e):1==e.type&&this.diamondItems.push(e)}},e.prototype.loadPlayerData=function(t){void 0===t&&(t=!1),this.goldLab.string=Myfun.transferNumToK(l.G.player.accountCoinInfo.gold),this.diamondLab.string=Myfun.transferNumToK(l.G.player.accountCoinInfo.diamond),this.diamondBindLab.string=l.G.player.accountCoinInfo.diamondBinding+""},e.prototype.loadUI=function(){return a(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return this.indicator.getComponent(l.G.indicator).initUI(3),[4,this.loadItems(0,"COINS",this.coinItems)];case 1:return t.sent(),[4,this.loadItems(1,"DIAMONDS",this.diamondItems)];case 2:return t.sent(),this.improveDC(),[2]}})})},e.prototype.loadItems=function(t,e,n){return a(this,void 0,void 0,function(){return c(this,function(o){switch(o.label){case 0:return[4,this.executePreFrame(this.getItemGenerator(n,t,e),0)];case 1:return o.sent(),[2]}})})},e.prototype.initItem=function(t,e){var n=this;t.getComponent(u.default)._setData(e,function(t,e){var o,i;e==s.Coin?(o=n.goldAniPre,i=n.rewardInfo.Coin.url):e==s.Diamond&&(o=n.diamondAni,i=n.rewardInfo.Diamond.url),n.onPlayCoinAni(t,n.node,o,i,function(){n.loadPlayerData()})})},e.prototype.onPlayCoinAni=function(t,e,n,o,i){var r=this;return new Promise(function(a){for(var c=Myfun.getNodePos(t,e),s=cc.find(o),l=Myfun.getCirclePoints(100,c,10,50),u=function(t){var o=cc.instantiate(n);o.active=!0,o.parent=e,o.setPosition(c);var u=l[t].x,p=l[t].y;cc.tween(o).to(.15,{position:cc.v3(u,p)}).start(),r.scheduleOnce(function(){cc.Tween.stopAllByTarget(o);var n=o.getPosition(),r=Myfun.getNodePos(s,e),c=n.sub(r).mag()/1e3;cc.tween(o).to(c,{position:cc.v3(r.x,r.y)},{easing:"sineInOut"}).call(function(){o.destroy(),9==t&&i&&i(),a()}).start()},.15+.1*.1*t)},p=0;p<10;p++)u(p)})},e.prototype.getItemGenerator=function(t,e,n){var o,i,r=this;return c(this,function(a){switch(a.label){case 0:(o=cc.instantiate(this.content_item)).active=!0,o.parent=this.content,o.getChildByName("title").children[0].getComponent(cc.Sprite).spriteFrame=this.iconSFList[e],o.getChildByName("title").children[1].getComponent(cc.Sprite).spriteFrame=this.iconSFList[e],o.getChildByName("title").children[2].getComponent(cc.Label).string=n,i=0,a.label=1;case 1:return i<t.length?[4,this.initItem(o.children[2].children[i],t[i])]:[3,4];case 2:a.sent(),a.label=3;case 3:return i++,[3,1];case 4:return this.scheduleOnce(function(){r.improveDC()}),[2]}})},e.prototype.executePreFrame=function(t,e){var n=this;return new Promise(function(o){var i=t,r=function(){for(var t=(new Date).getTime(),a=i.next();;a=i.next()){if(null==a||a.done)return void o();if((new Date).getTime()-t>e)return void n.scheduleOnce(function(){r()})}};r()})},e.prototype.btnCloseClicked=function(){p.default.inst.checkBuildOrUpgrade(),this.node.destroy()},e.prototype.improveDC=function(){if(0!=this.content.childrenCount){var t=this.scrollView.parent.convertToWorldSpaceAR(cc.v2(this.scrollView.x-this.scrollView.anchorX*this.scrollView.width,this.scrollView.y-this.scrollView.anchorY*this.scrollView.height)),e=cc.rect(t.x,t.y,this.scrollView.width,this.scrollView.height);this.content.children.forEach(function(t){t.children[2].children.forEach(function(t){t.getBoundingBoxToWorld().intersects(e)?0===t.opacity&&(t.opacity=255):0!==t.opacity&&(t.opacity=0)})})}},r([y(cc.Node)],e.prototype,"scrollView",void 0),r([y(cc.Label)],e.prototype,"goldLab",void 0),r([y(cc.Label)],e.prototype,"diamondLab",void 0),r([y(cc.Label)],e.prototype,"diamondBindLab",void 0),r([y(cc.Node)],e.prototype,"indicator",void 0),r([y(cc.Node)],e.prototype,"content",void 0),r([y(cc.Node)],e.prototype,"content_item",void 0),r([y(cc.SpriteFrame)],e.prototype,"iconSFList",void 0),r([y(cc.Prefab)],e.prototype,"itemPre",void 0),r([y(cc.Prefab)],e.prototype,"goldAniPre",void 0),r([y(cc.Node)],e.prototype,"diamondAni",void 0),r([h],e)}(d.default);n.default=v,cc._RF.pop()},{"../../../scripts/G":void 0,"../item/item_shop":"item_shop","../manager/buildManager":"buildManager","../popup/popBase":"popBase"}],signIn:[function(t,e,n){"use strict";cc._RF.push(e,"4f189h0otJERYP7Bdhs6goG","signIn");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function c(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s,l=t("../../../core_lmn/core"),u=t("../../../scripts/G"),p=t("../manager/gameManager"),d=cc._decorator,f=d.ccclass,h=d.property;(function(t){t.Coin="Coin",t.Diamond="Diamond",t.DiamondBinding="DiamondBinding",t.Dice="Dice"})(s||(s={}));var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.content=null,e.day7Icon=null,e.box=[],e.boxSke=null,e.boxOpenSf=[],e.progressBar=null,e.coinpre=null,e.diamond=null,e.diamondBinding=null,e.dice=null,e.goldUrl="Canvas/p/dfw/UI/top/gold/icon_gold",e.diamondUrl="Canvas/p/dfw/UI/top/diamond/icon",e.diamondbindUrl="Canvas/p/dfw/UI/top/diamondbind/icon",e.diceUrl="Canvas/p/dfw/UI/btn_dice",e.dailyRewards=[{gold:1e4,diamond:0,diamondbinding:0,dice:0},{gold:0,diamond:100,diamondbinding:0,dice:0},{gold:0,diamond:0,diamondbinding:0,dice:50},{gold:0,diamond:200,diamondbinding:0,dice:0},{gold:0,diamond:0,diamondbinding:0,dice:100},{gold:0,diamond:0,diamondbinding:0,dice:100},{gold:0,diamond:0,diamondbinding:100,dice:0}],e.specialGiftDays=[8,15,22,30],e.specialGiftReward=[{gold:1e4,diamond:1e3,diamondbinding:0,dice:0},{gold:1e4,diamond:0,diamondbinding:0,dice:0},{gold:1e4,diamond:0,diamondbinding:0,dice:0},{gold:1e4,diamond:0,diamondbinding:0,dice:0}],e.lastSignInTimestamp=0,e.rewardInfo={Coin:{type:s.Coin,url:"Canvas/p/dfw/UI/top/gold/icon_gold"},Diamond:{type:s.Diamond,url:"Canvas/p/dfw/UI/top/diamond/icon"},DiamondBinding:{type:s.DiamondBinding,url:"Canvas/p/dfw/UI/top/diamondbind/icon"},Dice:{type:s.Dice,url:"Canvas/p/dfw/UI/btn_dice"}},e.skinName=["liwu1","liwu2","liwu3","liwu4"],e}return i(e,t),e.prototype.onLoad=function(){this.loadSignInData()},e.prototype.loadSignInData=function(){var t=this;this.loadSignInDataFromServer().then(function(e){t.updateLocalSignInData(e)}).catch(function(){var e=t.loadSignInDataFromLocalStorage();e?t.updateLocalSignInData(e):t.initDefaultSignInData()})},e.prototype.loadSignInDataFromServer=function(){return new Promise(function(t,e){e()})},e.prototype.loadSignInDataFromLocalStorage=function(){var t=u.G.getData("signInData");return t?JSON.parse(t):null},e.prototype.updateLocalSignInData=function(t){u.G.player.signCount=t.signInDays,this.lastSignInTimestamp=t.lastSignInTimestamp,this.saveSignInData(),this.updateSignInUI()},e.prototype.initDefaultSignInData=function(){u.G.player.signCount=0,this.lastSignInTimestamp=0,this.updateSignInUI()},e.prototype.saveSignInData=function(){var t={signInDays:u.G.player.signCount,lastSignInTimestamp:this.lastSignInTimestamp};u.G.saveData("signInData",t)},e.prototype.hideBody=function(){this.background.active=!1,this.main.active=!1},e.prototype.onPlayCoinAni=function(t,e,n,o,i){var r=this;return new Promise(function(a){for(var c=Myfun.getNodePos(t,e),s=cc.find(o),l=Myfun.getCirclePoints(100,c,10,50),u=function(t){var o=cc.instantiate(n);o.active=!0,o.parent=e,o.setPosition(c);var u=l[t].x,p=l[t].y;cc.tween(o).to(.15,{position:cc.v3(u,p)}).start(),r.scheduleOnce(function(){r.hideBody(),cc.Tween.stopAllByTarget(o);var n=o.getPosition(),c=Myfun.getNodePos(s,e),l=n.sub(c).mag()/1e3;cc.tween(o).to(l,{position:cc.v3(c.x,c.y)},{easing:"sineInOut"}).call(function(){o.destroy(),9==t&&i&&i(),a()}).start()},.15+.1*.1*t)},p=0;p<10;p++)u(p)})},e.prototype.updateSignInUI=function(){this.progressBar.progress=u.G.player.signCount/30;for(var t=0;t<this.content.childrenCount;t++){var e=this.content.children[t];t<u.G.player.signCount&&(e.children[3].active=!0)}for(t=0;t<this.specialGiftDays.length;t++)this.specialGiftDays[t]<=u.G.player.signCount&&(this.box[t].getComponent(cc.Sprite).spriteFrame=this.boxOpenSf[t])},e.prototype.btnSignClicked=function(){var t=Date.now();this.lastSignInTimestamp=t,u.G.player.signCount++,cc.log("\u7b7e\u5230\u5929\u6570",u.G.player.signCount),this.updateSignInUI(),this.checkSpecialGift(),this.saveSignInData()},e.prototype.checkSpecialGift=function(){return a(this,void 0,void 0,function(){var t,e,n,o,i,r,a,s,l,d=this;return c(this,function(f){switch(f.label){case 0:return this.specialGiftDays.includes(u.G.player.signCount)?(t=this.specialGiftDays.indexOf(u.G.player.signCount),this.showBoxAni(t),[3,12]):[3,1];case 1:if(!((e=u.G.player.signCount)>=0&&e<this.dailyRewards.length))return[3,6];n=this.getReward(this.dailyRewards[e-1]),o=function(t){var e;return c(this,function(o){switch(o.label){case 0:return null===(e=n[t])?[3,2]:[4,i.onPlayCoinAni(i.content.getChildByName("day"+u.G.player.signCount),i.node,i.getAniNode(e.type),e.url,function(){t==n.length&&d.hide(),p.default.inst._updateUIShow()})];case 1:o.sent(),o.label=2;case 2:return[2]}})},i=this,l=0,f.label=2;case 2:return l<n.length?[5,o(l)]:[3,5];case 3:f.sent(),f.label=4;case 4:return l++,[3,2];case 5:return[3,12];case 6:if(e!=this.dailyRewards.length)return[3,11];r=this.getReward(this.dailyRewards[e-1]),a=function(t){var e;return c(this,function(n){switch(n.label){case 0:return null===(e=r[t])?[3,2]:[4,s.onPlayCoinAni(s.day7Icon,s.node,s.getAniNode(e.type),e.url,function(){t==r.length&&d.hide(),p.default.inst._updateUIShow()})];case 1:n.sent(),n.label=2;case 2:return[2]}})},s=this,l=0,f.label=7;case 7:return l<r.length?[5,a(l)]:[3,10];case 8:f.sent(),f.label=9;case 9:return l++,[3,7];case 10:return[3,12];case 11:this.scheduleOnce(function(){d.hide()},.2),f.label=12;case 12:return this.updateSignInUI(),[2]}})})},e.prototype.getAniNode=function(t){var e;return t==s.Coin?e=this.coinpre:t==s.Diamond?e=this.diamond:t==s.DiamondBinding?e=this.diamondBinding:t==s.Dice&&(e=this.dice),e},e.prototype.showBoxAni=function(t){return a(this,void 0,void 0,function(){var e,n,o,i,r=this;return c(this,function(a){switch(a.label){case 0:e=this.getReward(this.specialGiftReward[t]),this.boxSke.node.active=!0,this.boxSke.setSkin(this.skinName[t]),this.boxSke.setAnimation(0,"dakai",!1),n=function(t){var n;return c(this,function(i){switch(i.label){case 0:return null===(n=e[t])?[3,2]:[4,o.onPlayCoinAni(o.boxSke.node,o.node,o.getAniNode(n.type),n.url,function(){t==e.length&&r.hide(),p.default.inst._updateUIShow()})];case 1:i.sent(),i.label=2;case 2:return[2]}})},o=this,i=0,a.label=1;case 1:return i<e.length?[5,n(i)]:[3,4];case 2:a.sent(),a.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},e.prototype.onAfterHide=function(){u.G.saveGameData(),this.node.destroy()},e.prototype.getReward=function(t){u.G.player.accountCoinInfo.gold+=t.gold,u.G.player.accountCoinInfo.diamond+=t.diamond,u.G.player.playerDiceCount+=t.dice,u.G.player.accountCoinInfo.diamondBinding+=t.diamondbinding;var e=[];return t.gold>0&&e.push(this.rewardInfo.Coin),t.diamond>0&&e.push(this.rewardInfo.Diamond),t.diamondbinding>0&&e.push(this.rewardInfo.DiamondBinding),t.dice>0&&e.push(this.rewardInfo.Dice),e},r([h(cc.Node)],e.prototype,"content",void 0),r([h(cc.Node)],e.prototype,"day7Icon",void 0),r([h(cc.Node)],e.prototype,"box",void 0),r([h(sp.Skeleton)],e.prototype,"boxSke",void 0),r([h(cc.SpriteFrame)],e.prototype,"boxOpenSf",void 0),r([h(cc.ProgressBar)],e.prototype,"progressBar",void 0),r([h(cc.Prefab)],e.prototype,"coinpre",void 0),r([h(cc.Node)],e.prototype,"diamond",void 0),r([h(cc.Node)],e.prototype,"diamondBinding",void 0),r([h(cc.Node)],e.prototype,"dice",void 0),r([f],e)}(l.PopupBase);n.default=y,cc._RF.pop()},{"../../../core_lmn/core":void 0,"../../../scripts/G":void 0,"../manager/gameManager":"gameManager"}],vip:[function(t,e,n){"use strict";cc._RF.push(e,"63ec1q+fiBGvKaP5zYSj336","vip");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../scripts/G"),c=t("../item/item_vipReward"),s=t("../popup/popBase"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vipProgress=null,e.vipProgressInfo=null,e.listReward=null,e.itemReward=null,e.listInfo=null,e.itemInfo=null,e.btnLevelDown=null,e.btnLevelUp=null,e.benefitsStr=["\u8def\u8fc7\u91d1\u5e01","\u7279\u8272\u5efa\u7b51\u73a9\u6cd5","\u4f53\u529b\u4e0a\u9650"],e.curLevel=0,e}return i(e,t),e.prototype.start=function(){},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this.loadData()},e.prototype.loadData=function(){this.curLevel=a.G.player.vipLevel,this.curLevel<=1&&(this.curLevel=1,this.btnLevelDown.interactable=!1),this.levelInfoShow()},e.prototype.levelInfoShow=function(){var t=a.G.gameJson.vipList[this.curLevel-1];this.vipProgress.progress=a.G.player.accountCoinInfo.accCostCash/t.accCost,this.vipProgressInfo.string="\u5145\u503c"+t.accCost+"\u5230\u8fbeVIP"+this.curLevel,this.listReward.removeAllChildren(),this.listInfo.removeAllChildren();var e=a.G.PoolManager.getNode(this.itemReward,this.listReward),n=a.G.player.accountCoinInfo.accCostCash>=t.accCost;e.getComponent(c.default).setData(t.getGold,t.getDiamond,this.curLevel,n);for(var o=0;o<3;o++){var i=cc.instantiate(this.itemInfo);i.active=!0,i.parent=this.listInfo,0==o?i.children[2].getComponent(cc.Label).string=this.benefitsStr[o]+"+"+t.addGold:1==o?i.children[2].getComponent(cc.Label).string=this.benefitsStr[o]+"+"+t.addPlay:2==o&&(i.children[2].getComponent(cc.Label).string=this.benefitsStr[o]+"+"+t.addDice)}},e.prototype.btnLevelPlusClick=function(){this.curLevel++,this.btnLevelDown.interactable=!0,10==this.curLevel&&(this.btnLevelUp.interactable=!1),this.levelInfoShow()},e.prototype.btnLevelMinusClick=function(){this.curLevel--,this.btnLevelUp.interactable=!0,1==this.curLevel&&(this.btnLevelDown.interactable=!1),this.levelInfoShow()},e.prototype.btnCloseClicked=function(){this.node.destroy()},r([p(cc.ProgressBar)],e.prototype,"vipProgress",void 0),r([p(cc.Label)],e.prototype,"vipProgressInfo",void 0),r([p(cc.Node)],e.prototype,"listReward",void 0),r([p(cc.Prefab)],e.prototype,"itemReward",void 0),r([p(cc.Node)],e.prototype,"listInfo",void 0),r([p(cc.Node)],e.prototype,"itemInfo",void 0),r([p(cc.Button)],e.prototype,"btnLevelDown",void 0),r([p(cc.Button)],e.prototype,"btnLevelUp",void 0),r([u],e)}(s.default);n.default=d,cc._RF.pop()},{"../../../scripts/G":void 0,"../item/item_vipReward":"item_vipReward","../popup/popBase":"popBase"}]},{},["ani_afterDice","ani_build","ani_casinoReward","ani_complete","ani_dice","ani_diceReward","ani_guide","dressup","mapSelect","personalInfo","shop","signIn","vip","item_build","item_buildPopup","item_casinoCard","item_casinoKey","item_checkState","item_coin","item_dressup","item_shop","item_vipReward","buildManager","gameManager","mapManager","popBase","pop_casinoEnt","pop_confirm","pop_rule","pop_tip"]);